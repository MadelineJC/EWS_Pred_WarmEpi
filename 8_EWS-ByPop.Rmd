# Assessing EWS by Population Grouping

Here, I'm just playing around with calculating AUCs by population, instead of as a composite.

# Required Packages

```{r, include = FALSE}
require(scales)
require(evobiR)
require(gdata)
require(doBy)
require(ecp)
require(strucchange)
require(TTR)
require(moments)
require(tidyverse)
```

# SUB-GROUPING SIMULATED DATA

We did this to look at variation!

# Raw, Sliding Window = 15 Days

```{r}
## Reading in Data
constant1 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/constant.incidence.last.120.1.csv")
constant2 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/constant.incidence.last.120.2.csv")
constant3 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/constant.incidence.last.120.3.csv")
constant4 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/constant.incidence.last.120.4.csv")
constant5 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/constant.incidence.last.120.5.csv")
constant6 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/constant.incidence.last.120.6.csv")
constant7 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/constant.incidence.last.120.7.csv")
constant8 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/constant.incidence.last.120.8.csv")
constant9 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/constant.incidence.last.120.9.csv")
constant10 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/constant.incidence.last.120.10.csv")
warming1 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/warming.incidence.last.120.1.csv")
warming2 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/warming.incidence.last.120.2.csv")
warming3 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/warming.incidence.last.120.3.csv")
warming4 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/warming.incidence.last.120.4.csv")
warming5 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/warming.incidence.last.120.5.csv")
warming6 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/warming.incidence.last.120.6.csv")
warming7 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/warming.incidence.last.120.7.csv")
warming8 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/warming.incidence.last.120.8.csv")
warming9 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/warming.incidence.last.120.9.csv")
warming10 <- read.csv("Kirk_Data/Sim_Pops_EWS_Analyses/warming.incidence.last.120.10.csv")

## Daily Incidence
constant.incidence.daily <- cbind(constant1[ ,2:101], constant2[ ,2:101], constant3[ ,2:101],
                                  constant4[ ,2:101], constant5[ ,2:101], constant6[ ,2:101],
                                  constant7[ ,2:101], constant8[ ,2:101], constant9[ ,2:101],
                                  constant10[ ,2:101])
warming.incidence.daily <- cbind(warming1[ ,2:101], warming2[ ,2:101], warming3[ ,2:101],
                                  warming4[ ,2:101], warming5[ ,2:101], warming6[ ,2:101],
                                  warming7[ ,2:101], warming8[ ,2:101], warming9[ ,2:101],
                                  warming10[ ,2:101])

## Standard Deviation, Mean, Skewness, Kurtosis
constant.sims.sd.15 <- matrix(nrow = 105, ncol = num.of.sims)
constant.sims.mean.15 <- matrix(nrow = 105, ncol = num.of.sims)
constant.sims.sk.15 <- matrix(nrow = 105, ncol = num.of.sims)
constant.sims.kt.15 <- matrix(nrow = 105, ncol = num.of.sims)
warming.sims.sd.15 <- matrix(nrow = 105, ncol = num.of.sims)
warming.sims.mean.15 <- matrix(nrow = 105, ncol = num.of.sims)
warming.sims.sk.15 <- matrix(nrow = 105, ncol = num.of.sims)
warming.sims.kt.15 <- matrix(nrow = 105, ncol = num.of.sims)
for(i in 1:num.of.sims){
  constant.sims.sd.15[ ,i] <- SlidingWindow(FUN = "sd", data = constant.incidence.daily[,i], window = 15,step = 1)
  constant.sims.mean.15[ ,i] <- SlidingWindow(FUN = "mean", data = constant.incidence.daily[,i], window = 15, step = 1)
  constant.sims.sk.15[ ,i] <- SlidingWindow(FUN = "skewness", data = constant.incidence.daily[ ,i], window = 15, step = 1)
  constant.sims.kt.15[ ,i] <- SlidingWindow(FUN = "kurtosis", data = constant.incidence.daily[ ,i], window = 15, step = 1)
}
for(i in 1:num.of.sims){
  warming.sims.sd.15[ ,i] <- SlidingWindow(FUN = "sd", data = warming.incidence.daily[,i], window = 15,step = 1)
  warming.sims.mean.15[ ,i] <- SlidingWindow(FUN = "mean", data = warming.incidence.daily[,i], window = 15, step = 1)
  warming.sims.sk.15[ ,i] <- SlidingWindow(FUN = "skewness", data = warming.incidence.daily[ ,i], window = 15, step = 1)
  warming.sims.kt.15[ ,i] <- SlidingWindow(FUN = "kurtosis", data = warming.incidence.daily[ ,i], window = 15, step = 1)
}

## Variance
constant.sims.var.15 <- constant.sims.sd.15*constant.sims.sd.15
warming.sims.var.15 <- warming.sims.sd.15*warming.sims.sd.15

## Co-Efficient of Variation
constant.sims.cv.15 <- constant.sims.sd.15/constant.sims.mean.15
warming.sims.cv.15 <- warming.sims.sd.15/warming.sims.mean.15

## Index of Dispersion
constant.sims.id.15 <- constant.sims.var.15/constant.sims.mean.15
warming.sims.id.15 <- warming.sims.var.15/warming.sims.mean.15

## First Difference Variance
constant.sims.fdv.15 <- matrix(ncol = num.of.sims, nrow = 105)
warming.sims.fdv.15 <- matrix(ncol = num.of.sims, nrow = 105)
for(i in 1:num.of.sims){
  for(j in 2:105){
    constant.sims.fdv.15[j - 1,i] <- constant.sims.var.15[j,i] - constant.sims.var.15[j - 1,i]
    warming.sims.fdv.15[j - 1,i] <- warming.sims.var.15[j,i] - warming.sims.var.15[j - 1,i]
  }
}

## Autocorrelation and Autocovariance
constant.sims.cor.15 <- matrix(ncol = num.of.sims, nrow = 120)
constant.sims.acv.15 <- matrix(ncol = num.of.sims, nrow = 120)
for(j in 1:num.of.sims){
  for(i in 1:105){
    window.start <- i
    window.end <- i + 14
    segment <- constant.incidence.daily[c(window.start:window.end),j]
    constant.sims.cor.15[i, j] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
    constant.sims.acv.15[i, j] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
  }
}
warming.sims.cor.15 <- matrix(ncol = num.of.sims,nrow = 120)
warming.sims.acv.15 <- matrix(ncol = num.of.sims,nrow = 120)
for(j in 1:num.of.sims){
  for(i in 1:105){
    window.start <- i
    window.end <- i + 14
    segment <- warming.incidence.daily[c(window.start:window.end),j]
    warming.sims.cor.15[i, j] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
    warming.sims.acv.15[i, j] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
  }
}

## Decay Time
constant.sims.dt.15 <- matrix(ncol = num.of.sims, nrow = 45)
warming.sims.dt.15 <- matrix(nco = num.of.sims, nrow = 45)
for(i in 1:num.of.sims){
  for(j in 1:45){
    suppressWarnings(constant.sims.dt.15[j, i] <- -j/log(constant.sims.cor.15[j, i]))
    suppressWarnings(warming.sims.dt.15[j, i] <- -j/log(warming.sims.cor.15[j, i]))
  }
}

## Kendall's Tau
constant.sims.var.15 <- constant.sims.var.15[1:45, ]
constant.sims.mean.15 <- constant.sims.mean.15[1:45, ]
constant.sims.cv.15 <- constant.sims.cv.15[1:45, ]
constant.sims.sk.15 <- constant.sims.sk.15[1:45, ]
constant.sims.kt.15 <- constant.sims.kt.15[1:45, ]
constant.sims.id.15 <- constant.sims.id.15[1:45, ]
constant.sims.cor.15 <- constant.sims.cor.15[1:45, ]
constant.sims.acv.15 <- constant.sims.acv.15[1:45, ]
constant.sims.fdv.15 <- constant.sims.fdv.15[1:45, ]
constant.sims.dt.15 <- constant.sims.dt.15[1:45, ]
warming.sims.var.15 <- warming.sims.var.15[1:45, ]
warming.sims.mean.15 <- warming.sims.mean.15[1:45, ]
warming.sims.cv.15 <- warming.sims.cv.15[1:45, ]
warming.sims.sk.15 <- warming.sims.sk.15[1:45, ]
warming.sims.kt.15 <- warming.sims.kt.15[1:45, ]
warming.sims.id.15 <- warming.sims.id.15[1:45, ]
warming.sims.cor.15 <- warming.sims.cor.15[1:45, ]
warming.sims.acv.15 <- warming.sims.acv.15[1:45, ]
warming.sims.fdv.15 <-  warming.sims.fdv.15[1:45, ]
warming.sims.dt.15 <-  warming.sims.dt.15[1:45, ]
constant.sims.var.15.tau <- c()
constant.sims.mean.15.tau <- c()
constant.sims.cv.15.tau <- c()
constant.sims.sk.15.tau <- c()
constant.sims.kt.15.tau <- c()
constant.sims.id.15.tau <- c()
constant.sims.cor.15.tau <- c()
constant.sims.acv.15.tau <- c()
constant.sims.fdv.15.tau <- c()
constant.sims.dt.15.tau <- c()
warming.sims.var.15.tau <- c()
warming.sims.mean.15.tau <- c()
warming.sims.cv.15.tau <- c()
warming.sims.sk.15.tau <- c()
warming.sims.kt.15.tau <- c()
warming.sims.id.15.tau <- c()
warming.sims.cor.15.tau <- c()
warming.sims.acv.15.tau <- c()
warming.sims.fdv.15.tau <- c()
warming.sims.dt.15.tau <- c()
time.15 <- c(1:45)
for(i in 1:num.of.sims){
  constant.sims.mean.15.tau[i] <- cor(constant.sims.mean.15[ , i], time.15, method = "kendall")
  constant.sims.sk.15.tau[i] <- cor(constant.sims.sk.15[ , i], time.15, method = "kendall")
  constant.sims.kt.15.tau[i] <- cor(constant.sims.kt.15[ , i], time.15, method = "kendall")
  constant.sims.var.15.tau[i] <- cor(constant.sims.var.15[ , i], time.15, method = "kendall")
  constant.sims.cv.15.tau[i] <- cor(constant.sims.cv.15[ , i], time.15, method = "kendall")
  constant.sims.id.15.tau[i] <- cor(constant.sims.id.15[ , i], time.15, method = "kendall")
  constant.sims.fdv.15.tau[i] <- cor(constant.sims.fdv.15[ , i], time.15, method = "kendall")
  constant.sims.cor.15.tau[i] <- cor(constant.sims.cor.15[ , i], time.15, method = "kendall")
  constant.sims.acv.15.tau[i] <- cor(constant.sims.acv.15[ , i], time.15, method = "kendall")
  constant.sims.dt.15.tau[i] <- cor(constant.sims.dt.15[ , i], time.15, method = "kendall")
  
  warming.sims.mean.15.tau[i] <- cor(warming.sims.mean.15[ , i], time.15, method = "kendall")
  warming.sims.sk.15.tau[i] <- cor(warming.sims.sk.15[ , i], time.15, method = "kendall")
  warming.sims.kt.15.tau[i] <- cor(warming.sims.kt.15[ , i], time.15, method = "kendall")
  warming.sims.var.15.tau[i] <- cor(warming.sims.var.15[ , i], time.15, method = "kendall")
  warming.sims.cv.15.tau[i] <- cor(warming.sims.cv.15[ , i], time.15, method = "kendall")
  warming.sims.id.15.tau[i] <- cor(warming.sims.id.15[ , i], time.15, method = "kendall")
  warming.sims.fdv.15.tau[i] <- cor(warming.sims.fdv.15[ , i], time.15, method = "kendall")
  warming.sims.cor.15.tau[i] <- cor(warming.sims.cor.15[ , i], time.15, method = "kendall")
  warming.sims.acv.15.tau[i] <- cor(warming.sims.acv.15[ , i], time.15, method = "kendall")
  warming.sims.dt.15.tau[i] <- cor(warming.sims.dt.15[ , i], time.15, method = "kendall")
}
```

## Calculating AUCs by Grouping

### Mean

```{r}
c.grp1 <- constant.sims.mean.15.tau[1:100]
c.grp2 <- constant.sims.mean.15.tau[101:200]
c.grp3 <- constant.sims.mean.15.tau[201:300]
c.grp4 <- constant.sims.mean.15.tau[301:400]
c.grp5 <- constant.sims.mean.15.tau[401:500]
c.grp6 <- constant.sims.mean.15.tau[501:600]
c.grp7 <- constant.sims.mean.15.tau[601:700]
c.grp8 <- constant.sims.mean.15.tau[701:800]
c.grp9 <- constant.sims.mean.15.tau[801:900]
c.grp10 <- constant.sims.mean.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.mean.15.tau[1:100]
w.grp2 <- warming.sims.mean.15.tau[101:200]
w.grp3 <- warming.sims.mean.15.tau[201:300]
w.grp4 <- warming.sims.mean.15.tau[301:400]
w.grp5 <- warming.sims.mean.15.tau[401:500]
w.grp6 <- warming.sims.mean.15.tau[501:600]
w.grp7 <- warming.sims.mean.15.tau[601:700]
w.grp8 <- warming.sims.mean.15.tau[701:800]
w.grp9 <- warming.sims.mean.15.tau[801:900]
w.grp10 <- warming.sims.mean.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

m.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  m.aucs[i] <- calc_auc(test, null)
}
```

### Skewness

```{r}
c.grp1 <- constant.sims.sk.15.tau[1:100]
c.grp2 <- constant.sims.sk.15.tau[101:200]
c.grp3 <- constant.sims.sk.15.tau[201:300]
c.grp4 <- constant.sims.sk.15.tau[301:400]
c.grp5 <- constant.sims.sk.15.tau[401:500]
c.grp6 <- constant.sims.sk.15.tau[501:600]
c.grp7 <- constant.sims.sk.15.tau[601:700]
c.grp8 <- constant.sims.sk.15.tau[701:800]
c.grp9 <- constant.sims.sk.15.tau[801:900]
c.grp10 <- constant.sims.sk.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.sk.15.tau[1:100]
w.grp2 <- warming.sims.sk.15.tau[101:200]
w.grp3 <- warming.sims.sk.15.tau[201:300]
w.grp4 <- warming.sims.sk.15.tau[301:400]
w.grp5 <- warming.sims.sk.15.tau[401:500]
w.grp6 <- warming.sims.sk.15.tau[501:600]
w.grp7 <- warming.sims.sk.15.tau[601:700]
w.grp8 <- warming.sims.sk.15.tau[701:800]
w.grp9 <- warming.sims.sk.15.tau[801:900]
w.grp10 <- warming.sims.sk.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

skew.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  skew.aucs[i] <- calc_auc(test, null)
}
```

### Kurtosis

```{r}
c.grp1 <- constant.sims.kt.15.tau[1:100]
c.grp2 <- constant.sims.kt.15.tau[101:200]
c.grp3 <- constant.sims.kt.15.tau[201:300]
c.grp4 <- constant.sims.kt.15.tau[301:400]
c.grp5 <- constant.sims.kt.15.tau[401:500]
c.grp6 <- constant.sims.kt.15.tau[501:600]
c.grp7 <- constant.sims.kt.15.tau[601:700]
c.grp8 <- constant.sims.kt.15.tau[701:800]
c.grp9 <- constant.sims.kt.15.tau[801:900]
c.grp10 <- constant.sims.kt.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.kt.15.tau[1:100]
w.grp2 <- warming.sims.kt.15.tau[101:200]
w.grp3 <- warming.sims.kt.15.tau[201:300]
w.grp4 <- warming.sims.kt.15.tau[301:400]
w.grp5 <- warming.sims.kt.15.tau[401:500]
w.grp6 <- warming.sims.kt.15.tau[501:600]
w.grp7 <- warming.sims.kt.15.tau[601:700]
w.grp8 <- warming.sims.kt.15.tau[701:800]
w.grp9 <- warming.sims.kt.15.tau[801:900]
w.grp10 <- warming.sims.kt.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

k.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  k.aucs[i] <- calc_auc(test, null)
}
```

### Variance

```{r}
c.grp1 <- constant.sims.var.15.tau[1:100]
c.grp2 <- constant.sims.var.15.tau[101:200]
c.grp3 <- constant.sims.var.15.tau[201:300]
c.grp4 <- constant.sims.var.15.tau[301:400]
c.grp5 <- constant.sims.var.15.tau[401:500]
c.grp6 <- constant.sims.var.15.tau[501:600]
c.grp7 <- constant.sims.var.15.tau[601:700]
c.grp8 <- constant.sims.var.15.tau[701:800]
c.grp9 <- constant.sims.var.15.tau[801:900]
c.grp10 <- constant.sims.var.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.var.15.tau[1:100]
w.grp2 <- warming.sims.var.15.tau[101:200]
w.grp3 <- warming.sims.var.15.tau[201:300]
w.grp4 <- warming.sims.var.15.tau[301:400]
w.grp5 <- warming.sims.var.15.tau[401:500]
w.grp6 <- warming.sims.var.15.tau[501:600]
w.grp7 <- warming.sims.var.15.tau[601:700]
w.grp8 <- warming.sims.var.15.tau[701:800]
w.grp9 <- warming.sims.var.15.tau[801:900]
w.grp10 <- warming.sims.var.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

var.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  var.aucs[i] <- calc_auc(test, null)
}
```

### Co-Efficient of Variation

```{r}
c.grp1 <- constant.sims.cv.15.tau[1:100]
c.grp2 <- constant.sims.cv.15.tau[101:200]
c.grp3 <- constant.sims.cv.15.tau[201:300]
c.grp4 <- constant.sims.cv.15.tau[301:400]
c.grp5 <- constant.sims.cv.15.tau[401:500]
c.grp6 <- constant.sims.cv.15.tau[501:600]
c.grp7 <- constant.sims.cv.15.tau[601:700]
c.grp8 <- constant.sims.cv.15.tau[701:800]
c.grp9 <- constant.sims.cv.15.tau[801:900]
c.grp10 <- constant.sims.cv.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.cv.15.tau[1:100]
w.grp2 <- warming.sims.cv.15.tau[101:200]
w.grp3 <- warming.sims.cv.15.tau[201:300]
w.grp4 <- warming.sims.cv.15.tau[301:400]
w.grp5 <- warming.sims.cv.15.tau[401:500]
w.grp6 <- warming.sims.cv.15.tau[501:600]
w.grp7 <- warming.sims.cv.15.tau[601:700]
w.grp8 <- warming.sims.cv.15.tau[701:800]
w.grp9 <- warming.sims.cv.15.tau[801:900]
w.grp10 <- warming.sims.cv.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

cv.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  cv.aucs[i] <- calc_auc(test, null)
}
```

### Index of Dispersion

```{r}
c.grp1 <- constant.sims.id.15.tau[1:100]
c.grp2 <- constant.sims.id.15.tau[101:200]
c.grp3 <- constant.sims.id.15.tau[201:300]
c.grp4 <- constant.sims.id.15.tau[301:400]
c.grp5 <- constant.sims.id.15.tau[401:500]
c.grp6 <- constant.sims.id.15.tau[501:600]
c.grp7 <- constant.sims.id.15.tau[601:700]
c.grp8 <- constant.sims.id.15.tau[701:800]
c.grp9 <- constant.sims.id.15.tau[801:900]
c.grp10 <- constant.sims.id.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.id.15.tau[1:100]
w.grp2 <- warming.sims.id.15.tau[101:200]
w.grp3 <- warming.sims.id.15.tau[201:300]
w.grp4 <- warming.sims.id.15.tau[301:400]
w.grp5 <- warming.sims.id.15.tau[401:500]
w.grp6 <- warming.sims.id.15.tau[501:600]
w.grp7 <- warming.sims.id.15.tau[601:700]
w.grp8 <- warming.sims.id.15.tau[701:800]
w.grp9 <- warming.sims.id.15.tau[801:900]
w.grp10 <- warming.sims.id.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

id.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  id.aucs[i] <- calc_auc(test, null)
}
```

### First Difference Variance

```{r}
c.grp1 <- constant.sims.fdv.15.tau[1:100]
c.grp2 <- constant.sims.fdv.15.tau[101:200]
c.grp3 <- constant.sims.fdv.15.tau[201:300]
c.grp4 <- constant.sims.fdv.15.tau[301:400]
c.grp5 <- constant.sims.fdv.15.tau[401:500]
c.grp6 <- constant.sims.fdv.15.tau[501:600]
c.grp7 <- constant.sims.fdv.15.tau[601:700]
c.grp8 <- constant.sims.fdv.15.tau[701:800]
c.grp9 <- constant.sims.fdv.15.tau[801:900]
c.grp10 <- constant.sims.fdv.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.fdv.15.tau[1:100]
w.grp2 <- warming.sims.fdv.15.tau[101:200]
w.grp3 <- warming.sims.fdv.15.tau[201:300]
w.grp4 <- warming.sims.fdv.15.tau[301:400]
w.grp5 <- warming.sims.fdv.15.tau[401:500]
w.grp6 <- warming.sims.fdv.15.tau[501:600]
w.grp7 <- warming.sims.fdv.15.tau[601:700]
w.grp8 <- warming.sims.fdv.15.tau[701:800]
w.grp9 <- warming.sims.fdv.15.tau[801:900]
w.grp10 <- warming.sims.fdv.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

fdv.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  fdv.aucs[i] <- calc_auc(test, null)
}
```

### Autocorrelation

```{r}
c.grp1 <- constant.sims.cor.15.tau[1:100]
c.grp2 <- constant.sims.cor.15.tau[101:200]
c.grp3 <- constant.sims.cor.15.tau[201:300]
c.grp4 <- constant.sims.cor.15.tau[301:400]
c.grp5 <- constant.sims.cor.15.tau[401:500]
c.grp6 <- constant.sims.cor.15.tau[501:600]
c.grp7 <- constant.sims.cor.15.tau[601:700]
c.grp8 <- constant.sims.cor.15.tau[701:800]
c.grp9 <- constant.sims.cor.15.tau[801:900]
c.grp10 <- constant.sims.cor.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.cor.15.tau[1:100]
w.grp2 <- warming.sims.cor.15.tau[101:200]
w.grp3 <- warming.sims.cor.15.tau[201:300]
w.grp4 <- warming.sims.cor.15.tau[301:400]
w.grp5 <- warming.sims.cor.15.tau[401:500]
w.grp6 <- warming.sims.cor.15.tau[501:600]
w.grp7 <- warming.sims.cor.15.tau[601:700]
w.grp8 <- warming.sims.cor.15.tau[701:800]
w.grp9 <- warming.sims.cor.15.tau[801:900]
w.grp10 <- warming.sims.cor.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

ac.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  ac.aucs[i] <- calc_auc(test, null)
}
```

### Autocovariance

```{r}
c.grp1 <- constant.sims.acv.15.tau[1:100]
c.grp2 <- constant.sims.acv.15.tau[101:200]
c.grp3 <- constant.sims.acv.15.tau[201:300]
c.grp4 <- constant.sims.acv.15.tau[301:400]
c.grp5 <- constant.sims.acv.15.tau[401:500]
c.grp6 <- constant.sims.acv.15.tau[501:600]
c.grp7 <- constant.sims.acv.15.tau[601:700]
c.grp8 <- constant.sims.acv.15.tau[701:800]
c.grp9 <- constant.sims.acv.15.tau[801:900]
c.grp10 <- constant.sims.acv.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.acv.15.tau[1:100]
w.grp2 <- warming.sims.acv.15.tau[101:200]
w.grp3 <- warming.sims.acv.15.tau[201:300]
w.grp4 <- warming.sims.acv.15.tau[301:400]
w.grp5 <- warming.sims.acv.15.tau[401:500]
w.grp6 <- warming.sims.acv.15.tau[501:600]
w.grp7 <- warming.sims.acv.15.tau[601:700]
w.grp8 <- warming.sims.acv.15.tau[701:800]
w.grp9 <- warming.sims.acv.15.tau[801:900]
w.grp10 <- warming.sims.acv.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

acv.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  acv.aucs[i] <- calc_auc(test, null)
}
```

### Decay Time

```{r}
c.grp1 <- constant.sims.dt.15.tau[1:100]
c.grp2 <- constant.sims.dt.15.tau[101:200]
c.grp3 <- constant.sims.dt.15.tau[201:300]
c.grp4 <- constant.sims.dt.15.tau[301:400]
c.grp5 <- constant.sims.dt.15.tau[401:500]
c.grp6 <- constant.sims.dt.15.tau[501:600]
c.grp7 <- constant.sims.dt.15.tau[601:700]
c.grp8 <- constant.sims.dt.15.tau[701:800]
c.grp9 <- constant.sims.dt.15.tau[801:900]
c.grp10 <- constant.sims.dt.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.dt.15.tau[1:100]
w.grp2 <- warming.sims.dt.15.tau[101:200]
w.grp3 <- warming.sims.dt.15.tau[201:300]
w.grp4 <- warming.sims.dt.15.tau[301:400]
w.grp5 <- warming.sims.dt.15.tau[401:500]
w.grp6 <- warming.sims.dt.15.tau[501:600]
w.grp7 <- warming.sims.dt.15.tau[601:700]
w.grp8 <- warming.sims.dt.15.tau[701:800]
w.grp9 <- warming.sims.dt.15.tau[801:900]
w.grp10 <- warming.sims.dt.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

dt.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  dt.aucs[i] <- calc_auc(test, null)
}
```

## Collecting AUCs

```{r}
raw_aucs <- c(m.aucs, skew.aucs, k.aucs, var.aucs, cv.aucs, id.aucs, fdv.aucs, ac.aucs, acv.aucs, dt.aucs)
```

## Plotting

```{r}
metric <- c(rep(1, 10), rep(2, 10), rep(3, 10), rep(4, 10), rep(5, 10),
            rep(6, 10), rep(7, 10), rep(8, 10), rep(9, 10), rep(10, 10))
raw_df <- data.frame(cbind(metric, raw_aucs))

raw_df$metric <- as.factor(raw_df$metric)
ggplot(raw_df, aes(x = metric, y = raw_aucs, colour = metric)) + 
  geom_boxplot() +
  geom_jitter(shape = 16, position = position_jitter(0.2)) +
  geom_hline(yintercept = 0.5, colour = "grey", linetype = "dotted") +
  theme(panel.background = element_blank(),
        plot.title = element_text(size = 18),
        axis.title = element_text(size = 16),
        axis.text.x = element_text(color = "black", size = 12, angle = 30, vjust = 0.8, hjust = 0.8),
        axis.text.y = element_text(color = "black", size = 12),
        legend.position = "none") +
  labs(title = "Raw Simulated Data | 15 Day Sliding Window", x = "", y = "AUC") +
  scale_x_discrete(labels = metrics_full) +
  ylim(0, 1)
```

# Pre-Processed, Sliding Window = 15 (Bandwidth = 3)

```{r}
## Read in Data
smooth.sim.const.b3 <- readRDS("Objects/smooth-sim-const-b3.rds")
smooth.sim.warm.b3 <- readRDS("Objects/smooth-sim-warm-b3.rds")

## Standard Deviation, Mean, Skewness, Kurtosis
# Making empty matricies
constant.sims.sd.15 <- matrix(nrow = 105, ncol = num.of.sims)
constant.sims.mean.15 <- matrix(nrow = 105, ncol = num.of.sims)
constant.sims.sk.15 <- matrix(nrow = 105, ncol = num.of.sims)
constant.sims.kt.15 <- matrix(nrow = 105, ncol = num.of.sims)
warming.sims.sd.15 <- matrix(nrow = 105, ncol = num.of.sims)
warming.sims.mean.15 <- matrix(nrow = 105, ncol = num.of.sims)
warming.sims.sk.15 <- matrix(nrow = 105, ncol = num.of.sims)
warming.sims.kt.15 <- matrix(nrow = 105, ncol = num.of.sims)
for(i in 1:num.of.sims){
  constant.sims.sd.15[ ,i] <- SlidingWindow(FUN = "sd", data = smooth.sim.const.b3[,i], window = 15,step = 1)
  constant.sims.mean.15[ ,i] <- SlidingWindow(FUN = "mean", data = smooth.sim.const.b3[,i], window = 15, step = 1)
  constant.sims.sk.15[ ,i] <- SlidingWindow(FUN = "skewness", data = smooth.sim.const.b3[,i], window = 15, step = 1)
  constant.sims.kt.15[ ,i] <- SlidingWindow(FUN = "kurtosis", data = smooth.sim.const.b3[,i], window = 15, step = 1)
}
for(i in 1:num.of.sims){
  warming.sims.sd.15[ ,i] <- SlidingWindow(FUN = "sd", data = smooth.sim.warm.b3[,i], window = 15,step = 1)
  warming.sims.mean.15[ ,i] <- SlidingWindow(FUN = "mean", data = smooth.sim.warm.b3[,i], window = 15, step = 1)
  warming.sims.sk.15[ ,i] <- SlidingWindow(FUN = "skewness", data = smooth.sim.warm.b3[,i], window = 15, step = 1)
  warming.sims.kt.15[ ,i] <- SlidingWindow(FUN = "kurtosis", data = smooth.sim.warm.b3[,i], window = 15, step = 1)
}

## Variance
constant.sims.var.15 <- constant.sims.sd.15*constant.sims.sd.15
warming.sims.var.15 <- warming.sims.sd.15*warming.sims.sd.15

## Co-Efficient of Variation
constant.sims.cv.15 <- constant.sims.sd.15/constant.sims.mean.15
warming.sims.cv.15 <- warming.sims.sd.15/warming.sims.mean.15

## Index of Dispersion
constant.sims.id.15 <- constant.sims.var.15/constant.sims.mean.15
warming.sims.id.15 <- warming.sims.var.15/warming.sims.mean.15

## First Difference Variance
constant.sims.fdv.15 <- matrix(ncol = num.of.sims, nrow = 105)
warming.sims.fdv.15 <- matrix(ncol = num.of.sims, nrow = 105)
for(i in 1:num.of.sims){
  for(j in 2:105){
    constant.sims.fdv.15[j - 1,i] <- constant.sims.var.15[j,i] - constant.sims.var.15[j - 1,i]
    warming.sims.fdv.15[j - 1,i] <- warming.sims.var.15[j,i] - warming.sims.var.15[j - 1,i]
  }
}
constant.sims.fdv.15 <- constant.sims.fdv.15[1:104, ]
warming.sims.fdv.15 <- warming.sims.fdv.15[1:104, ]

## Autocorrelation and Autocovariance
constant.sims.cor.15 <- matrix(ncol = num.of.sims, nrow = 120)
constant.sims.acv.15 <- matrix(ncol = num.of.sims, nrow = 120)
for(j in 1:num.of.sims){
  for(i in 1:105){
    window.start <- i
    window.end <- i + 14
    segment <- smooth.sim.const.b3[c(window.start:window.end),j]
    constant.sims.cor.15[i,j] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
    constant.sims.acv.15[i,j] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
  }
}
warming.sims.cor.15 <- matrix(ncol=num.of.sims,nrow = 120)
warming.sims.acv.15 <- matrix(ncol=num.of.sims,nrow = 120)
for(j in 1:num.of.sims){
  for(i in 1:105){
    window.start <- i
    window.end <- i + 14
    segment <- smooth.sim.warm.b3[c(window.start:window.end),j]
    warming.sims.cor.15[i,j] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
    warming.sims.acv.15[i,j] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
  }
}

## Decay Time
constant.sims.dt.15 <- matrix(ncol = num.of.sims, nrow = 45)
warming.sims.dt.15 <- matrix(nco = num.of.sims, nrow = 45)
for(i in 1:num.of.sims){
  for(j in 1:45){
    suppressWarnings(constant.sims.dt.15[j, i] <- -j/log(constant.sims.cor.15[j, i]))
    suppressWarnings(warming.sims.dt.15[j, i] <- -j/log(warming.sims.cor.15[j, i]))
  }
}

## Kendall's Tau
constant.sims.var.15 <- constant.sims.var.15[1:45, ]
constant.sims.mean.15 <- constant.sims.mean.15[1:45, ]
constant.sims.cv.15 <- constant.sims.cv.15[1:45, ]
constant.sims.sk.15 <-  constant.sims.sk.15[1:45, ]
constant.sims.kt.15 <-  constant.sims.kt.15[1:45, ]
constant.sims.id.15 <-  constant.sims.id.15[1:45, ]
constant.sims.cor.15 <-  constant.sims.cor.15[1:45, ]
constant.sims.acv.15 <-  constant.sims.acv.15[1:45, ]
constant.sims.fdv.15 <-  constant.sims.fdv.15[1:45, ]
constant.sims.dt.15 <-  constant.sims.dt.15[1:45, ]
warming.sims.var.15 <- warming.sims.var.15[1:45, ]
warming.sims.mean.15 <- warming.sims.mean.15[1:45, ]
warming.sims.cv.15 <- warming.sims.cv.15[1:45, ]
warming.sims.sk.15 <-  warming.sims.sk.15[1:45, ]
warming.sims.kt.15 <-  warming.sims.kt.15[1:45, ]
warming.sims.id.15 <-  warming.sims.id.15[1:45, ]
warming.sims.cor.15 <-  warming.sims.cor.15[1:45, ]
warming.sims.acv.15 <-  warming.sims.acv.15[1:45, ]
warming.sims.fdv.15 <-  warming.sims.fdv.15[1:45, ]
warming.sims.dt.15 <-  warming.sims.dt.15[1:45, ]
constant.sims.var.15.tau <- c()
constant.sims.mean.15.tau <- c()
constant.sims.cv.15.tau <- c()
constant.sims.sk.15.tau <-  c()
constant.sims.kt.15.tau <- c()
constant.sims.id.15.tau <- c()
constant.sims.cor.15.tau <- c()
constant.sims.acv.15.tau <- c()
constant.sims.fdv.15.tau <-  c()
constant.sims.dt.15.tau <- c()
warming.sims.var.15.tau <- c()
warming.sims.mean.15.tau <- c()
warming.sims.cv.15.tau <- c()
warming.sims.sk.15.tau <-  c()
warming.sims.kt.15.tau <- c()
warming.sims.id.15.tau <-  c()
warming.sims.cor.15.tau <-  c()
warming.sims.acv.15.tau <-  c()
warming.sims.fdv.15.tau <-  c()
warming.sims.dt.15.tau <-  c()
time.15 <- c(1:45)
for(i in 1:num.of.sims){
  constant.sims.mean.15.tau[i] <- cor(constant.sims.mean.15[ , i], time.15, method = "kendall")
  constant.sims.sk.15.tau[i] <- cor(constant.sims.sk.15[ , i], time.15, method = "kendall")
  constant.sims.kt.15.tau[i] <- cor(constant.sims.kt.15[ , i], time.15, method = "kendall")
  constant.sims.var.15.tau[i] <- cor(constant.sims.var.15[ , i], time.15, method = "kendall")
  constant.sims.cv.15.tau[i] <- cor(constant.sims.cv.15[ , i], time.15, method = "kendall")
  constant.sims.id.15.tau[i] <- cor(constant.sims.id.15[ , i], time.15, method = "kendall")
  constant.sims.fdv.15.tau[i] <- cor(constant.sims.fdv.15[ , i], time.15, method = "kendall")
  constant.sims.cor.15.tau[i] <- cor(constant.sims.cor.15[ , i], time.15, method = "kendall")
  constant.sims.acv.15.tau[i] <- cor(constant.sims.acv.15[ , i], time.15, method = "kendall")
  constant.sims.dt.15.tau[i] <- cor(constant.sims.dt.15[ , i], time.15, method = "kendall")
  
  warming.sims.mean.15.tau[i] <- cor(warming.sims.mean.15[ , i], time.15, method = "kendall")
  warming.sims.sk.15.tau[i] <- cor(warming.sims.sk.15[ , i], time.15, method = "kendall")
  warming.sims.kt.15.tau[i] <- cor(warming.sims.kt.15[ , i], time.15, method = "kendall")
  warming.sims.var.15.tau[i] <- cor(warming.sims.var.15[ , i], time.15, method = "kendall")
  warming.sims.cv.15.tau[i] <- cor(warming.sims.cv.15[ , i], time.15, method = "kendall")
  warming.sims.id.15.tau[i] <- cor(warming.sims.id.15[ , i], time.15, method = "kendall")
  warming.sims.fdv.15.tau[i] <- cor(warming.sims.fdv.15[ , i], time.15, method = "kendall")
  warming.sims.cor.15.tau[i] <- cor(warming.sims.cor.15[ , i], time.15, method = "kendall")
  warming.sims.acv.15.tau[i] <- cor(warming.sims.acv.15[ , i], time.15, method = "kendall")
  warming.sims.dt.15.tau[i] <- cor(warming.sims.dt.15[ , i], time.15, method = "kendall")
}
```

## Calculating AUCs by Grouping

```{r}
c.grp1 <- constant.sims.var.15.tau[1:100]
c.grp2 <- constant.sims.var.15.tau[101:200]
c.grp3 <- constant.sims.var.15.tau[201:300]
c.grp4 <- constant.sims.var.15.tau[301:400]
c.grp5 <- constant.sims.var.15.tau[401:500]
c.grp6 <- constant.sims.var.15.tau[501:600]
c.grp7 <- constant.sims.var.15.tau[601:700]
c.grp8 <- constant.sims.var.15.tau[701:800]
c.grp9 <- constant.sims.var.15.tau[801:900]
c.grp10 <- constant.sims.var.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.var.15.tau[1:100]
w.grp2 <- warming.sims.var.15.tau[101:200]
w.grp3 <- warming.sims.var.15.tau[201:300]
w.grp4 <- warming.sims.var.15.tau[301:400]
w.grp5 <- warming.sims.var.15.tau[401:500]
w.grp6 <- warming.sims.var.15.tau[501:600]
w.grp7 <- warming.sims.var.15.tau[601:700]
w.grp8 <- warming.sims.var.15.tau[701:800]
w.grp9 <- warming.sims.var.15.tau[801:900]
w.grp10 <- warming.sims.var.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

var.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  var.aucs[i] <- calc_auc(test, null)
}
```

### Mean

```{r}
c.grp1 <- constant.sims.mean.15.tau[1:100]
c.grp2 <- constant.sims.mean.15.tau[101:200]
c.grp3 <- constant.sims.mean.15.tau[201:300]
c.grp4 <- constant.sims.mean.15.tau[301:400]
c.grp5 <- constant.sims.mean.15.tau[401:500]
c.grp6 <- constant.sims.mean.15.tau[501:600]
c.grp7 <- constant.sims.mean.15.tau[601:700]
c.grp8 <- constant.sims.mean.15.tau[701:800]
c.grp9 <- constant.sims.mean.15.tau[801:900]
c.grp10 <- constant.sims.mean.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.mean.15.tau[1:100]
w.grp2 <- warming.sims.mean.15.tau[101:200]
w.grp3 <- warming.sims.mean.15.tau[201:300]
w.grp4 <- warming.sims.mean.15.tau[301:400]
w.grp5 <- warming.sims.mean.15.tau[401:500]
w.grp6 <- warming.sims.mean.15.tau[501:600]
w.grp7 <- warming.sims.mean.15.tau[601:700]
w.grp8 <- warming.sims.mean.15.tau[701:800]
w.grp9 <- warming.sims.mean.15.tau[801:900]
w.grp10 <- warming.sims.mean.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

m.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  m.aucs[i] <- calc_auc(test, null)
}
```

### Skewness

```{r}
c.grp1 <- constant.sims.sk.15.tau[1:100]
c.grp2 <- constant.sims.sk.15.tau[101:200]
c.grp3 <- constant.sims.sk.15.tau[201:300]
c.grp4 <- constant.sims.sk.15.tau[301:400]
c.grp5 <- constant.sims.sk.15.tau[401:500]
c.grp6 <- constant.sims.sk.15.tau[501:600]
c.grp7 <- constant.sims.sk.15.tau[601:700]
c.grp8 <- constant.sims.sk.15.tau[701:800]
c.grp9 <- constant.sims.sk.15.tau[801:900]
c.grp10 <- constant.sims.sk.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.sk.15.tau[1:100]
w.grp2 <- warming.sims.sk.15.tau[101:200]
w.grp3 <- warming.sims.sk.15.tau[201:300]
w.grp4 <- warming.sims.sk.15.tau[301:400]
w.grp5 <- warming.sims.sk.15.tau[401:500]
w.grp6 <- warming.sims.sk.15.tau[501:600]
w.grp7 <- warming.sims.sk.15.tau[601:700]
w.grp8 <- warming.sims.sk.15.tau[701:800]
w.grp9 <- warming.sims.sk.15.tau[801:900]
w.grp10 <- warming.sims.sk.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

skew.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  skew.aucs[i] <- calc_auc(test, null)
}
```

### Kurtosis

```{r}
c.grp1 <- constant.sims.kt.15.tau[1:100]
c.grp2 <- constant.sims.kt.15.tau[101:200]
c.grp3 <- constant.sims.kt.15.tau[201:300]
c.grp4 <- constant.sims.kt.15.tau[301:400]
c.grp5 <- constant.sims.kt.15.tau[401:500]
c.grp6 <- constant.sims.kt.15.tau[501:600]
c.grp7 <- constant.sims.kt.15.tau[601:700]
c.grp8 <- constant.sims.kt.15.tau[701:800]
c.grp9 <- constant.sims.kt.15.tau[801:900]
c.grp10 <- constant.sims.kt.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.kt.15.tau[1:100]
w.grp2 <- warming.sims.kt.15.tau[101:200]
w.grp3 <- warming.sims.kt.15.tau[201:300]
w.grp4 <- warming.sims.kt.15.tau[301:400]
w.grp5 <- warming.sims.kt.15.tau[401:500]
w.grp6 <- warming.sims.kt.15.tau[501:600]
w.grp7 <- warming.sims.kt.15.tau[601:700]
w.grp8 <- warming.sims.kt.15.tau[701:800]
w.grp9 <- warming.sims.kt.15.tau[801:900]
w.grp10 <- warming.sims.kt.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

k.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  k.aucs[i] <- calc_auc(test, null)
}
```

### Variance

```{r}
c.grp1 <- constant.sims.var.15.tau[1:100]
c.grp2 <- constant.sims.var.15.tau[101:200]
c.grp3 <- constant.sims.var.15.tau[201:300]
c.grp4 <- constant.sims.var.15.tau[301:400]
c.grp5 <- constant.sims.var.15.tau[401:500]
c.grp6 <- constant.sims.var.15.tau[501:600]
c.grp7 <- constant.sims.var.15.tau[601:700]
c.grp8 <- constant.sims.var.15.tau[701:800]
c.grp9 <- constant.sims.var.15.tau[801:900]
c.grp10 <- constant.sims.var.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.var.15.tau[1:100]
w.grp2 <- warming.sims.var.15.tau[101:200]
w.grp3 <- warming.sims.var.15.tau[201:300]
w.grp4 <- warming.sims.var.15.tau[301:400]
w.grp5 <- warming.sims.var.15.tau[401:500]
w.grp6 <- warming.sims.var.15.tau[501:600]
w.grp7 <- warming.sims.var.15.tau[601:700]
w.grp8 <- warming.sims.var.15.tau[701:800]
w.grp9 <- warming.sims.var.15.tau[801:900]
w.grp10 <- warming.sims.var.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

var.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  var.aucs[i] <- calc_auc(test, null)
}
```

### Co-Efficient of Variation

```{r}
c.grp1 <- constant.sims.cv.15.tau[1:100]
c.grp2 <- constant.sims.cv.15.tau[101:200]
c.grp3 <- constant.sims.cv.15.tau[201:300]
c.grp4 <- constant.sims.cv.15.tau[301:400]
c.grp5 <- constant.sims.cv.15.tau[401:500]
c.grp6 <- constant.sims.cv.15.tau[501:600]
c.grp7 <- constant.sims.cv.15.tau[601:700]
c.grp8 <- constant.sims.cv.15.tau[701:800]
c.grp9 <- constant.sims.cv.15.tau[801:900]
c.grp10 <- constant.sims.cv.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.cv.15.tau[1:100]
w.grp2 <- warming.sims.cv.15.tau[101:200]
w.grp3 <- warming.sims.cv.15.tau[201:300]
w.grp4 <- warming.sims.cv.15.tau[301:400]
w.grp5 <- warming.sims.cv.15.tau[401:500]
w.grp6 <- warming.sims.cv.15.tau[501:600]
w.grp7 <- warming.sims.cv.15.tau[601:700]
w.grp8 <- warming.sims.cv.15.tau[701:800]
w.grp9 <- warming.sims.cv.15.tau[801:900]
w.grp10 <- warming.sims.cv.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

cv.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  cv.aucs[i] <- calc_auc(test, null)
}
```

### Index of Dispersion

```{r}
c.grp1 <- constant.sims.id.15.tau[1:100]
c.grp2 <- constant.sims.id.15.tau[101:200]
c.grp3 <- constant.sims.id.15.tau[201:300]
c.grp4 <- constant.sims.id.15.tau[301:400]
c.grp5 <- constant.sims.id.15.tau[401:500]
c.grp6 <- constant.sims.id.15.tau[501:600]
c.grp7 <- constant.sims.id.15.tau[601:700]
c.grp8 <- constant.sims.id.15.tau[701:800]
c.grp9 <- constant.sims.id.15.tau[801:900]
c.grp10 <- constant.sims.id.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.id.15.tau[1:100]
w.grp2 <- warming.sims.id.15.tau[101:200]
w.grp3 <- warming.sims.id.15.tau[201:300]
w.grp4 <- warming.sims.id.15.tau[301:400]
w.grp5 <- warming.sims.id.15.tau[401:500]
w.grp6 <- warming.sims.id.15.tau[501:600]
w.grp7 <- warming.sims.id.15.tau[601:700]
w.grp8 <- warming.sims.id.15.tau[701:800]
w.grp9 <- warming.sims.id.15.tau[801:900]
w.grp10 <- warming.sims.id.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

id.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  id.aucs[i] <- calc_auc(test, null)
}
```

### First Difference Variance

```{r}
c.grp1 <- constant.sims.fdv.15.tau[1:100]
c.grp2 <- constant.sims.fdv.15.tau[101:200]
c.grp3 <- constant.sims.fdv.15.tau[201:300]
c.grp4 <- constant.sims.fdv.15.tau[301:400]
c.grp5 <- constant.sims.fdv.15.tau[401:500]
c.grp6 <- constant.sims.fdv.15.tau[501:600]
c.grp7 <- constant.sims.fdv.15.tau[601:700]
c.grp8 <- constant.sims.fdv.15.tau[701:800]
c.grp9 <- constant.sims.fdv.15.tau[801:900]
c.grp10 <- constant.sims.fdv.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.fdv.15.tau[1:100]
w.grp2 <- warming.sims.fdv.15.tau[101:200]
w.grp3 <- warming.sims.fdv.15.tau[201:300]
w.grp4 <- warming.sims.fdv.15.tau[301:400]
w.grp5 <- warming.sims.fdv.15.tau[401:500]
w.grp6 <- warming.sims.fdv.15.tau[501:600]
w.grp7 <- warming.sims.fdv.15.tau[601:700]
w.grp8 <- warming.sims.fdv.15.tau[701:800]
w.grp9 <- warming.sims.fdv.15.tau[801:900]
w.grp10 <- warming.sims.fdv.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

fdv.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  fdv.aucs[i] <- calc_auc(test, null)
}
```

### Autocorrelation

```{r}
c.grp1 <- constant.sims.cor.15.tau[1:100]
c.grp2 <- constant.sims.cor.15.tau[101:200]
c.grp3 <- constant.sims.cor.15.tau[201:300]
c.grp4 <- constant.sims.cor.15.tau[301:400]
c.grp5 <- constant.sims.cor.15.tau[401:500]
c.grp6 <- constant.sims.cor.15.tau[501:600]
c.grp7 <- constant.sims.cor.15.tau[601:700]
c.grp8 <- constant.sims.cor.15.tau[701:800]
c.grp9 <- constant.sims.cor.15.tau[801:900]
c.grp10 <- constant.sims.cor.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.cor.15.tau[1:100]
w.grp2 <- warming.sims.cor.15.tau[101:200]
w.grp3 <- warming.sims.cor.15.tau[201:300]
w.grp4 <- warming.sims.cor.15.tau[301:400]
w.grp5 <- warming.sims.cor.15.tau[401:500]
w.grp6 <- warming.sims.cor.15.tau[501:600]
w.grp7 <- warming.sims.cor.15.tau[601:700]
w.grp8 <- warming.sims.cor.15.tau[701:800]
w.grp9 <- warming.sims.cor.15.tau[801:900]
w.grp10 <- warming.sims.cor.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

ac.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  ac.aucs[i] <- calc_auc(test, null)
}
```

### Autocovariance

```{r}
c.grp1 <- constant.sims.acv.15.tau[1:100]
c.grp2 <- constant.sims.acv.15.tau[101:200]
c.grp3 <- constant.sims.acv.15.tau[201:300]
c.grp4 <- constant.sims.acv.15.tau[301:400]
c.grp5 <- constant.sims.acv.15.tau[401:500]
c.grp6 <- constant.sims.acv.15.tau[501:600]
c.grp7 <- constant.sims.acv.15.tau[601:700]
c.grp8 <- constant.sims.acv.15.tau[701:800]
c.grp9 <- constant.sims.acv.15.tau[801:900]
c.grp10 <- constant.sims.acv.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.acv.15.tau[1:100]
w.grp2 <- warming.sims.acv.15.tau[101:200]
w.grp3 <- warming.sims.acv.15.tau[201:300]
w.grp4 <- warming.sims.acv.15.tau[301:400]
w.grp5 <- warming.sims.acv.15.tau[401:500]
w.grp6 <- warming.sims.acv.15.tau[501:600]
w.grp7 <- warming.sims.acv.15.tau[601:700]
w.grp8 <- warming.sims.acv.15.tau[701:800]
w.grp9 <- warming.sims.acv.15.tau[801:900]
w.grp10 <- warming.sims.acv.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

acv.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  acv.aucs[i] <- calc_auc(test, null)
}
```

### Decay Time

```{r}
c.grp1 <- constant.sims.dt.15.tau[1:100]
c.grp2 <- constant.sims.dt.15.tau[101:200]
c.grp3 <- constant.sims.dt.15.tau[201:300]
c.grp4 <- constant.sims.dt.15.tau[301:400]
c.grp5 <- constant.sims.dt.15.tau[401:500]
c.grp6 <- constant.sims.dt.15.tau[501:600]
c.grp7 <- constant.sims.dt.15.tau[601:700]
c.grp8 <- constant.sims.dt.15.tau[701:800]
c.grp9 <- constant.sims.dt.15.tau[801:900]
c.grp10 <- constant.sims.dt.15.tau[901:1000]
const.taus <- cbind(c.grp1, c.grp2, c.grp3, c.grp4, c.grp5,
                    c.grp6, c.grp7, c.grp8, c.grp9, c.grp10)

w.grp1 <- warming.sims.dt.15.tau[1:100]
w.grp2 <- warming.sims.dt.15.tau[101:200]
w.grp3 <- warming.sims.dt.15.tau[201:300]
w.grp4 <- warming.sims.dt.15.tau[301:400]
w.grp5 <- warming.sims.dt.15.tau[401:500]
w.grp6 <- warming.sims.dt.15.tau[501:600]
w.grp7 <- warming.sims.dt.15.tau[601:700]
w.grp8 <- warming.sims.dt.15.tau[701:800]
w.grp9 <- warming.sims.dt.15.tau[801:900]
w.grp10 <- warming.sims.dt.15.tau[901:1000]
warm.taus <- cbind(w.grp1, w.grp2, w.grp3, w.grp4, w.grp5,
                   w.grp6, w.grp7, w.grp8, w.grp9, w.grp10)

dt.aucs <- c()
for (i in 1:10){
  test <- warm.taus[ ,i]; null <- const.taus[ ,i]
  dt.aucs[i] <- calc_auc(test, null)
}
```

## Collecting AUCs

```{r}
smooth_3_aucs <- c(m.aucs, skew.aucs, k.aucs, var.aucs, cv.aucs, id.aucs, fdv.aucs, ac.aucs, acv.aucs, dt.aucs)
```

## Plotting

```{r}
metric <- c(rep(1, 10), rep(2, 10), rep(3, 10), rep(4, 10), rep(5, 10),
            rep(6, 10), rep(7, 10), rep(8, 10), rep(9, 10), rep(10, 10))
smooth_df <- data.frame(cbind(metric, smooth_3_aucs))

smooth_df$metric <- as.factor(smooth_df$metric)
ggplot(smooth_df, aes(x = metric, y = smooth_3_aucs, colour = metric)) + 
  geom_boxplot() +
  geom_jitter(shape = 16, position = position_jitter(0.2)) +
  geom_hline(yintercept = 0.5, colour = "grey", linetype = "dotted") +
  theme(panel.background = element_blank(),
        plot.title = element_text(size = 18),
        axis.title = element_text(size = 16),
        axis.text.x = element_text(color = "black", size = 12, angle = 30, vjust = 0.8, hjust = 0.8),
        axis.text.y = element_text(color = "black", size = 12),
        legend.position = "none") +
  labs(title = "Pre-Processed Simulated Data (Bandwidth = 3) | 15 Day Sliding Window", x = "", y = "AUC") +
  labs(x = "", y = "AUC") +
  scale_x_discrete(labels = metrics_full) +
  ylim(0, 1)
```

# BY POPULATION

Okay, so from Harris et al. (2020), "Early warning signals of malaria resurgence in Kericho, Kenya":

-   To test this prediction, from December 1981 to April 1993 ("approach to criticality"), **we calculated each of these 10 leading indicators over a rolling window** (i.e. the statistics were repeatedly calculated within a fixed size temporal subsample of the data, shifting the window by one month for each computation). To better distinguish the signal of critical slowing down from background noise and periodic trends, we preprocessed the raw case data by detrending with a Gaussian kernel...

-   **All analyses were conducted in R using the spaero package**, a freely available package that provides a wide range of methods for investigating critical slowing down in time series. Data and code for reproducing analyses reported in this paper are available online at [https://github.com/mjharris95/Kericho-EWS.git](https://github.com/mjharris95/).

-   The performance of each indicator as an early warning signal was then assessed by performing significance tests on the rolling window statistics as follows.

    -   First, **we determined the trend in each indicator over time by calculating Kendall's correlation coefficient**, $\tau$, between the calculated rolling window statistic at each time and the time index *i*.

        -   The sign of indicates the direction of change, while the magnitude corresponds to the strength of the temporal trend.

    -   We used the following permutation approach to assess the significance of the estimated correlations.

        -   We first **generated 10,000 permutations of case incidence during the approach to criticality**, thus preserving the general features of the original data (e.g. amplitudes of fluctuations) while eliminating underlying patterns of serial dependence. We then **performed rolling window analyses on the permuted data to generate a null distribution of correlation coefficients for each indicator. The false positive rates of the 10 tests were estimated by finding the proportion of these permutations with a value for more extreme than that calculated for the Kericho data. The resulting p-values quantify the reliability of their corresponding statistics as early warning signals.** In an applied surveillance setting, time series data would be updated regularly. To reflect this, we first included only data collected at least 96 months prior to the critical transition (April 1985) and repeatedly added an additional month of data, recalculating p-values for each month.

------------------------------------------------------------------------

Okay, so it looks like they just calculated Kendall's $\tau$, and then did some bootstrapping? We won't have to do that second bit for the simulated data, so let's start there.

# Raw, Simulated Data (Sliding Window = 15 Days)

```{r, eval = FALSE}
constant.sims.var.15.tau
constant.sims.mean.15.tau
constant.sims.cv.15.tau
constant.sims.sk.15.tau
constant.sims.kt.15.tau
constant.sims.id.15.tau
constant.sims.cor.15.tau
constant.sims.acv.15.tau
constant.sims.fdv.15.tau
constant.sims.dt.15.tau
warming.sims.var.15.tau
warming.sims.mean.15.tau
warming.sims.cv.15.tau
warming.sims.sk.15.tau
warming.sims.kt.15.tau
warming.sims.id.15.tau
warming.sims.cor.15.tau
warming.sims.acv.15.tau
warming.sims.fdv.15.tau
warming.sims.dt.15.tau
```

Loading some more packages for plotting:

```{r}
library(ggplot2)
library(hrbrthemes)
library(dplyr)
library(tidyr)
library(viridis)
```

## Mean

```{r}
summary(constant.sims.mean.15.tau); summary(warming.sims.mean.15.tau)
(length(warming.sims.mean.15.tau) - length(which(warming.sims.mean.15.tau < 0)))/length(warming.sims.mean.15.tau)
(length(warming.sims.mean.15.tau) - length(which(warming.sims.mean.15.tau < median(constant.sims.mean.15.tau))))/length(warming.sims.mean.15.tau)

raw.sim.mean.15.tau <- data.frame(cbind(constant.sims.mean.15.tau, warming.sims.mean.15.tau))
Treatment <- c(rep("Constant", 1000), rep("Warming", 1000))
k.tau <- c(constant.sims.mean.15.tau, warming.sims.mean.15.tau)
raw.sim.mean.15.tau <- data.frame(
  Treatment = Treatment, 
  k.tau = k.tau
)
saveRDS(raw.sim.mean.15.tau, "Objects/raw.sim.mean.15.tau.rds")

cols <- c(rep("#1434A4", 512), rep("#C21E56", 512))
cols.pt <- c(rep("#A7C7E7", 1000), rep("#F6799D", 1000))

med.const.sims.mean.15.tau <- median(constant.sims.mean.15.tau)
med.warm.sims.mean.15.tau <- median(warming.sims.mean.15.tau)
ggplot(data = raw.sim.mean.15.tau, aes(x = k.tau, group = Treatment, fill = Treatment)) +
  geom_density(alpha = 0.4, colour = cols) +
  scale_fill_manual(values = c("#1434A4", "#C21E56")) +
  geom_vline(xintercept = med.const.sims.mean.15.tau, colour = "#1434A4") +
  geom_vline(xintercept = med.warm.sims.mean.15.tau, colour = "#C21E56") +
  xlab("Kendall's Tau") +
  ylab("Density (Mean)") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))

ggplot(raw.sim.mean.15.tau, aes(x = Treatment, y = k.tau)) + 
  geom_violin(fill = cols, colour = cols) +
  geom_jitter(height = 0, width = 0.2, colour = cols.pt) +
  stat_summary(fun.y = median, geom = "point", size = 6, colour = "black", shape = 18) + 
  xlab("Mean") +
  ylab("Kendall's Tau") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```

## Skewness

```{r}
summary(constant.sims.sk.15.tau); summary(warming.sims.sk.15.tau)
(length(warming.sims.sk.15.tau) - length(which(warming.sims.sk.15.tau < 0)))/length(warming.sims.sk.15.tau)
(length(warming.sims.sk.15.tau) - length(which(warming.sims.sk.15.tau < median(constant.sims.sk.15.tau))))/length(warming.sims.sk.15.tau)

raw.sim.sk.15.tau <- data.frame(cbind(constant.sims.sk.15.tau, warming.sims.sk.15.tau))
Treatment <- c(rep("Constant", 1000), rep("Warming", 1000))
k.tau <- c(constant.sims.sk.15.tau, warming.sims.sk.15.tau)
raw.sim.sk.15.tau <- data.frame(
  Treatment = Treatment, 
  k.tau = k.tau
)
saveRDS(raw.sim.sk.15.tau, "Objects/raw.sim.sk.15.tau.rds")

cols <- c(rep("#1434A4", 512), rep("#C21E56", 512))
cols.pt <- c(rep("#A7C7E7", 1000), rep("#F6799D", 1000))

med.const.sims.sk.15.tau <- median(constant.sims.sk.15.tau)
med.warm.sims.sk.15.tau <- median(warming.sims.sk.15.tau)
ggplot(data = raw.sim.sk.15.tau, aes(x = k.tau, group = Treatment, fill = Treatment)) +
  geom_density(alpha = 0.4, colour = cols) +
  scale_fill_manual(values = c("#1434A4", "#C21E56")) +
  geom_vline(xintercept = med.const.sims.sk.15.tau, colour = "#1434A4") +
  geom_vline(xintercept = med.warm.sims.sk.15.tau, colour = "#C21E56") +
  xlab("Kendall's Tau") +
  ylab("Density (Skewness)") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))

ggplot(raw.sim.sk.15.tau, aes(x = Treatment, y = k.tau)) + 
  geom_violin(fill = cols, colour = cols) +
  geom_jitter(height = 0, width = 0.2, colour = cols.pt) +
  stat_summary(fun.y = median, geom = "point", size = 6, colour = "black", shape = 18) + 
  xlab("Skewness") +
  ylab("Kendall's Tau") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```

## Kurtosis

```{r}
summary(constant.sims.kt.15.tau); summary(warming.sims.kt.15.tau)
(length(warming.sims.kt.15.tau) - length(which(warming.sims.kt.15.tau < 0)))/length(warming.sims.kt.15.tau)
(length(warming.sims.kt.15.tau) - length(which(warming.sims.kt.15.tau < median(constant.sims.kt.15.tau))))/length(warming.sims.kt.15.tau)

raw.sim.kt.15.tau <- data.frame(cbind(constant.sims.kt.15.tau, warming.sims.kt.15.tau))
Treatment <- c(rep("Constant", 1000), rep("Warming", 1000))
k.tau <- c(constant.sims.kt.15.tau, warming.sims.kt.15.tau)
raw.sim.kt.15.tau <- data.frame(
  Treatment = Treatment, 
  k.tau = k.tau
)
saveRDS(raw.sim.kt.15.tau, "Objects/raw.sim.kt.15.tau.rds")

cols <- c(rep("#1434A4", 512), rep("#C21E56", 512))
cols.pt <- c(rep("#A7C7E7", 1000), rep("#F6799D", 1000))

med.const.sims.kt.15.tau <- median(constant.sims.kt.15.tau)
med.warm.sims.kt.15.tau <- median(warming.sims.kt.15.tau)
ggplot(data = raw.sim.kt.15.tau, aes(x = k.tau, group = Treatment, fill = Treatment)) +
  geom_density(alpha = 0.4, colour = cols) +
  scale_fill_manual(values = c("#1434A4", "#C21E56")) +
  geom_vline(xintercept = med.const.sims.kt.15.tau, colour = "#1434A4") +
  geom_vline(xintercept = med.warm.sims.kt.15.tau, colour = "#C21E56") +
  xlab("Kendall's Tau") +
  ylab("Density (Kurtosis)") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))

ggplot(raw.sim.kt.15.tau, aes(x = Treatment, y = k.tau)) + 
  geom_violin(fill = cols, colour = cols) +
  geom_jitter(height = 0, width = 0.2, colour = cols.pt) +
  stat_summary(fun.y = median, geom = "point", size = 6, colour = "black", shape = 18) + 
  xlab("Kurtosis") +
  ylab("Kendall's Tau") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```

## Variance

```{r}
summary(constant.sims.var.15.tau); summary(warming.sims.var.15.tau)
(length(warming.sims.var.15.tau) - length(which(warming.sims.var.15.tau < 0)))/length(warming.sims.var.15.tau)
(length(warming.sims.var.15.tau) - length(which(warming.sims.var.15.tau < median(constant.sims.var.15.tau))))/length(warming.sims.var.15.tau)

raw.sim.var.15.tau <- data.frame(cbind(constant.sims.var.15.tau, warming.sims.var.15.tau))
Treatment <- c(rep("Constant", 1000), rep("Warming", 1000))
k.tau <- c(constant.sims.var.15.tau, warming.sims.var.15.tau)
raw.sim.var.15.tau <- data.frame(
  Treatment = Treatment, 
  k.tau = k.tau
)
saveRDS(raw.sim.var.15.tau, "Objects/raw.sim.var.15.tau.rds")

cols <- c(rep("#1434A4", 512), rep("#C21E56", 512))
cols.pt <- c(rep("#A7C7E7", 1000), rep("#F6799D", 1000))

med.const.sims.var.15.tau <- median(constant.sims.var.15.tau)
med.warm.sims.var.15.tau <- median(warming.sims.var.15.tau)
ggplot(data = raw.sim.var.15.tau, aes(x = k.tau, group = Treatment, fill = Treatment)) +
  geom_density(alpha = 0.4, colour = cols) +
  scale_fill_manual(values = c("#1434A4", "#C21E56")) +
  geom_vline(xintercept = med.const.sims.var.15.tau, colour = "#1434A4") +
  geom_vline(xintercept = med.warm.sims.var.15.tau, colour = "#C21E56") +
  xlab("Kendall's Tau") +
  ylab("Density (Variance)") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))

ggplot(raw.sim.var.15.tau, aes(x = Treatment, y = k.tau)) + 
  geom_violin(fill = cols, colour = cols) +
  geom_jitter(height = 0, width = 0.2, colour = cols.pt) +
  stat_summary(fun.y = median, geom = "point", size = 6, colour = "black", shape = 18) + 
  xlab("Variance") +
  ylab("Kendall's Tau") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```

## Co-Efficient of Variation

```{r}
summary(constant.sims.cv.15.tau); summary(warming.sims.cv.15.tau)
(length(warming.sims.cv.15.tau) - length(which(warming.sims.cv.15.tau < 0)))/length(warming.sims.cv.15.tau)
(length(warming.sims.cv.15.tau) - length(which(warming.sims.cv.15.tau < median(constant.sims.cv.15.tau))))/length(warming.sims.cv.15.tau)

raw.sim.cv.15.tau <- data.frame(cbind(constant.sims.cv.15.tau, warming.sims.cv.15.tau))
Treatment <- c(rep("Constant", 1000), rep("Warming", 1000))
k.tau <- c(constant.sims.cv.15.tau, warming.sims.cv.15.tau)
raw.sim.cv.15.tau <- data.frame(
  Treatment = Treatment, 
  k.tau = k.tau
)
saveRDS(raw.sim.cv.15.tau, "Objects/raw.sim.cv.15.tau.rds")

cols <- c(rep("#1434A4", 512), rep("#C21E56", 512))
cols.pt <- c(rep("#A7C7E7", 1000), rep("#F6799D", 1000))

med.const.sims.cv.15.tau <- median(constant.sims.cv.15.tau)
med.warm.sims.cv.15.tau <- median(warming.sims.cv.15.tau)
ggplot(data = raw.sim.cv.15.tau, aes(x = k.tau, group = Treatment, fill = Treatment)) +
  geom_density(alpha = 0.4, colour = cols) +
  scale_fill_manual(values = c("#1434A4", "#C21E56")) +
  geom_vline(xintercept = med.const.sims.cv.15.tau, colour = "#1434A4") +
  geom_vline(xintercept = med.warm.sims.cv.15.tau, colour = "#C21E56") +
  xlab("Kendall's Tau") +
  ylab("Density (Co-Efficient of Variation)") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))

ggplot(raw.sim.cv.15.tau, aes(x = Treatment, y = k.tau)) + 
  geom_violin(fill = cols, colour = cols) +
  geom_jitter(height = 0, width = 0.2, colour = cols.pt) +
  stat_summary(fun.y = median, geom = "point", size = 6, colour = "black", shape = 18) + 
  xlab("Co-Efficient of Variation") +
  ylab("Kendall's Tau") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```

## Index of Dispersion

```{r}
summary(constant.sims.id.15.tau); summary(warming.sims.id.15.tau)
(length(warming.sims.id.15.tau) - length(which(warming.sims.id.15.tau < 0)))/length(warming.sims.id.15.tau)
(length(warming.sims.id.15.tau) - length(which(warming.sims.id.15.tau < median(constant.sims.id.15.tau))))/length(warming.sims.id.15.tau)

raw.sim.id.15.tau <- data.frame(cbind(constant.sims.id.15.tau, warming.sims.id.15.tau))
Treatment <- c(rep("Constant", 1000), rep("Warming", 1000))
k.tau <- c(constant.sims.id.15.tau, warming.sims.id.15.tau)
raw.sim.id.15.tau <- data.frame(
  Treatment = Treatment, 
  k.tau = k.tau
)
saveRDS(raw.sim.id.15.tau, "Objects/raw.sim.id.15.tau.rds")

cols <- c(rep("#1434A4", 512), rep("#C21E56", 512))
cols.pt <- c(rep("#A7C7E7", 1000), rep("#F6799D", 1000))

med.const.sims.id.15.tau <- median(constant.sims.id.15.tau)
med.warm.sims.id.15.tau <- median(warming.sims.id.15.tau)
ggplot(data = raw.sim.id.15.tau, aes(x = k.tau, group = Treatment, fill = Treatment)) +
  geom_density(alpha = 0.4, colour = cols) +
  scale_fill_manual(values = c("#1434A4", "#C21E56")) +
  geom_vline(xintercept = med.const.sims.id.15.tau, colour = "#1434A4") +
  geom_vline(xintercept = med.warm.sims.id.15.tau, colour = "#C21E56") +
  xlab("Kendall's Tau") +
  ylab("Density (Index of Dispersion)") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))

ggplot(raw.sim.id.15.tau, aes(x = Treatment, y = k.tau)) + 
  geom_violin(fill = cols, colour = cols) +
  geom_jitter(height = 0, width = 0.2, colour = cols.pt) +
  stat_summary(fun.y = median, geom = "point", size = 6, colour = "black", shape = 18) + 
  xlab("Index of Dispersion") +
  ylab("Kendall's Tau") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```

## First Difference Variance

```{r}
summary(constant.sims.fdv.15.tau); summary(warming.sims.fdv.15.tau)
(length(warming.sims.fdv.15.tau) - length(which(warming.sims.fdv.15.tau < 0)))/length(warming.sims.fdv.15.tau)
(length(warming.sims.fdv.15.tau) - length(which(warming.sims.fdv.15.tau < median(constant.sims.fdv.15.tau))))/length(warming.sims.fdv.15.tau)

raw.sim.fdv.15.tau <- data.frame(cbind(constant.sims.fdv.15.tau, warming.sims.fdv.15.tau))
Treatment <- c(rep("Constant", 1000), rep("Warming", 1000))
k.tau <- c(constant.sims.fdv.15.tau, warming.sims.fdv.15.tau)
raw.sim.fdv.15.tau <- data.frame(
  Treatment = Treatment, 
  k.tau = k.tau
)
saveRDS(raw.sim.fdv.15.tau, "Objects/raw.sim.fdv.15.tau.rds")

cols <- c(rep("#1434A4", 512), rep("#C21E56", 512))
cols.pt <- c(rep("#A7C7E7", 1000), rep("#F6799D", 1000))

med.const.sims.fdv.15.tau <- median(constant.sims.fdv.15.tau)
med.warm.sims.fdv.15.tau <- median(warming.sims.fdv.15.tau)
ggplot(data = raw.sim.fdv.15.tau, aes(x = k.tau, group = Treatment, fill = Treatment)) +
  geom_density(alpha = 0.4, colour = cols) +
  scale_fill_manual(values = c("#1434A4", "#C21E56")) +
  geom_vline(xintercept = med.const.sims.fdv.15.tau, colour = "#1434A4") +
  geom_vline(xintercept = med.warm.sims.fdv.15.tau, colour = "#C21E56") +
  xlab("Kendall's Tau") +
  ylab("Density (First Difference Variance)") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))

ggplot(raw.sim.fdv.15.tau, aes(x = Treatment, y = k.tau)) + 
  geom_violin(fill = cols, colour = cols) +
  geom_jitter(height = 0, width = 0.2, colour = cols.pt) +
  stat_summary(fun.y = median, geom = "point", size = 6, colour = "black", shape = 18) + 
  xlab("First Difference Variance") +
  ylab("Kendall's Tau") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```

## Autocorrelation

```{r}
summary(constant.sims.cor.15.tau); summary(warming.sims.cor.15.tau)
(length(warming.sims.cor.15.tau) - length(which(warming.sims.cor.15.tau < 0)))/length(warming.sims.cor.15.tau)
(length(warming.sims.cor.15.tau) - length(which(warming.sims.cor.15.tau < median(constant.sims.cor.15.tau))))/length(warming.sims.cor.15.tau)

raw.sim.cor.15.tau <- data.frame(cbind(constant.sims.cor.15.tau, warming.sims.cor.15.tau))
Treatment <- c(rep("Constant", 1000), rep("Warming", 1000))
k.tau <- c(constant.sims.cor.15.tau, warming.sims.cor.15.tau)
raw.sim.cor.15.tau <- data.frame(
  Treatment = Treatment, 
  k.tau = k.tau
)
saveRDS(raw.sim.cor.15.tau, "Objects/raw.sim.cor.15.tau.rds")

cols <- c(rep("#1434A4", 512), rep("#C21E56", 512))
cols.pt <- c(rep("#A7C7E7", 1000), rep("#F6799D", 1000))

med.const.sims.cor.15.tau <- median(constant.sims.cor.15.tau)
med.warm.sims.cor.15.tau <- median(warming.sims.cor.15.tau)
ggplot(data = raw.sim.cor.15.tau, aes(x = k.tau, group = Treatment, fill = Treatment)) +
  geom_density(alpha = 0.4, colour = cols) +
  scale_fill_manual(values = c("#1434A4", "#C21E56")) +
  geom_vline(xintercept = med.const.sims.cor.15.tau, colour = "#1434A4") +
  geom_vline(xintercept = med.warm.sims.cor.15.tau, colour = "#C21E56") +
  xlab("Kendall's Tau") +
  ylab("Density (Autocorrelation)") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))

ggplot(raw.sim.cor.15.tau, aes(x = Treatment, y = k.tau)) + 
  geom_violin(fill = cols, colour = cols) +
  geom_jitter(height = 0, width = 0.2, colour = cols.pt) +
  stat_summary(fun.y = median, geom = "point", size = 6, colour = "black", shape = 18) + 
  xlab("Autocorrelation") +
  ylab("Kendall's Tau") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```

## Autocovariance

```{r}
summary(constant.sims.acv.15.tau); summary(warming.sims.acv.15.tau)
(length(warming.sims.acv.15.tau) - length(which(warming.sims.acv.15.tau < 0)))/length(warming.sims.acv.15.tau)
(length(warming.sims.acv.15.tau) - length(which(warming.sims.acv.15.tau < median(constant.sims.acv.15.tau))))/length(warming.sims.acv.15.tau)

raw.sim.acv.15.tau <- data.frame(cbind(constant.sims.acv.15.tau, warming.sims.acv.15.tau))
Treatment <- c(rep("Constant", 1000), rep("Warming", 1000))
k.tau <- c(constant.sims.acv.15.tau, warming.sims.acv.15.tau)
raw.sim.acv.15.tau <- data.frame(
  Treatment = Treatment, 
  k.tau = k.tau
)
saveRDS(raw.sim.acv.15.tau, "Objects/raw.sim.acv.15.tau.rds")

cols <- c(rep("#1434A4", 512), rep("#C21E56", 512))
cols.pt <- c(rep("#A7C7E7", 1000), rep("#F6799D", 1000))

med.const.sims.acv.15.tau <- median(constant.sims.acv.15.tau)
med.warm.sims.acv.15.tau <- median(warming.sims.acv.15.tau)
ggplot(data = raw.sim.acv.15.tau, aes(x = k.tau, group = Treatment, fill = Treatment)) +
  geom_density(alpha = 0.4, colour = cols) +
  scale_fill_manual(values = c("#1434A4", "#C21E56")) +
  geom_vline(xintercept = med.const.sims.acv.15.tau, colour = "#1434A4") +
  geom_vline(xintercept = med.warm.sims.acv.15.tau, colour = "#C21E56") +
  xlab("Kendall's Tau") +
  ylab("Density (Autocovariance)") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))

ggplot(raw.sim.acv.15.tau, aes(x = Treatment, y = k.tau)) + 
  geom_violin(fill = cols, colour = cols) +
  geom_jitter(height = 0, width = 0.2, colour = cols.pt) +
  stat_summary(fun.y = median, geom = "point", size = 6, colour = "black", shape = 18) + 
  xlab("Autocovariance") +
  ylab("Kendall's Tau") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```

## Decay Time

```{r}
summary(constant.sims.dt.15.tau); summary(warming.sims.dt.15.tau)
(length(warming.sims.dt.15.tau) - length(which(warming.sims.dt.15.tau < median(constant.sims.dt.15.tau))))/length(warming.sims.dt.15.tau)

raw.sim.dt.15.tau <- data.frame(cbind(constant.sims.dt.15.tau, warming.sims.dt.15.tau))
Treatment <- c(rep("Constant", 1000), rep("Warming", 1000))
k.tau <- c(constant.sims.dt.15.tau, warming.sims.dt.15.tau)
raw.sim.dt.15.tau <- data.frame(
  Treatment = Treatment, 
  k.tau = k.tau
)
saveRDS(raw.sim.dt.15.tau, "Objects/raw.sim.dt.15.tau.rds")

cols <- c(rep("#1434A4", 512), rep("#C21E56", 512))
cols.pt <- c(rep("#A7C7E7", 1000), rep("#F6799D", 1000))

med.const.sims.dt.15.tau <- median(constant.sims.dt.15.tau)
med.warm.sims.dt.15.tau <- median(warming.sims.dt.15.tau)
ggplot(data = raw.sim.dt.15.tau, aes(x = k.tau, group = Treatment, fill = Treatment)) +
  geom_density(alpha = 0.4, colour = cols) +
  scale_fill_manual(values = c("#1434A4", "#C21E56")) +
  geom_vline(xintercept = med.const.sims.dt.15.tau, colour = "#1434A4") +
  geom_vline(xintercept = med.warm.sims.dt.15.tau, colour = "#C21E56") +
  xlab("Kendall's Tau") +
  ylab("Density (Decay Time)") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))

ggplot(raw.sim.dt.15.tau, aes(x = Treatment, y = k.tau)) + 
  geom_violin(fill = cols, colour = cols) +
  geom_jitter(height = 0, width = 0.2, colour = cols.pt) +
  stat_summary(fun.y = median, geom = "point", size = 6, colour = "black", shape = 18) + 
  xlab("Decay Time") +
  ylab("Kendall's Tau") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```

# Raw, Empirical Data

## Data Wrangling

Okay, now we have to figure out if we're doing data cloning or whatever.

So, in Harris et al. (2020), this is what they did:

```{r}
kericho <- read.csv("/Users/mjarviscross/Desktop/Github/Kericho-EWS/kericho.csv")

# Approach to criticality
test<-kericho$BBK[204:340] # 137 of 455 observations; in our case, we restrict to the first 55 days (emergence at ~60)

# Generate 10,000 null permutations
obs <- list(length = 10001)
obs[[10001]] <- test # Original
  
set.seed(10022016) 
for (i in 1:10000){
  obs[[i]] <- sample(test, length(test), replace = FALSE)
} 

plot(obs[[1]], type = "l")
lines(obs[[2]], lty = 2)
lines(obs[[3]], lty = 3)
```

On our data:

```{r}
data <- read.csv("Kirk_Data/Epidemics_Data_Dryad/Kirk_et_al_epidemics_sampling_data.csv")

sub1 <- subset(data.sum, population == 1)
sub2 <- subset(data.sum, population == 2)
sub3 <- subset(data.sum, population == 3)
sub4 <- subset(data.sum, population == 4)
sub5 <- subset(data.sum, population == 5)
sub6 <- subset(data.sum, population == 6)
sub7 <- subset(data.sum, population == 7)
sub8 <- subset(data.sum, population == 8)

sub1 <- sub1$status.sum
sub2 <- sub2$status.sum
sub3 <- sub3$status.sum
sub4 <- sub4$status.sum
sub5 <- sub5$status.sum
sub6 <- sub6$status.sum
sub7 <- sub7$status.sum
sub8 <- sub8$status.sum

# Observation 20 is Day 60, so let's cut it off there
sub1.crit <- sub1[1:20]
sub2.crit <- sub2[1:20]
sub3.crit <- sub3[1:20]
sub4.crit <- sub4[1:20]
sub5.crit <- sub5[1:20]
sub6.crit <- sub6[1:20]
sub7.crit <- sub7[1:20]
sub8.crit <- sub8[1:20]

sub1.nulls <- list()
sub2.nulls <- list()
sub3.nulls <- list()
sub4.nulls <- list()
sub5.nulls <- list()
sub6.nulls <- list()
sub7.nulls <- list()
sub8.nulls <- list()

set.seed(123) 
for (i in 1:1000){
  sub1.nulls[[i]] <- sample(sub1.crit, length(sub1.crit), replace = FALSE)
  sub2.nulls[[i]] <- sample(sub2.crit, length(sub2.crit), replace = FALSE)
  sub3.nulls[[i]] <- sample(sub3.crit, length(sub3.crit), replace = FALSE)
  sub4.nulls[[i]] <- sample(sub4.crit, length(sub4.crit), replace = FALSE)
  sub5.nulls[[i]] <- sample(sub5.crit, length(sub5.crit), replace = FALSE)
  sub6.nulls[[i]] <- sample(sub6.crit, length(sub6.crit), replace = FALSE)
  sub7.nulls[[i]] <- sample(sub7.crit, length(sub7.crit), replace = FALSE)
  sub8.nulls[[i]] <- sample(sub8.crit, length(sub8.crit), replace = FALSE)
} 

plot(sub4.nulls[[1]], type = "l", col = "red3")
lines(sub4.nulls[[2]], col = "orange")
lines(sub4.nulls[[3]], col = "goldenrod1")
lines(sub4.nulls[[4]], col = "forestgreen")
lines(sub4.nulls[[5]], col = "cornflowerblue")
lines(sub4.crit, lwd = 2)

plot(sub8.nulls[[1]], type = "l", col = "red3")
lines(sub8.nulls[[2]], col = "orange")
lines(sub8.nulls[[3]], col = "goldenrod1")
lines(sub8.nulls[[4]], col = "forestgreen")
lines(sub8.nulls[[5]], col = "cornflowerblue")
lines(sub8.crit, lwd = 2)
```

## Calculating Metrics

### Mean, Standard Deviation, Skewness, Kurtosis

```{r}
sub1.nulls.mean <- list(); sub1.nulls.sd <- list(); sub1.nulls.sk <- list(); sub1.nulls.kt <- list()
sub2.nulls.mean <- list(); sub2.nulls.sd <- list(); sub2.nulls.sk <- list(); sub2.nulls.kt <- list()
sub3.nulls.mean <- list(); sub3.nulls.sd <- list(); sub3.nulls.sk <- list(); sub3.nulls.kt <- list()
sub4.nulls.mean <- list(); sub4.nulls.sd <- list(); sub4.nulls.sk <- list(); sub4.nulls.kt <- list()
sub5.nulls.mean <- list(); sub5.nulls.sd <- list(); sub5.nulls.sk <- list(); sub5.nulls.kt <- list()
sub6.nulls.mean <- list(); sub6.nulls.sd <- list(); sub6.nulls.sk <- list(); sub6.nulls.kt <- list()
sub7.nulls.mean <- list(); sub7.nulls.sd <- list(); sub7.nulls.sk <- list(); sub7.nulls.kt <- list()
sub8.nulls.mean <- list(); sub8.nulls.sd <- list(); sub8.nulls.sk <- list(); sub8.nulls.kt <- list()

for (i in 1:length(sub1.nulls)){
  sub1.nulls.mean[[i]] <- SlidingWindow(FUN = "mean", data = sub1.nulls[[i]], window = 5, step = 1)
  sub1.nulls.sd[[i]] <- SlidingWindow(FUN = "sd", data = sub1.nulls[[i]], window = 5, step = 1)
  sub1.nulls.sk[[i]] <- SlidingWindow(FUN = "skewness", data = sub1.nulls[[i]], window = 5, step = 1)
  sub1.nulls.kt[[i]] <- SlidingWindow(FUN = "kurtosis", data = sub1.nulls[[i]], window = 5, step = 1)
  
  sub2.nulls.mean[[i]] <- SlidingWindow(FUN = "mean", data = sub2.nulls[[i]], window = 5, step = 1)
  sub2.nulls.sd[[i]] <- SlidingWindow(FUN = "sd", data = sub2.nulls[[i]], window = 5, step = 1)
  sub2.nulls.sk[[i]] <- SlidingWindow(FUN = "skewness", data = sub2.nulls[[i]], window = 5, step = 1)
  sub2.nulls.kt[[i]] <- SlidingWindow(FUN = "kurtosis", data = sub2.nulls[[i]], window = 5, step = 1)
  
  sub3.nulls.mean[[i]] <- SlidingWindow(FUN = "mean", data = sub3.nulls[[i]], window = 5, step = 1)
  sub3.nulls.sd[[i]] <- SlidingWindow(FUN = "sd", data = sub3.nulls[[i]], window = 5, step = 1)
  sub3.nulls.sk[[i]] <- SlidingWindow(FUN = "skewness", data = sub3.nulls[[i]], window = 5, step = 1)
  sub3.nulls.kt[[i]] <- SlidingWindow(FUN = "kurtosis", data = sub3.nulls[[i]], window = 5, step = 1)
  
  sub4.nulls.mean[[i]] <- SlidingWindow(FUN = "mean", data = sub4.nulls[[i]], window = 5, step = 1)
  sub4.nulls.sd[[i]] <- SlidingWindow(FUN = "sd", data = sub4.nulls[[i]], window = 5, step = 1)
  sub4.nulls.sk[[i]] <- SlidingWindow(FUN = "skewness", data = sub4.nulls[[i]], window = 5, step = 1)
  sub4.nulls.kt[[i]] <- SlidingWindow(FUN = "kurtosis", data = sub4.nulls[[i]], window = 5, step = 1)
  
  sub5.nulls.mean[[i]] <- SlidingWindow(FUN = "mean", data = sub5.nulls[[i]], window = 5, step = 1)
  sub5.nulls.sd[[i]] <- SlidingWindow(FUN = "sd", data = sub5.nulls[[i]], window = 5, step = 1)
  sub5.nulls.sk[[i]] <- SlidingWindow(FUN = "skewness", data = sub5.nulls[[i]], window = 5, step = 1)
  sub5.nulls.kt[[i]] <- SlidingWindow(FUN = "kurtosis", data = sub5.nulls[[i]], window = 5, step = 1)
  
  sub6.nulls.mean[[i]] <- SlidingWindow(FUN = "mean", data = sub6.nulls[[i]], window = 5, step = 1)
  sub6.nulls.sd[[i]] <- SlidingWindow(FUN = "sd", data = sub6.nulls[[i]], window = 5, step = 1)
  sub6.nulls.sk[[i]] <- SlidingWindow(FUN = "skewness", data = sub6.nulls[[i]], window = 5, step = 1)
  sub6.nulls.kt[[i]] <- SlidingWindow(FUN = "kurtosis", data = sub6.nulls[[i]], window = 5, step = 1)
  
  sub7.nulls.mean[[i]] <- SlidingWindow(FUN = "mean", data = sub7.nulls[[i]], window = 5, step = 1)
  sub7.nulls.sd[[i]] <- SlidingWindow(FUN = "sd", data = sub7.nulls[[i]], window = 5, step = 1)
  sub7.nulls.sk[[i]] <- SlidingWindow(FUN = "skewness", data = sub7.nulls[[i]], window = 5, step = 1)
  sub7.nulls.kt[[i]] <- SlidingWindow(FUN = "kurtosis", data = sub7.nulls[[i]], window = 5, step = 1)
  
  sub8.nulls.mean[[i]] <- SlidingWindow(FUN = "mean", data = sub8.nulls[[i]], window = 5, step = 1)
  sub8.nulls.sd[[i]] <- SlidingWindow(FUN = "sd", data = sub8.nulls[[i]], window = 5, step = 1)
  sub8.nulls.sk[[i]] <- SlidingWindow(FUN = "skewness", data = sub8.nulls[[i]], window = 5, step = 1)
  sub8.nulls.kt[[i]] <- SlidingWindow(FUN = "kurtosis", data = sub8.nulls[[i]], window = 5, step = 1)
}
```

### Variance

```{r}
sub1.nulls.var <- list(); sub2.nulls.var <- list(); sub3.nulls.var <- list(); sub4.nulls.var <- list()
sub5.nulls.var <- list(); sub6.nulls.var <- list(); sub7.nulls.var <- list(); sub8.nulls.var <- list()
for (i in 1:1000){
  sub1.nulls.var[[i]] <- sub1.nulls.sd[[i]]^2
  sub2.nulls.var[[i]] <- sub2.nulls.sd[[i]]^2
  sub3.nulls.var[[i]] <- sub3.nulls.sd[[i]]^2
  sub4.nulls.var[[i]] <- sub4.nulls.sd[[i]]^2
  sub5.nulls.var[[i]] <- sub5.nulls.sd[[i]]^2
  sub6.nulls.var[[i]] <- sub6.nulls.sd[[i]]^2
  sub7.nulls.var[[i]] <- sub7.nulls.sd[[i]]^2
  sub8.nulls.var[[i]] <- sub8.nulls.sd[[i]]^2
}
```

### Co-Efficient of Variation

```{r}
sub1.nulls.cv <- list(); sub2.nulls.cv <- list(); sub3.nulls.cv <- list(); sub4.nulls.cv <- list()
sub5.nulls.cv <- list(); sub6.nulls.cv <- list(); sub7.nulls.cv <- list(); sub8.nulls.cv <- list()
for (i in 1:1000){
  sub1.nulls.cv[[i]] <- sub1.nulls.sd[[i]]/(sub1.nulls.mean[[i]] + 1e-10)
  sub2.nulls.cv[[i]] <- sub2.nulls.sd[[i]]/(sub2.nulls.mean[[i]] + 1e-10)
  sub3.nulls.cv[[i]] <- sub3.nulls.sd[[i]]/(sub3.nulls.mean[[i]] + 1e-10)
  sub4.nulls.cv[[i]] <- sub4.nulls.sd[[i]]/(sub4.nulls.mean[[i]] + 1e-10)
  sub5.nulls.cv[[i]] <- sub5.nulls.sd[[i]]/(sub5.nulls.mean[[i]] + 1e-10)
  sub6.nulls.cv[[i]] <- sub6.nulls.sd[[i]]/(sub6.nulls.mean[[i]] + 1e-10)
  sub7.nulls.cv[[i]] <- sub7.nulls.sd[[i]]/(sub7.nulls.mean[[i]] + 1e-10)
  sub8.nulls.cv[[i]] <- sub8.nulls.sd[[i]]/(sub8.nulls.mean[[i]] + 1e-10)
}
```

### Index of Dispersion

```{r}
sub1.nulls.id <- list(); sub2.nulls.id <- list(); sub3.nulls.id <- list(); sub4.nulls.id <- list()
sub5.nulls.id <- list(); sub6.nulls.id <- list(); sub7.nulls.id <- list(); sub8.nulls.id <- list()
for (i in 1:1000){
  sub1.nulls.id[[i]] <- sub1.nulls.var[[i]]/(sub1.nulls.mean[[i]] + 1e-10)
  sub2.nulls.id[[i]] <- sub2.nulls.var[[i]]/(sub2.nulls.mean[[i]] + 1e-10)
  sub3.nulls.id[[i]] <- sub3.nulls.var[[i]]/(sub3.nulls.mean[[i]] + 1e-10)
  sub4.nulls.id[[i]] <- sub4.nulls.var[[i]]/(sub4.nulls.mean[[i]] + 1e-10)
  sub5.nulls.id[[i]] <- sub5.nulls.var[[i]]/(sub5.nulls.mean[[i]] + 1e-10)
  sub6.nulls.id[[i]] <- sub6.nulls.var[[i]]/(sub6.nulls.mean[[i]] + 1e-10)
  sub7.nulls.id[[i]] <- sub7.nulls.var[[i]]/(sub7.nulls.mean[[i]] + 1e-10)
  sub8.nulls.id[[i]] <- sub8.nulls.var[[i]]/(sub8.nulls.mean[[i]] + 1e-10)
}
```

### First Difference Variance

```{r}
sub1.nulls.fdv <- list(); sub2.nulls.fdv <- list(); sub3.nulls.fdv <- list(); sub4.nulls.fdv <- list()
sub5.nulls.fdv <- list(); sub6.nulls.fdv <- list(); sub7.nulls.fdv <- list(); sub8.nulls.fdv <- list()

for (i in 1:1000){
  sub1.nulls.fdv.temp <- c()
  sub2.nulls.fdv.temp <- c()
  sub3.nulls.fdv.temp <- c()
  sub4.nulls.fdv.temp <- c()
  sub5.nulls.fdv.temp <- c()
  sub6.nulls.fdv.temp <- c()
  sub7.nulls.fdv.temp <- c()
  sub8.nulls.fdv.temp <- c()
  for (j in 2:15){
    sub1.nulls.fdv.temp[j - 1] <- sub1.nulls.var[[i]][j] - sub1.nulls.var[[i]][j - 1]
    sub2.nulls.fdv.temp[j - 1] <- sub2.nulls.var[[i]][j] - sub2.nulls.var[[i]][j - 1]
    sub3.nulls.fdv.temp[j - 1] <- sub3.nulls.var[[i]][j] - sub3.nulls.var[[i]][j - 1]
    sub4.nulls.fdv.temp[j - 1] <- sub4.nulls.var[[i]][j] - sub4.nulls.var[[i]][j - 1]
    sub5.nulls.fdv.temp[j - 1] <- sub5.nulls.var[[i]][j] - sub5.nulls.var[[i]][j - 1]
    sub6.nulls.fdv.temp[j - 1] <- sub6.nulls.var[[i]][j] - sub6.nulls.var[[i]][j - 1]
    sub7.nulls.fdv.temp[j - 1] <- sub7.nulls.var[[i]][j] - sub7.nulls.var[[i]][j - 1]
    sub8.nulls.fdv.temp[j - 1] <- sub8.nulls.var[[i]][j] - sub8.nulls.var[[i]][j - 1]
  }
  sub1.nulls.fdv[[i]] <- sub1.nulls.fdv.temp
  sub2.nulls.fdv[[i]] <- sub2.nulls.fdv.temp
  sub3.nulls.fdv[[i]] <- sub3.nulls.fdv.temp
  sub4.nulls.fdv[[i]] <- sub4.nulls.fdv.temp
  sub5.nulls.fdv[[i]] <- sub5.nulls.fdv.temp
  sub6.nulls.fdv[[i]] <- sub6.nulls.fdv.temp
  sub7.nulls.fdv[[i]] <- sub7.nulls.fdv.temp
  sub8.nulls.fdv[[i]] <- sub8.nulls.fdv.temp
}
```

### Autocorrelation

```{r}
sub1.nulls.ac <- list(); sub2.nulls.ac <- list(); sub3.nulls.ac <- list(); sub4.nulls.ac <- list()
sub5.nulls.ac <- list(); sub6.nulls.ac <- list(); sub7.nulls.ac <- list(); sub8.nulls.ac <- list()

for (i in 1:1000){
  sub1.nulls.ac.temp <- c()
  sub2.nulls.ac.temp <- c()
  sub3.nulls.ac.temp <- c()
  sub4.nulls.ac.temp <- c()
  sub5.nulls.ac.temp <- c()
  sub6.nulls.ac.temp <- c()
  sub7.nulls.ac.temp <- c()
  sub8.nulls.ac.temp <- c()
  for (j in 1:15){
    window.start <- j; window.end <- j + 4
    sub1.nulls.ac.temp[j] <- acf(sub1.nulls[[i]][c(window.start:window.end)], 
                                 plot = FALSE, type = "correlation")[[1]][2] 
    sub2.nulls.ac.temp[j] <- acf(sub2.nulls[[i]][c(window.start:window.end)], 
                                 plot = FALSE, type = "correlation")[[1]][2] 
    sub3.nulls.ac.temp[j] <- acf(sub3.nulls[[i]][c(window.start:window.end)], 
                                 plot = FALSE, type = "correlation")[[1]][2] 
    sub4.nulls.ac.temp[j] <- acf(sub4.nulls[[i]][c(window.start:window.end)], 
                                 plot = FALSE, type = "correlation")[[1]][2] 
    sub5.nulls.ac.temp[j] <- acf(sub5.nulls[[i]][c(window.start:window.end)], 
                                 plot = FALSE, type = "correlation")[[1]][2] 
    sub6.nulls.ac.temp[j] <- acf(sub6.nulls[[i]][c(window.start:window.end)], 
                                 plot = FALSE, type = "correlation")[[1]][2] 
    sub7.nulls.ac.temp[j] <- acf(sub7.nulls[[i]][c(window.start:window.end)], 
                                 plot = FALSE, type = "correlation")[[1]][2] 
    sub8.nulls.ac.temp[j] <- acf(sub8.nulls[[i]][c(window.start:window.end)], 
                                 plot = FALSE, type = "correlation")[[1]][2] 
  }
  sub1.nulls.ac[[i]] <- sub1.nulls.ac.temp
  sub2.nulls.ac[[i]] <- sub2.nulls.ac.temp
  sub3.nulls.ac[[i]] <- sub3.nulls.ac.temp
  sub4.nulls.ac[[i]] <- sub4.nulls.ac.temp
  sub5.nulls.ac[[i]] <- sub5.nulls.ac.temp
  sub6.nulls.ac[[i]] <- sub6.nulls.ac.temp
  sub7.nulls.ac[[i]] <- sub7.nulls.ac.temp
  sub8.nulls.ac[[i]] <- sub8.nulls.ac.temp
}
```

### Autocovariance

```{r}
sub1.nulls.acv <- list(); sub2.nulls.acv <- list(); sub3.nulls.acv <- list(); sub4.nulls.acv <- list()
sub5.nulls.acv <- list(); sub6.nulls.acv <- list(); sub7.nulls.acv <- list(); sub8.nulls.acv <- list()

for (i in 1:1000){
  sub1.nulls.acv.temp <- c()
  sub2.nulls.acv.temp <- c()
  sub3.nulls.acv.temp <- c()
  sub4.nulls.acv.temp <- c()
  sub5.nulls.acv.temp <- c()
  sub6.nulls.acv.temp <- c()
  sub7.nulls.acv.temp <- c()
  sub8.nulls.acv.temp <- c()
  for (j in 1:15){
    window.start <- j; window.end <- j + 4
    sub1.nulls.acv.temp[j] <- acf(sub1.nulls[[i]][c(window.start:window.end)], 
                                 plot = FALSE, type = "covariance")[[1]][2] 
    sub2.nulls.acv.temp[j] <- acf(sub2.nulls[[i]][c(window.start:window.end)], 
                                 plot = FALSE, type = "covariance")[[1]][2] 
    sub3.nulls.acv.temp[j] <- acf(sub3.nulls[[i]][c(window.start:window.end)], 
                                 plot = FALSE, type = "covariance")[[1]][2] 
    sub4.nulls.acv.temp[j] <- acf(sub4.nulls[[i]][c(window.start:window.end)], 
                                 plot = FALSE, type = "covariance")[[1]][2] 
    sub5.nulls.acv.temp[j] <- acf(sub5.nulls[[i]][c(window.start:window.end)], 
                                 plot = FALSE, type = "covariance")[[1]][2] 
    sub6.nulls.acv.temp[j] <- acf(sub6.nulls[[i]][c(window.start:window.end)], 
                                 plot = FALSE, type = "covariance")[[1]][2] 
    sub7.nulls.acv.temp[j] <- acf(sub7.nulls[[i]][c(window.start:window.end)], 
                                 plot = FALSE, type = "covariance")[[1]][2] 
    sub8.nulls.acv.temp[j] <- acf(sub8.nulls[[i]][c(window.start:window.end)], 
                                 plot = FALSE, type = "covariance")[[1]][2] 
  }
  sub1.nulls.acv[[i]] <- sub1.nulls.acv.temp
  sub2.nulls.acv[[i]] <- sub2.nulls.acv.temp
  sub3.nulls.acv[[i]] <- sub3.nulls.acv.temp
  sub4.nulls.acv[[i]] <- sub4.nulls.acv.temp
  sub5.nulls.acv[[i]] <- sub5.nulls.acv.temp
  sub6.nulls.acv[[i]] <- sub6.nulls.acv.temp
  sub7.nulls.acv[[i]] <- sub7.nulls.acv.temp
  sub8.nulls.acv[[i]] <- sub8.nulls.acv.temp
}
```

### Decay Time

```{r}
sub1.nulls.dt <- list(); sub2.nulls.dt <- list(); sub3.nulls.dt <- list(); sub4.nulls.dt <- list()
sub5.nulls.dt <- list(); sub6.nulls.dt <- list(); sub7.nulls.dt <- list(); sub8.nulls.dt <- list()

for (i in 1:1000){
  sub1.nulls.dt.temp <- c()
  sub2.nulls.dt.temp <- c()
  sub3.nulls.dt.temp <- c()
  sub4.nulls.dt.temp <- c()
  sub5.nulls.dt.temp <- c()
  sub6.nulls.dt.temp <- c()
  sub7.nulls.dt.temp <- c()
  sub8.nulls.dt.temp <- c()
  for (j in 1:15){
    suppressWarnings(sub1.nulls.dt.temp[j] <- -j/log(sub1.nulls.ac[[i]][j]))
    suppressWarnings(sub2.nulls.dt.temp[j] <- -j/log(sub2.nulls.ac[[i]][j]))
    suppressWarnings(sub3.nulls.dt.temp[j] <- -j/log(sub3.nulls.ac[[i]][j]))
    suppressWarnings(sub4.nulls.dt.temp[j] <- -j/log(sub4.nulls.ac[[i]][j]))
    suppressWarnings(sub5.nulls.dt.temp[j] <- -j/log(sub5.nulls.ac[[i]][j]))
    suppressWarnings(sub6.nulls.dt.temp[j] <- -j/log(sub6.nulls.ac[[i]][j]))
    suppressWarnings(sub7.nulls.dt.temp[j] <- -j/log(sub7.nulls.ac[[i]][j]))
    suppressWarnings(sub8.nulls.dt.temp[j] <- -j/log(sub8.nulls.ac[[i]][j]))
  }
  sub1.nulls.dt[[i]] <- sub1.nulls.dt.temp
  sub2.nulls.dt[[i]] <- sub2.nulls.dt.temp
  sub3.nulls.dt[[i]] <- sub3.nulls.dt.temp
  sub4.nulls.dt[[i]] <- sub4.nulls.dt.temp
  sub5.nulls.dt[[i]] <- sub5.nulls.dt.temp
  sub6.nulls.dt[[i]] <- sub6.nulls.dt.temp
  sub7.nulls.dt[[i]] <- sub7.nulls.dt.temp
  sub8.nulls.dt[[i]] <- sub8.nulls.dt.temp
}
```

## Kendall's Tau

### Mean

```{r}
sub1.null.mean.tau <- c(); sub2.null.mean.tau <- c(); sub3.null.mean.tau <- c(); sub4.null.mean.tau <- c()
sub5.null.mean.tau <- c(); sub6.null.mean.tau <- c(); sub7.null.mean.tau <- c(); sub8.null.mean.tau <- c()
t <- seq(1, 15, 1)
for (i in 1:1000){
  sub1.null.mean.tau[i] <- cor(sub1.nulls.mean[[i]], t, method = "kendall")
  sub2.null.mean.tau[i] <- cor(sub2.nulls.mean[[i]], t, method = "kendall")
  sub3.null.mean.tau[i] <- cor(sub3.nulls.mean[[i]], t, method = "kendall")
  sub4.null.mean.tau[i] <- cor(sub4.nulls.mean[[i]], t, method = "kendall")
  sub5.null.mean.tau[i] <- cor(sub5.nulls.mean[[i]], t, method = "kendall")
  sub6.null.mean.tau[i] <- cor(sub6.nulls.mean[[i]], t, method = "kendall")
  sub7.null.mean.tau[i] <- cor(sub7.nulls.mean[[i]], t, method = "kendall")
  sub8.null.mean.tau[i] <- cor(sub8.nulls.mean[[i]], t, method = "kendall")
}
```

### Skewness

```{r}
sub1.null.sk.tau <- c(); sub2.null.sk.tau <- c(); sub3.null.sk.tau <- c(); sub4.null.sk.tau <- c()
sub5.null.sk.tau <- c(); sub6.null.sk.tau <- c(); sub7.null.sk.tau <- c(); sub8.null.sk.tau <- c()
t <- seq(1, 15, 1)
for (i in 1:1000){
  sub1.null.sk.tau[i] <- cor(sub1.nulls.sk[[i]], t, method = "kendall")
  sub2.null.sk.tau[i] <- cor(sub2.nulls.sk[[i]], t, method = "kendall")
  sub3.null.sk.tau[i] <- cor(sub3.nulls.sk[[i]], t, method = "kendall")
  sub4.null.sk.tau[i] <- cor(sub4.nulls.sk[[i]], t, method = "kendall")
  sub5.null.sk.tau[i] <- cor(sub5.nulls.sk[[i]], t, method = "kendall")
  sub6.null.sk.tau[i] <- cor(sub6.nulls.sk[[i]], t, method = "kendall")
  sub7.null.sk.tau[i] <- cor(sub7.nulls.sk[[i]], t, method = "kendall")
  sub8.null.sk.tau[i] <- cor(sub8.nulls.sk[[i]], t, method = "kendall")
}
```

### Kurtosis

```{r}
sub1.null.kt.tau <- c(); sub2.null.kt.tau <- c(); sub3.null.kt.tau <- c(); sub4.null.kt.tau <- c()
sub5.null.kt.tau <- c(); sub6.null.kt.tau <- c(); sub7.null.kt.tau <- c(); sub8.null.kt.tau <- c()
t <- seq(1, 15, 1)
for (i in 1:1000){
  sub1.null.kt.tau[i] <- cor(sub1.nulls.kt[[i]], t, method = "kendall")
  sub2.null.kt.tau[i] <- cor(sub2.nulls.kt[[i]], t, method = "kendall")
  sub3.null.kt.tau[i] <- cor(sub3.nulls.kt[[i]], t, method = "kendall")
  sub4.null.kt.tau[i] <- cor(sub4.nulls.kt[[i]], t, method = "kendall")
  sub5.null.kt.tau[i] <- cor(sub5.nulls.kt[[i]], t, method = "kendall")
  sub6.null.kt.tau[i] <- cor(sub6.nulls.kt[[i]], t, method = "kendall")
  sub7.null.kt.tau[i] <- cor(sub7.nulls.kt[[i]], t, method = "kendall")
  sub8.null.kt.tau[i] <- cor(sub8.nulls.kt[[i]], t, method = "kendall")
}
```

### Variance

```{r}
sub1.null.var.tau <- c(); sub2.null.var.tau <- c(); sub3.null.var.tau <- c(); sub4.null.var.tau <- c()
sub5.null.var.tau <- c(); sub6.null.var.tau <- c(); sub7.null.var.tau <- c(); sub8.null.var.tau <- c()
t <- seq(1, 15, 1)
for (i in 1:1000){
  sub1.null.var.tau[i] <- cor(sub1.nulls.var[[i]], t, method = "kendall")
  sub2.null.var.tau[i] <- cor(sub2.nulls.var[[i]], t, method = "kendall")
  sub3.null.var.tau[i] <- cor(sub3.nulls.var[[i]], t, method = "kendall")
  sub4.null.var.tau[i] <- cor(sub4.nulls.var[[i]], t, method = "kendall")
  sub5.null.var.tau[i] <- cor(sub5.nulls.var[[i]], t, method = "kendall")
  sub6.null.var.tau[i] <- cor(sub6.nulls.var[[i]], t, method = "kendall")
  sub7.null.var.tau[i] <- cor(sub7.nulls.var[[i]], t, method = "kendall")
  sub8.null.var.tau[i] <- cor(sub8.nulls.var[[i]], t, method = "kendall")
}
```

### Co-Efficient of Variation

```{r}
sub1.null.cv.tau <- c(); sub2.null.cv.tau <- c(); sub3.null.cv.tau <- c(); sub4.null.cv.tau <- c()
sub5.null.cv.tau <- c(); sub6.null.cv.tau <- c(); sub7.null.cv.tau <- c(); sub8.null.cv.tau <- c()
t <- seq(1, 15, 1)
for (i in 1:1000){
  sub1.null.cv.tau[i] <- cor(sub1.nulls.cv[[i]], t, method = "kendall")
  sub2.null.cv.tau[i] <- cor(sub2.nulls.cv[[i]], t, method = "kendall")
  sub3.null.cv.tau[i] <- cor(sub3.nulls.cv[[i]], t, method = "kendall")
  sub4.null.cv.tau[i] <- cor(sub4.nulls.cv[[i]], t, method = "kendall")
  sub5.null.cv.tau[i] <- cor(sub5.nulls.cv[[i]], t, method = "kendall")
  sub6.null.cv.tau[i] <- cor(sub6.nulls.cv[[i]], t, method = "kendall")
  sub7.null.cv.tau[i] <- cor(sub7.nulls.cv[[i]], t, method = "kendall")
  sub8.null.cv.tau[i] <- cor(sub8.nulls.cv[[i]], t, method = "kendall")
}
```

### Index of Dispersion

```{r}
sub1.null.id.tau <- c(); sub2.null.id.tau <- c(); sub3.null.id.tau <- c(); sub4.null.id.tau <- c()
sub5.null.id.tau <- c(); sub6.null.id.tau <- c(); sub7.null.id.tau <- c(); sub8.null.id.tau <- c()
t <- seq(1, 15, 1)
for (i in 1:1000){
  sub1.null.id.tau[i] <- cor(sub1.nulls.id[[i]], t, method = "kendall")
  sub2.null.id.tau[i] <- cor(sub2.nulls.id[[i]], t, method = "kendall")
  sub3.null.id.tau[i] <- cor(sub3.nulls.id[[i]], t, method = "kendall")
  sub4.null.id.tau[i] <- cor(sub4.nulls.id[[i]], t, method = "kendall")
  sub5.null.id.tau[i] <- cor(sub5.nulls.id[[i]], t, method = "kendall")
  sub6.null.id.tau[i] <- cor(sub6.nulls.id[[i]], t, method = "kendall")
  sub7.null.id.tau[i] <- cor(sub7.nulls.id[[i]], t, method = "kendall")
  sub8.null.id.tau[i] <- cor(sub8.nulls.id[[i]], t, method = "kendall")
}
```

### First Difference Variance

```{r}
sub1.null.fdv.tau <- c(); sub2.null.fdv.tau <- c(); sub3.null.fdv.tau <- c(); sub4.null.fdv.tau <- c()
sub5.null.fdv.tau <- c(); sub6.null.fdv.tau <- c(); sub7.null.fdv.tau <- c(); sub8.null.fdv.tau <- c()
t <- seq(1, 14, 1)
for (i in 1:1000){
  sub1.null.fdv.tau[i] <- cor(sub1.nulls.fdv[[i]], t, method = "kendall")
  sub2.null.fdv.tau[i] <- cor(sub2.nulls.fdv[[i]], t, method = "kendall")
  sub3.null.fdv.tau[i] <- cor(sub3.nulls.fdv[[i]], t, method = "kendall")
  sub4.null.fdv.tau[i] <- cor(sub4.nulls.fdv[[i]], t, method = "kendall")
  sub5.null.fdv.tau[i] <- cor(sub5.nulls.fdv[[i]], t, method = "kendall")
  sub6.null.fdv.tau[i] <- cor(sub6.nulls.fdv[[i]], t, method = "kendall")
  sub7.null.fdv.tau[i] <- cor(sub7.nulls.fdv[[i]], t, method = "kendall")
  sub8.null.fdv.tau[i] <- cor(sub8.nulls.fdv[[i]], t, method = "kendall")
}
```

### Autocorrelation

```{r}
sub1.null.ac.tau <- c(); sub2.null.ac.tau <- c(); sub3.null.ac.tau <- c(); sub4.null.ac.tau <- c()
sub5.null.ac.tau <- c(); sub6.null.ac.tau <- c(); sub7.null.ac.tau <- c(); sub8.null.ac.tau <- c()
t <- seq(1, 15, 1)
for (i in 1:1000){
  sub1.null.ac.tau[i] <- cor(sub1.nulls.ac[[i]], t, method = "kendall")
  sub2.null.ac.tau[i] <- cor(sub2.nulls.ac[[i]], t, method = "kendall")
  sub3.null.ac.tau[i] <- cor(sub3.nulls.ac[[i]], t, method = "kendall")
  sub4.null.ac.tau[i] <- cor(sub4.nulls.ac[[i]], t, method = "kendall")
  sub5.null.ac.tau[i] <- cor(sub5.nulls.ac[[i]], t, method = "kendall")
  sub6.null.ac.tau[i] <- cor(sub6.nulls.ac[[i]], t, method = "kendall")
  sub7.null.ac.tau[i] <- cor(sub7.nulls.ac[[i]], t, method = "kendall")
  sub8.null.ac.tau[i] <- cor(sub8.nulls.ac[[i]], t, method = "kendall")
}
```

### Autocovariance

```{r}
sub1.null.acv.tau <- c(); sub2.null.acv.tau <- c(); sub3.null.acv.tau <- c(); sub4.null.acv.tau <- c()
sub5.null.acv.tau <- c(); sub6.null.acv.tau <- c(); sub7.null.acv.tau <- c(); sub8.null.acv.tau <- c()
t <- seq(1, 15, 1)
for (i in 1:1000){
  sub1.null.acv.tau[i] <- cor(sub1.nulls.acv[[i]], t, method = "kendall")
  sub2.null.acv.tau[i] <- cor(sub2.nulls.acv[[i]], t, method = "kendall")
  sub3.null.acv.tau[i] <- cor(sub3.nulls.acv[[i]], t, method = "kendall")
  sub4.null.acv.tau[i] <- cor(sub4.nulls.acv[[i]], t, method = "kendall")
  sub5.null.acv.tau[i] <- cor(sub5.nulls.acv[[i]], t, method = "kendall")
  sub6.null.acv.tau[i] <- cor(sub6.nulls.acv[[i]], t, method = "kendall")
  sub7.null.acv.tau[i] <- cor(sub7.nulls.acv[[i]], t, method = "kendall")
  sub8.null.acv.tau[i] <- cor(sub8.nulls.acv[[i]], t, method = "kendall")
}
```

### Decay Time

```{r}
sub1.null.dt.tau <- c(); sub2.null.dt.tau <- c(); sub3.null.dt.tau <- c(); sub4.null.dt.tau <- c()
sub5.null.dt.tau <- c(); sub6.null.dt.tau <- c(); sub7.null.dt.tau <- c(); sub8.null.dt.tau <- c()
t <- seq(1, 15, 1)
for (i in 1:1000){
  sub1.null.dt.tau[i] <- cor(sub1.nulls.dt[[i]], t, method = "kendall")
  sub2.null.dt.tau[i] <- cor(sub2.nulls.dt[[i]], t, method = "kendall")
  sub3.null.dt.tau[i] <- cor(sub3.nulls.dt[[i]], t, method = "kendall")
  sub4.null.dt.tau[i] <- cor(sub4.nulls.dt[[i]], t, method = "kendall")
  sub5.null.dt.tau[i] <- cor(sub5.nulls.dt[[i]], t, method = "kendall")
  sub6.null.dt.tau[i] <- cor(sub6.nulls.dt[[i]], t, method = "kendall")
  sub7.null.dt.tau[i] <- cor(sub7.nulls.dt[[i]], t, method = "kendall")
  sub8.null.dt.tau[i] <- cor(sub8.nulls.dt[[i]], t, method = "kendall")
}
```

## Plotting

### Empirical Data

From `4_EWS-EmpData.Rmd`.

```{r}
sub1.mean.tau <- constant.mean.tau[1]
sub2.mean.tau <- constant.mean.tau[2]
sub3.mean.tau <- constant.mean.tau[3]
sub4.mean.tau <- constant.mean.tau[4]
sub5.mean.tau <- warming.mean.tau[1]
sub6.mean.tau <- warming.mean.tau[2]
sub7.mean.tau <- warming.mean.tau[3]
sub8.mean.tau <- warming.mean.tau[4]

sub1.sk.tau <- constant.sk.tau[1]
sub2.sk.tau <- constant.sk.tau[2]
sub3.sk.tau <- constant.sk.tau[3]
sub4.sk.tau <- constant.sk.tau[4]
sub5.sk.tau <- warming.sk.tau[1]
sub6.sk.tau <- warming.sk.tau[2]
sub7.sk.tau <- warming.sk.tau[3]
sub8.sk.tau <- warming.sk.tau[4]

sub1.kt.tau <- constant.kt.tau[1]
sub2.kt.tau <- constant.kt.tau[2]
sub3.kt.tau <- constant.kt.tau[3]
sub4.kt.tau <- constant.kt.tau[4]
sub5.kt.tau <- warming.kt.tau[1]
sub6.kt.tau <- warming.kt.tau[2]
sub7.kt.tau <- warming.kt.tau[3]
sub8.kt.tau <- warming.kt.tau[4]

sub1.var.tau <- constant.var.tau[1]
sub2.var.tau <- constant.var.tau[2]
sub3.var.tau <- constant.var.tau[3]
sub4.var.tau <- constant.var.tau[4]
sub5.var.tau <- warming.var.tau[1]
sub6.var.tau <- warming.var.tau[2]
sub7.var.tau <- warming.var.tau[3]
sub8.var.tau <- warming.var.tau[4]

sub1.cv.tau <- constant.cv.tau[1]
sub2.cv.tau <- constant.cv.tau[2]
sub3.cv.tau <- constant.cv.tau[3]
sub4.cv.tau <- constant.cv.tau[4]
sub5.cv.tau <- warming.cv.tau[1]
sub6.cv.tau <- warming.cv.tau[2]
sub7.cv.tau <- warming.cv.tau[3]
sub8.cv.tau <- warming.cv.tau[4]

sub1.id.tau <- constant.id.tau[1]
sub2.id.tau <- constant.id.tau[2]
sub3.id.tau <- constant.id.tau[3]
sub4.id.tau <- constant.id.tau[4]
sub5.id.tau <- warming.id.tau[1]
sub6.id.tau <- warming.id.tau[2]
sub7.id.tau <- warming.id.tau[3]
sub8.id.tau <- warming.id.tau[4]

sub1.fdv.tau <- constant.fdv.tau[1]
sub2.fdv.tau <- constant.fdv.tau[2]
sub3.fdv.tau <- constant.fdv.tau[3]
sub4.fdv.tau <- constant.fdv.tau[4]
sub5.fdv.tau <- warming.fdv.tau[1]
sub6.fdv.tau <- warming.fdv.tau[2]
sub7.fdv.tau <- warming.fdv.tau[3]
sub8.fdv.tau <- warming.fdv.tau[4]

sub1.ac.tau <- constant.ac.tau[1]
sub2.ac.tau <- constant.ac.tau[2]
sub3.ac.tau <- constant.ac.tau[3]
sub4.ac.tau <- constant.ac.tau[4]
sub5.ac.tau <- warming.ac.tau[1]
sub6.ac.tau <- warming.ac.tau[2]
sub7.ac.tau <- warming.ac.tau[3]
sub8.ac.tau <- warming.ac.tau[4]

sub1.acv.tau <- constant.acv.tau[1]
sub2.acv.tau <- constant.acv.tau[2]
sub3.acv.tau <- constant.acv.tau[3]
sub4.acv.tau <- constant.acv.tau[4]
sub5.acv.tau <- warming.acv.tau[1]
sub6.acv.tau <- warming.acv.tau[2]
sub7.acv.tau <- warming.acv.tau[3]
sub8.acv.tau <- warming.acv.tau[4]

sub1.dt.tau <- constant.dt.tau[1]
sub2.dt.tau <- constant.dt.tau[2]
sub3.dt.tau <- constant.dt.tau[3]
sub4.dt.tau <- constant.dt.tau[4]
sub5.dt.tau <- warming.dt.tau[1]
sub6.dt.tau <- warming.dt.tau[2]
sub7.dt.tau <- warming.dt.tau[3]
sub8.dt.tau <- warming.dt.tau[4]
```

### Mean

```{r}
subpop <- c(rep("1", 1000), rep("2", 1000), rep("3", 1000), rep("4", 1000), rep("5", 1000), rep("6", 1000), rep("7", 1000), rep("8", 1000))
real.tau <- c(rep(sub1.mean.tau, 1000), rep(sub2.mean.tau, 1000), rep(sub3.mean.tau, 1000), rep(sub4.mean.tau, 1000), rep(sub5.mean.tau, 1000), rep(sub6.mean.tau, 1000), rep(sub7.mean.tau, 1000), rep(sub8.mean.tau, 1000))
null.mean.tau <- c(sub1.null.mean.tau, sub2.null.mean.tau, sub3.null.mean.tau, sub4.null.mean.tau, sub5.null.mean.tau, sub6.null.mean.tau, sub7.null.mean.tau, sub8.null.mean.tau)
null.mean.tau.df <- data.frame(
  subpop = subpop, 
  real.tau = real.tau,
  null.mean.tau = null.mean.tau
)

cols <- c(rep("#1434A4", 4000), rep("#C21E56", 4000))

ggplot(null.mean.tau.df, aes(x = subpop, y = null.mean.tau)) + 
  geom_violin() +
  geom_jitter(height = 0, width = 0.2, colour = cols, alpha = 0.1) +
  geom_point(aes(y = real.tau), size = 4, shape = 8) + 
  stat_summary(fun.y = median, geom = "point", size = 4, colour = "black", shape = 16) +
  xlab("Subpopulation") +
  ylab("Kendall's Tau (Mean)") +
  theme(axis.text.x = element_text(colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```

### Skewness

```{r}
subpop <- c(rep("1", 1000), rep("2", 1000), rep("3", 1000), rep("4", 1000), rep("5", 1000), rep("6", 1000), rep("7", 1000), rep("8", 1000))
real.tau <- c(rep(sub1.sk.tau, 1000), rep(sub2.sk.tau, 1000), rep(sub3.sk.tau, 1000), rep(sub4.sk.tau, 1000), rep(sub5.sk.tau, 1000), rep(sub6.sk.tau, 1000), rep(sub7.sk.tau, 1000), rep(sub8.sk.tau, 1000))
null.sk.tau <- c(sub1.null.sk.tau, sub2.null.sk.tau, sub3.null.sk.tau, sub4.null.sk.tau, sub5.null.sk.tau, sub6.null.sk.tau, sub7.null.sk.tau, sub8.null.sk.tau)
null.sk.tau.df <- data.frame(
  subpop = subpop, 
  real.tau = real.tau,
  null.sk.tau = null.sk.tau
)

cols <- c(rep("#1434A4", 4000), rep("#C21E56", 4000))

ggplot(null.sk.tau.df, aes(x = subpop, y = null.sk.tau)) + 
  geom_violin() +
  geom_jitter(height = 0, width = 0.2, colour = cols, alpha = 0.1) +
  geom_point(aes(y = real.tau), size = 4, shape = 8) + 
  stat_summary(fun.y = median, geom = "point", size = 4, colour = "black", shape = 16) +
  xlab("Subpopulation") +
  ylab("Kendall's Tau (Skewness)") +
  theme(axis.text.x = element_text(colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```

### Kurtosis

```{r}
subpop <- c(rep("1", 1000), rep("2", 1000), rep("3", 1000), rep("4", 1000), rep("5", 1000), rep("6", 1000), rep("7", 1000), rep("8", 1000))
real.tau <- c(rep(sub1.kt.tau, 1000), rep(sub2.kt.tau, 1000), rep(sub3.kt.tau, 1000), rep(sub4.kt.tau, 1000), rep(sub5.kt.tau, 1000), rep(sub6.kt.tau, 1000), rep(sub7.kt.tau, 1000), rep(sub8.kt.tau, 1000))
null.kt.tau <- c(sub1.null.kt.tau, sub2.null.kt.tau, sub3.null.kt.tau, sub4.null.kt.tau, sub5.null.kt.tau, sub6.null.kt.tau, sub7.null.kt.tau, sub8.null.kt.tau)
null.kt.tau.df <- data.frame(
  subpop = subpop, 
  real.tau = real.tau,
  null.kt.tau = null.kt.tau
)

cols <- c(rep("#1434A4", 4000), rep("#C21E56", 4000))

ggplot(null.kt.tau.df, aes(x = subpop, y = null.kt.tau)) + 
  geom_violin() +
  geom_jitter(height = 0, width = 0.2, colour = cols, alpha = 0.1) +
  geom_point(aes(y = real.tau), size = 4, shape = 8) + 
  stat_summary(fun.y = median, geom = "point", size = 4, colour = "black", shape = 16) +
  xlab("Subpopulation") +
  ylab("Kendall's Tau (Kurtosis)") +
  theme(axis.text.x = element_text(colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```

### Variance

```{r}
subpop <- c(rep("1", 1000), rep("2", 1000), rep("3", 1000), rep("4", 1000), rep("5", 1000), rep("6", 1000), rep("7", 1000), rep("8", 1000))
real.tau <- c(rep(sub1.var.tau, 1000), rep(sub2.var.tau, 1000), rep(sub3.var.tau, 1000), rep(sub4.var.tau, 1000), rep(sub5.var.tau, 1000), rep(sub6.var.tau, 1000), rep(sub7.var.tau, 1000), rep(sub8.var.tau, 1000))
null.var.tau <- c(sub1.null.var.tau, sub2.null.var.tau, sub3.null.var.tau, sub4.null.var.tau, sub5.null.var.tau, sub6.null.var.tau, sub7.null.var.tau, sub8.null.var.tau)
null.var.tau.df <- data.frame(
  subpop = subpop, 
  real.tau = real.tau,
  null.var.tau = null.var.tau
)

cols <- c(rep("#1434A4", 4000), rep("#C21E56", 4000))

ggplot(null.var.tau.df, aes(x = subpop, y = null.var.tau)) + 
  geom_violin() +
  geom_jitter(height = 0, width = 0.2, colour = cols, alpha = 0.1) +
  geom_point(aes(y = real.tau), size = 4, shape = 8) + 
  stat_summary(fun.y = median, geom = "point", size = 4, colour = "black", shape = 16) +
  xlab("Subpopulation") +
  ylab("Kendall's Tau (Variance)") +
  theme(axis.text.x = element_text(colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```

### Co-Efficient of Variation

```{r}
subpop <- c(rep("1", 1000), rep("2", 1000), rep("3", 1000), rep("4", 1000), rep("5", 1000), rep("6", 1000), rep("7", 1000), rep("8", 1000))
real.tau <- c(rep(sub1.cv.tau, 1000), rep(sub2.cv.tau, 1000), rep(sub3.cv.tau, 1000), rep(sub4.cv.tau, 1000), rep(sub5.cv.tau, 1000), rep(sub6.cv.tau, 1000), rep(sub7.cv.tau, 1000), rep(sub8.cv.tau, 1000))
null.cv.tau <- c(sub1.null.cv.tau, sub2.null.cv.tau, sub3.null.cv.tau, sub4.null.cv.tau, sub5.null.cv.tau, sub6.null.cv.tau, sub7.null.cv.tau, sub8.null.cv.tau)
null.cv.tau.df <- data.frame(
  subpop = subpop, 
  real.tau = real.tau,
  null.cv.tau = null.cv.tau
)

cols <- c(rep("#1434A4", 4000), rep("#C21E56", 4000))

ggplot(null.cv.tau.df, aes(x = subpop, y = null.cv.tau)) + 
  geom_violin() +
  geom_jitter(height = 0, width = 0.2, colour = cols, alpha = 0.1) +
  geom_point(aes(y = real.tau), size = 4, shape = 8) + 
  stat_summary(fun.y = median, geom = "point", size = 4, colour = "black", shape = 16) +
  xlab("Subpopulation") +
  ylab("Kendall's Tau (Co-Efficient of Variation)") +
  theme(axis.text.x = element_text(colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```

### Index of Dispersion

```{r}
subpop <- c(rep("1", 1000), rep("2", 1000), rep("3", 1000), rep("4", 1000), rep("5", 1000), rep("6", 1000), rep("7", 1000), rep("8", 1000))
real.tau <- c(rep(sub1.id.tau, 1000), rep(sub2.id.tau, 1000), rep(sub3.id.tau, 1000), rep(sub4.id.tau, 1000), rep(sub5.id.tau, 1000), rep(sub6.id.tau, 1000), rep(sub7.id.tau, 1000), rep(sub8.id.tau, 1000))
null.id.tau <- c(sub1.null.id.tau, sub2.null.id.tau, sub3.null.id.tau, sub4.null.id.tau, sub5.null.id.tau, sub6.null.id.tau, sub7.null.id.tau, sub8.null.id.tau)
null.id.tau.df <- data.frame(
  subpop = subpop, 
  real.tau = real.tau,
  null.id.tau = null.id.tau
)

cols <- c(rep("#1434A4", 4000), rep("#C21E56", 4000))

ggplot(null.id.tau.df, aes(x = subpop, y = null.id.tau)) + 
  geom_violin() +
  geom_jitter(height = 0, width = 0.2, colour = cols, alpha = 0.1) +
  geom_point(aes(y = real.tau), size = 4, shape = 8) + 
  stat_summary(fun.y = median, geom = "point", size = 4, colour = "black", shape = 16) +
  xlab("Subpopulation") +
  ylab("Kendall's Tau (Index of Dispersion") +
  theme(axis.text.x = element_text(colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```

### First Difference Variance

```{r}
subpop <- c(rep("1", 1000), rep("2", 1000), rep("3", 1000), rep("4", 1000), rep("5", 1000), rep("6", 1000), rep("7", 1000), rep("8", 1000))
real.tau <- c(rep(sub1.fdv.tau, 1000), rep(sub2.fdv.tau, 1000), rep(sub3.fdv.tau, 1000), rep(sub4.fdv.tau, 1000), rep(sub5.fdv.tau, 1000), rep(sub6.fdv.tau, 1000), rep(sub7.fdv.tau, 1000), rep(sub8.fdv.tau, 1000))
null.fdv.tau <- c(sub1.null.fdv.tau, sub2.null.fdv.tau, sub3.null.fdv.tau, sub4.null.fdv.tau, sub5.null.fdv.tau, sub6.null.fdv.tau, sub7.null.fdv.tau, sub8.null.fdv.tau)
null.fdv.tau.df <- data.frame(
  subpop = subpop, 
  real.tau = real.tau,
  null.fdv.tau = null.fdv.tau
)

cols <- c(rep("#1434A4", 4000), rep("#C21E56", 4000))

ggplot(null.fdv.tau.df, aes(x = subpop, y = null.fdv.tau)) + 
  geom_violin() +
  geom_jitter(height = 0, width = 0.2, colour = cols, alpha = 0.1) +
  geom_point(aes(y = real.tau), size = 4, shape = 8) + 
  stat_summary(fun.y = median, geom = "point", size = 4, colour = "black", shape = 16) +
  xlab("Subpopulation") +
  ylab("Kendall's Tau (First Difference Variance)") +
  theme(axis.text.x = element_text(colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```

### Autocorrelation

```{r}
subpop <- c(rep("1", 1000), rep("2", 1000), rep("3", 1000), rep("4", 1000), rep("5", 1000), rep("6", 1000), rep("7", 1000), rep("8", 1000))
real.tau <- c(rep(sub1.ac.tau, 1000), rep(sub2.ac.tau, 1000), rep(sub3.ac.tau, 1000), rep(sub4.ac.tau, 1000), rep(sub5.ac.tau, 1000), rep(sub6.ac.tau, 1000), rep(sub7.ac.tau, 1000), rep(sub8.ac.tau, 1000))
null.ac.tau <- c(sub1.null.ac.tau, sub2.null.ac.tau, sub3.null.ac.tau, sub4.null.ac.tau, sub5.null.ac.tau, sub6.null.ac.tau, sub7.null.ac.tau, sub8.null.ac.tau)
null.ac.tau.df <- data.frame(
  subpop = subpop, 
  real.tau = real.tau,
  null.ac.tau = null.ac.tau
)

cols <- c(rep("#1434A4", 4000), rep("#C21E56", 4000))

ggplot(null.ac.tau.df, aes(x = subpop, y = null.ac.tau)) + 
  geom_violin() +
  geom_jitter(height = 0, width = 0.2, colour = cols, alpha = 0.1) +
  geom_point(aes(y = real.tau), size = 4, shape = 8) + 
  stat_summary(fun.y = median, geom = "point", size = 4, colour = "black", shape = 16) +
  xlab("Subpopulation") +
  ylab("Kendall's Tau (Autocorrelation)") +
  theme(axis.text.x = element_text(colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```

### Autocovariance

```{r}
subpop <- c(rep("1", 1000), rep("2", 1000), rep("3", 1000), rep("4", 1000), rep("5", 1000), rep("6", 1000), rep("7", 1000), rep("8", 1000))
real.tau <- c(rep(sub1.acv.tau, 1000), rep(sub2.acv.tau, 1000), rep(sub3.acv.tau, 1000), rep(sub4.acv.tau, 1000), rep(sub5.acv.tau, 1000), rep(sub6.acv.tau, 1000), rep(sub7.acv.tau, 1000), rep(sub8.acv.tau, 1000))
null.acv.tau <- c(sub1.null.acv.tau, sub2.null.acv.tau, sub3.null.acv.tau, sub4.null.acv.tau, sub5.null.acv.tau, sub6.null.acv.tau, sub7.null.acv.tau, sub8.null.acv.tau)
null.acv.tau.df <- data.frame(
  subpop = subpop, 
  real.tau = real.tau,
  null.acv.tau = null.acv.tau
)

cols <- c(rep("#1434A4", 4000), rep("#C21E56", 4000))

ggplot(null.acv.tau.df, aes(x = subpop, y = null.acv.tau)) + 
  geom_violin() +
  geom_jitter(height = 0, width = 0.2, colour = cols, alpha = 0.1) +
  geom_point(aes(y = real.tau), size = 4, shape = 8) + 
  stat_summary(fun.y = median, geom = "point", size = 4, colour = "black", shape = 16) +
  xlab("Subpopulation") +
  ylab("Kendall's Tau (Autocovariance)") +
  theme(axis.text.x = element_text(colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```

### Decay Time

```{r}
subpop <- c(rep("1", 1000), rep("2", 1000), rep("3", 1000), rep("4", 1000), rep("5", 1000), rep("6", 1000), rep("7", 1000), rep("8", 1000))
real.tau <- c(rep(sub1.dt.tau, 1000), rep(sub2.dt.tau, 1000), rep(sub3.dt.tau, 1000), rep(sub4.dt.tau, 1000), rep(sub5.dt.tau, 1000), rep(sub6.dt.tau, 1000), rep(sub7.dt.tau, 1000), rep(sub8.dt.tau, 1000))
null.dt.tau <- c(sub1.null.dt.tau, sub2.null.dt.tau, sub3.null.dt.tau, sub4.null.dt.tau, sub5.null.dt.tau, sub6.null.dt.tau, sub7.null.dt.tau, sub8.null.dt.tau)
null.dt.tau.df <- data.frame(
  subpop = subpop, 
  real.tau = real.tau,
  null.dt.tau = null.dt.tau
)

cols <- c(rep("#1434A4", 4000), rep("#C21E56", 4000))

ggplot(null.dt.tau.df, aes(x = subpop, y = null.dt.tau)) + 
  geom_violin() +
  geom_jitter(height = 0, width = 0.2, colour = cols, alpha = 0.1) +
  geom_point(aes(y = real.tau), size = 4, shape = 8) + 
  stat_summary(fun.y = median, geom = "point", size = 4, colour = "black", shape = 16) +
  xlab("Subpopulation") +
  ylab("Kendall's Tau (Decay Time)") +
  theme(axis.text.x = element_text(colour = "black"),
        text = element_text(size = 12)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))
```
