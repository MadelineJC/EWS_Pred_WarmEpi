# Looking for EWS in Empirical Data

## Required Packages

```{r, include = FALSE}
require(scales)
require(evobiR)
require(gdata)
require(doBy)
require(ecp)
require(strucchange)
require(TTR)
require(moments)
```

# Data Exploration

## Read in Data

```{r}
data <- read.csv("Kirk_Data/Epidemics_Data_Dryad/Kirk_et_al_epidemics_sampling_data.csv")
```

## Data Manipulation

```{r}
data.sum <- summaryBy(status ~ population + treatment + day, data = data, FUN = sum)

sub1 <- subset(data.sum, population == 1)
sub2 <- subset(data.sum, population == 2)
sub3 <- subset(data.sum, population == 3)
sub4 <- subset(data.sum, population == 4)
sub5 <- subset(data.sum, population == 5)
sub6 <- subset(data.sum, population == 6)
sub7 <- subset(data.sum, population == 7)
sub8 <- subset(data.sum, population == 8)
```

## Plotting Data

```{r}
par(mfrow = c(4, 2))
par(oma = c(4, 4, 0, 0))
par(mar = c(0, 0, 0, 0))

plot(sub1$status.sum, type = "l", col = "cornflowerblue", xaxt = "n", yaxt = "n", ylim = c(0,6))
abline(v = 20, lty = 3)

plot(sub2$status.sum,type = "l", col = "cornflowerblue", xaxt = "n", yaxt = "n", ylim = c(0,6))
abline(v = 20, lty = 3)

plot(sub3$status.sum,type = "l", col = "cornflowerblue", xaxt = "n", yaxt = "n", ylim = c(0,6))
abline(v = 20, lty = 3)

plot(sub4$status.sum,type = "l", col = "cornflowerblue", xaxt = "n", yaxt = "n", ylim = c(0,6))
abline(v = 20, lty = 3)

plot(sub5$status.sum, type = "l", col = "red3", xaxt = "n", yaxt = "n", ylim = c(0,6))
abline(v = 20, lty = 3)

plot(sub6$status.sum,type = "l", col = "red3", xaxt = "n", yaxt = "n", ylim = c(0,6))
abline(v = 20, lty = 3)

plot(sub7$status.sum,type = "l", col = "red3", xaxt = "n", yaxt = "n", ylim = c(0,6))
abline(v = 20, lty = 3)

plot(sub8$status.sum,type = "l", col = "red3", xaxt = "n", yaxt = "n", ylim = c(0,6))
abline(v = 20, lty = 3)

mtext(text = "Number of Infecteds", side = 2, line = 2, outer = TRUE)
mtext(text = "Days", side = 1, line = 2, outer = TRUE)
```

# Calculating Statistical Metrics

## 15 Day Sliding Window

Devin notes that due to the structure of the empirical data, we can't implement a shorter or longer window.

```{r}
## Standard deviation
pop1.sd <- SlidingWindow(FUN = "sd", data = sub1$status.sum, window = 5, step = 1)
pop2.sd <- SlidingWindow(FUN = "sd", data = sub2$status.sum, window = 5, step = 1)
pop3.sd <- SlidingWindow(FUN = "sd", data = sub3$status.sum, window = 5, step = 1)
pop4.sd <- SlidingWindow(FUN = "sd", data = sub4$status.sum, window = 5, step = 1)
pop5.sd <- SlidingWindow(FUN = "sd", data = sub5$status.sum, window = 5, step = 1)
pop6.sd <- SlidingWindow(FUN = "sd", data = sub6$status.sum, window = 5, step = 1)
pop7.sd <- SlidingWindow(FUN = "sd", data = sub7$status.sum, window = 5, step = 1)
pop8.sd <- SlidingWindow(FUN = "sd", data = sub8$status.sum, window = 5, step = 1)

## Mean
pop1.mean <- SlidingWindow(FUN = "mean", data = sub1$status.sum, window = 5, step = 1)
pop2.mean <- SlidingWindow(FUN = "mean", data = sub2$status.sum, window = 5, step = 1)
pop3.mean <- SlidingWindow(FUN = "mean", data = sub3$status.sum, window = 5, step = 1)
pop4.mean <- SlidingWindow(FUN = "mean", data = sub4$status.sum, window = 5, step = 1)
pop5.mean <- SlidingWindow(FUN = "mean", data = sub5$status.sum, window = 5, step = 1)
pop6.mean <- SlidingWindow(FUN = "mean", data = sub6$status.sum, window = 5, step = 1)
pop7.mean <- SlidingWindow(FUN = "mean", data = sub7$status.sum, window = 5, step = 1)
pop8.mean <- SlidingWindow(FUN = "mean", data = sub8$status.sum, window = 5, step = 1)

## Skewness
pop1.sk <- SlidingWindow(FUN = "skewness", data = sub1$status.sum, window = 5, step = 1)
pop2.sk <- SlidingWindow(FUN = "skewness", data = sub2$status.sum, window = 5, step = 1)
pop3.sk <- SlidingWindow(FUN = "skewness", data = sub3$status.sum, window = 5, step = 1)
pop4.sk <- SlidingWindow(FUN = "skewness", data = sub4$status.sum, window = 5, step = 1)
pop5.sk <- SlidingWindow(FUN = "skewness", data = sub5$status.sum, window = 5, step = 1)
pop6.sk <- SlidingWindow(FUN = "skewness", data = sub6$status.sum, window = 5, step = 1)
pop7.sk <- SlidingWindow(FUN = "skewness", data = sub7$status.sum, window = 5, step = 1)
pop8.sk <- SlidingWindow(FUN = "skewness", data = sub8$status.sum, window = 5, step = 1)

## Kurtosis
pop1.kt <- SlidingWindow(FUN = "kurtosis", data = sub1$status.sum, window = 5, step = 1)
pop2.kt <- SlidingWindow(FUN = "kurtosis", data = sub2$status.sum, window = 5, step = 1)
pop3.kt <- SlidingWindow(FUN = "kurtosis", data = sub3$status.sum, window = 5, step = 1)
pop4.kt <- SlidingWindow(FUN = "kurtosis", data = sub4$status.sum, window = 5, step = 1)
pop5.kt <- SlidingWindow(FUN = "kurtosis", data = sub5$status.sum, window = 5, step = 1)
pop6.kt <- SlidingWindow(FUN = "kurtosis", data = sub6$status.sum, window = 5, step = 1)
pop7.kt <- SlidingWindow(FUN = "kurtosis", data = sub7$status.sum, window = 5, step = 1)
pop8.kt <- SlidingWindow(FUN = "kurtosis", data = sub8$status.sum, window = 5, step = 1)
```

### Variance

```{r}
pop1.var <- pop1.sd^2
pop2.var <- pop2.sd^2
pop3.var <- pop3.sd^2
pop4.var <- pop4.sd^2
pop5.var <- pop5.sd^2
pop6.var <- pop6.sd^2
pop7.var <- pop7.sd^2
pop8.var <- pop8.sd^2
```

### Coefficient of Variation

We're adding 1e-10 to the mean so we don't divide by 0.

```{r}
pop1.cv <- pop1.sd/(pop1.mean + 1e-10)
pop2.cv <- pop2.sd/(pop2.mean + 1e-10)
pop3.cv <- pop3.sd/(pop3.mean + 1e-10)
pop4.cv <- pop4.sd/(pop4.mean + 1e-10)
pop5.cv <- pop5.sd/(pop5.mean + 1e-10)
pop6.cv <- pop6.sd/(pop6.mean + 1e-10)
pop7.cv <- pop7.sd/(pop7.mean + 1e-10)
pop8.cv <- pop8.sd/(pop8.mean + 1e-10)
```

### Index of Dispersion

```{r}
pop1.id <- pop1.var/(pop1.mean + 1e-10)
pop2.id <- pop2.var/(pop2.mean + 1e-10)
pop3.id <- pop3.var/(pop3.mean + 1e-10)
pop4.id <- pop4.var/(pop4.mean + 1e-10)
pop5.id <- pop5.var/(pop5.mean + 1e-10)
pop6.id <- pop6.var/(pop6.mean + 1e-10)
pop7.id <- pop7.var/(pop7.mean + 1e-10)
pop8.id <- pop8.var/(pop8.mean + 1e-10)
```

### First Difference Variance

```{r}
pop1.fdv <- c()
pop2.fdv <- c()
pop3.fdv <- c()
pop4.fdv <- c()
pop5.fdv <- c()
pop6.fdv <- c()
pop7.fdv <- c()
pop8.fdv <- c()

for(i in 2:35){
pop1.fdv[i - 1] <- pop1.var[i] - pop1.var[i - 1]
pop2.fdv[i - 1] <- pop2.var[i] - pop2.var[i - 1]
pop3.fdv[i - 1] <- pop3.var[i] - pop3.var[i - 1]
pop4.fdv[i - 1] <- pop4.var[i] - pop4.var[i - 1]
pop5.fdv[i - 1] <- pop5.var[i] - pop5.var[i - 1]
pop6.fdv[i - 1] <- pop6.var[i] - pop6.var[i - 1]
pop7.fdv[i - 1] <- pop7.var[i] - pop7.var[i - 1]
pop8.fdv[i - 1] <- pop8.var[i] - pop8.var[i - 1]
}
```

### Autocorrelation and Autocovariance

```{r}
pop1.ac <- c()
pop1.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  
  segment <- sub1$status.sum[c(window.start:window.end)]
  
  pop1.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop1.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}

pop2.ac <- c()
pop2.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  
  segment <- sub2$status.sum[c(window.start:window.end)]
  
  pop2.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop2.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}

pop3.ac <- c()
pop3.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  
  segment <- sub3$status.sum[c(window.start:window.end)]
  
  pop3.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop3.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}

pop4.ac <- c()
pop4.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  
  segment <- sub4$status.sum[c(window.start:window.end)]
  
  pop4.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop4.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}

pop5.ac <- c()
pop5.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  
  segment <- sub5$status.sum[c(window.start:window.end)]
  
  pop5.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop5.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}

pop6.ac <- c()
pop6.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  
  segment <- sub6$status.sum[c(window.start:window.end)]
  
  pop6.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop6.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}

pop7.ac <- c()
pop7.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  
  segment <- sub7$status.sum[c(window.start:window.end)]
  
  pop7.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop7.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}

pop8.ac <- c()
pop8.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  
  segment <- sub8$status.sum[c(window.start:window.end)]
  
  pop8.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop8.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
```

### Decay Time

```{r}
pop1.dt <- c()
pop2.dt <- c()
pop3.dt <- c()
pop4.dt <- c()
pop5.dt <- c()
pop6.dt <- c()
pop7.dt <- c()
pop8.dt <- c()

for(i in 1:35){
  suppressWarnings(pop1.dt[i] <- -i/log(pop1.ac[i]))
  suppressWarnings(pop2.dt[i] <- -i/log(pop2.ac[i]))
  suppressWarnings(pop3.dt[i] <- -i/log(pop3.ac[i]))
  suppressWarnings(pop4.dt[i] <- -i/log(pop4.ac[i]))
  suppressWarnings(pop5.dt[i] <- -i/log(pop5.ac[i]))
  suppressWarnings(pop6.dt[i] <- -i/log(pop6.ac[i]))
  suppressWarnings(pop7.dt[i] <- -i/log(pop7.ac[i]))
  suppressWarnings(pop8.dt[i] <- -i/log(pop8.ac[i]))
}
```

## 15 Day Sliding Window

Calculating Kendall Tau statistics for each metric:

```{r}
time.15 <- seq(1, 15, 1)

constant.mean.tau <- c(cor(pop1.mean[1:15], time.15, method = "kendall"), cor(pop2.mean[1:15], time.15, method = "kendall"),
                      cor(pop3.mean[1:15], time.15, method = "kendall"), cor(pop4.mean[1:15], time.15, method = "kendall"))
warming.mean.tau <- c(cor(pop5.mean[1:15], time.15, method = "kendall"), cor(pop6.mean[1:15], time.15, method = "kendall"),
                      cor(pop7.mean[1:15], time.15, method = "kendall"), cor(pop8.mean[1:15], time.15, method = "kendall"))

constant.sk.tau <- c(cor(pop1.sk[1:15], time.15, method = "kendall"), cor(pop2.sk[1:15], time.15, method = "kendall"),
                          cor(pop3.sk[1:15], time.15, method = "kendall"), cor(pop4.sk[1:15], time.15, method = "kendall"))
warming.sk.tau <- c(cor(pop5.sk[1:15], time.15, method = "kendall"), cor(pop6.sk[1:15], time.15, method = "kendall"),
                          cor(pop7.sk[1:15], time.15, method = "kendall"), cor(pop8.sk[1:15], time.15, method = "kendall"))

constant.kt.tau <- c(cor(pop1.kt[1:15], time.15, method = "kendall"), cor(pop2.kt[1:15], time.15, method = "kendall"),
                          cor(pop3.kt[1:15], time.15, method = "kendall"), cor(pop4.kt[1:15], time.15, method = "kendall"))
warming.kt.tau <- c(cor(pop5.kt[1:15], time.15, method = "kendall"), cor(pop6.kt[1:15], time.15, method = "kendall"),
                          cor(pop7.kt[1:15], time.15, method = "kendall"), cor(pop8.kt[1:15], time.15, method = "kendall"))

constant.var.tau <- c(cor(pop1.var[1:15], time.15, method = "kendall"), cor(pop2.var[1:15], time.15, method = "kendall"),
                          cor(pop3.var[1:15], time.15, method = "kendall"), cor(pop4.var[1:15], time.15, method = "kendall"))
warming.var.tau<- c(cor(pop5.var[1:15], time.15, method = "kendall"), cor(pop6.var[1:15], time.15, method = "kendall"),
                         cor(pop7.var[1:15], time.15, method = "kendall"), cor(pop8.var[1:15], time.15, method = "kendall"))

constant.cv.tau <- c(cor(pop1.cv[1:15], time.15, method = "kendall"), cor(pop2.cv[1:15], time.15, method = "kendall"),
                    cor(pop3.cv[1:15], time.15, method = "kendall"), cor(pop4.cv[1:15], time.15, method = "kendall"))
warming.cv.tau <- c(cor(pop5.cv[1:15], time.15, method = "kendall"), cor(pop6.cv[1:15], time.15, method = "kendall"),
                    cor(pop7.cv[1:15], time.15, method = "kendall"), cor(pop8.cv[1:15], time.15, method = "kendall"))

constant.id.tau <- c(cor(pop1.id[1:15], time.15, method = "kendall"), cor(pop2.id[1:15], time.15, method = "kendall"),
                    cor(pop3.id[1:15], time.15, method = "kendall"), cor(pop4.id[1:15], time.15, method = "kendall"))
warming.id.tau <- c(cor(pop5.id[1:15], time.15, method = "kendall"), cor(pop6.id[1:15], time.15, method = "kendall"),
                    cor(pop7.id[1:15], time.15, method = "kendall"), cor(pop8.id[1:15], time.15, method = "kendall"))

constant.fdv.tau <- c(cor(pop1.fdv[1:15], time.15, method = "kendall"), cor(pop2.fdv[1:15], time.15, method = "kendall"),
                                     cor(pop3.fdv[1:15], time.15, method = "kendall"), cor(pop4.fdv[1:15], time.15, method = "kendall"))
warming.fdv.tau <- c(cor(pop5.fdv[1:15], time.15, method = "kendall"), cor(pop6.fdv[1:15], time.15, method = "kendall"),
                                     cor(pop7.fdv[1:15], time.15, method = "kendall"), cor(pop8.fdv[1:15], time.15, method = "kendall"))

constant.ac.tau <- c(cor(pop1.ac[1:15], time.15, method = "kendall"), cor(pop2.ac[1:15], time.15, method = "kendall"),
                    cor(pop3.ac[1:15], time.15, method = "kendall"), cor(pop4.ac[1:15], time.15, method = "kendall"))
warming.ac.tau <- c(cor(pop5.ac[1:15], time.15, method = "kendall"), cor(pop6.ac[1:15], time.15, method = "kendall"),
                    cor(pop7.ac[1:15], time.15, method = "kendall"), cor(pop8.ac[1:15], time.15, method = "kendall"))

constant.acv.tau <- c(cor(pop1.acv[1:15], time.15, method = "kendall"), cor(pop2.acv[1:15], time.15, method = "kendall"),
                     cor(pop3.acv[1:15], time.15, method = "kendall"), cor(pop4.acv[1:15], time.15, method = "kendall"))
warming.acv.tau <- c(cor(pop5.acv[1:15], time.15, method = "kendall"), cor(pop6.acv[1:15], time.15, method = "kendall"),
                     cor(pop7.acv[1:15], time.15, method = "kendall"), cor(pop8.acv[1:15], time.15, method = "kendall"))

constant.dt.tau <- c(cor(pop1.dt[1:15], time.15, method = "kendall"), cor(pop2.dt[1:15], time.15, method = "kendall"),
                            cor(pop3.dt[1:15], time.15, method = "kendall"), cor(pop4.dt[1:15], time.15, method = "kendall"))
warming.dt.tau <- c(cor(pop5.dt[1:15], time.15, method = "kendall"), cor(pop6.dt[1:15], time.15, method = "kendall"),
                            cor(pop7.dt[1:15], time.15, method = "kendall"), cor(pop8.dt[1:15], time.15, method = "kendall"))
```

# Area Under Curve (AUC) Tests

Function to calculate AUC:

```{r}
calc_auc <- function(test.taus, null.taus){
  
  combined.taus <- c(test.taus,null.taus)
  r <- rank(combined.taus, na.last=NA)
  
  test.taus.length <- sum(!is.na(test.taus))
  null.taus.length <- sum(!is.na(null.taus))
  
  r1 <- sum(r[1:test.taus.length])
  
  n1 <- test.taus.length
  n2 <- null.taus.length
  
  (r1 - n1 * (n1 + 1) / 2) / (n1 * n2)
}
```

For reference, metrics and their short hands are as follows:

|                           |        |
|---------------------------|--------|
| Standard Deviation        | `sd`   |
| Mean                      | `mean` |
| Skew                      | `sk`   |
| Kurtosis                  | `kt`   |
| Variance                  | `var`  |
| Co-Efficient of Variance  | `cv`   |
| Index of Dispersion       | `id`   |
| First Difference Variance | `fdv`  |
| Autocorrelation           | `ac`   |
| Autocovariance            | `acv`  |
| Decay Time                | `dt`   |

```{r}
AUC_mean_data <- calc_auc(warming.mean.tau, constant.mean.tau); AUC_mean_data
AUC_sk_data <- calc_auc(warming.sk.tau, constant.sk.tau); AUC_sk_data
AUC_kt_data <- calc_auc(warming.kt.tau, constant.kt.tau); AUC_kt_data
AUC_var_data <- calc_auc(warming.var.tau, constant.var.tau); AUC_var_data
AUC_cv_data <- calc_auc(warming.cv.tau, constant.cv.tau); AUC_cv_data
AUC_id_data <- calc_auc(warming.id.tau, constant.id.tau); AUC_id_data
AUC_fdv_data <- calc_auc(warming.fdv.tau, constant.fdv.tau); AUC_fdv_data
AUC_ac_data <- calc_auc(warming.ac.tau, constant.ac.tau); AUC_ac_data
AUC_acv_data <- calc_auc(warming.acv.tau, constant.acv.tau); AUC_acv_data
AUC_dt_data <- calc_auc(warming.dt.tau, constant.dt.tau); AUC_dt_data
```

## Summarize Outputs

```{r}
metrics <- c("mean", "skewness", "kurtosis", "variance", "cv", "id", "fdv", "ac", "acv", "dt")

AUC_data <- c(AUC_mean_data, 
              AUC_sk_data, 
              AUC_kt_data, 
              AUC_var_data,
              AUC_cv_data,
              AUC_id_data, 
              AUC_fdv_data, 
              AUC_ac_data, 
              AUC_acv_data, 
              AUC_dt_data)

AUC_df <- data.frame(metrics, AUC_data); AUC_df
saveRDS(AUC_df, "Objects/AUC_EmpiricalData.rds")
```

A plot!

```{r}
metrics_full <- c("Mean", "Skewness", "Kurtosis", "Variance", "Covariance", "Index of Dispersion", "First Difference Variance", "Autocorrelation", "Autocovariance", "Decay Time")

## Plot
plot(1:10, AUC_df$AUC_data, type = "p", 
     main = "Empirical Data, All Populations", xaxt = "none", xlab = "", ylim = c(0, 1), ylab = "AUC",
     col = "orchid", pch = 19)
abline(h = 0.5, lty = 3)
axis(side = 1, at = 1:10, labels = metrics_full, las = 2)

## Saving plot as .png
png(file = "Plots/AUC_EmpiricalData_AllPopns.png", width = 1500, height = 350)
plot(1:10, AUC_df$AUC_data, type = "p", 
     main = "Empirical Data, All Populations", xaxt = "none", xlab = "", ylim = c(0, 1), ylab = "AUC",
     col = "orchid", pch = 19)
abline(h = 0.5, lty = 3)
axis(side = 1, at = 1:10, labels = metrics_full)
dev.off()
```

# Excluding Population 5

Population 5 never reached the epidemic stage; what happens when we remove it from the analysis?

```{r}
time.15 <- seq(1,15,1)

warming.mean.tau_without5 <- c(cor(pop6.mean[1:15], time.15, method = "kendall"),
                               cor(pop7.mean[1:15], time.15, method = "kendall"), 
                               cor(pop8.mean[1:15], time.15, method = "kendall"))

warming.sk.tau_without5 <- c(cor(pop6.sk[1:15], time.15, method = "kendall"),
                                   cor(pop7.sk[1:15], time.15, method = "kendall"), 
                                   cor(pop8.sk[1:15], time.15, method = "kendall"))


warming.kt.tau_without5 <- c(cor(pop6.kt[1:15], time.15, method = "kendall"),
                                   cor(pop7.kt[1:15], time.15, method = "kendall"), 
                                   cor(pop8.kt[1:15], time.15, method = "kendall"))

warming.var.tau_without5 <- c(cor(pop6.var[1:15], time.15, method = "kendall"),
                                   cor(pop7.var[1:15], time.15, method = "kendall"), 
                                   cor(pop8.var[1:15], time.15, method = "kendall"))

warming.cv.tau_without5 <- c(cor(pop6.cv[1:15], time.15, method = "kendall"),
                             cor(pop7.cv[1:15], time.15, method = "kendall"), 
                             cor(pop8.cv[1:15], time.15, method = "kendall"))

warming.id.tau_without5 <- c(cor(pop6.id[1:15], time.15, method = "kendall"),
                             cor(pop7.id[1:15], time.15, method = "kendall"), 
                             cor(pop8.id[1:15], time.15, method = "kendall"))

warming.ac.tau_without5 <- c(cor(pop6.ac[1:15], time.15, method = "kendall"),
                             cor(pop7.ac[1:15], time.15, method = "kendall"), 
                             cor(pop8.ac[1:15], time.15, method = "kendall"))


warming.acv.tau_without5 <- c(cor(pop6.acv[1:15], time.15, method = "kendall"),
                              cor(pop7.acv[1:15], time.15, method = "kendall"), 
                              cor(pop8.acv[1:15], time.15, method = "kendall"))

warming.fdv.tau_without5 <- c(cor(pop6.fdv[1:15], time.15, method = "kendall"),
                                              cor(pop7.fdv[1:15], time.15, method = "kendall"),
                                              cor(pop8.fdv[1:15], time.15, method = "kendall"))

warming.dt.tau_without5 <- c(cor(pop6.dt[1:15], time.15, method = "kendall"),
                                     cor(pop7.dt[1:15], time.15, method = "kendall"), 
                                     cor(pop8.dt[1:15], time.15, method = "kendall"))
```

## Summarize Outputs

```{r}
AUC_mean_data_without5 <- calc_auc(warming.mean.tau_without5,constant.mean.tau); AUC_mean_data_without5 
AUC_sk_data_without5 <- calc_auc(warming.sk.tau_without5,constant.sk.tau); AUC_sk_data_without5 
AUC_kt_data_without5 <- calc_auc(warming.kt.tau_without5, constant.kt.tau); AUC_kt_data_without5 
AUC_var_data_without5 <- calc_auc(warming.var.tau_without5,constant.var.tau); AUC_var_data_without5 
AUC_cv_data_without5 <- calc_auc(warming.cv.tau_without5,constant.cv.tau); AUC_cv_data_without5
AUC_id_data_without5 <- calc_auc(warming.id.tau_without5,constant.id.tau); AUC_id_data_without5 
AUC_fdv_data_without5 <- calc_auc(warming.fdv.tau_without5,constant.fdv.tau); AUC_fdv_data_without5 
AUC_ac_data_without5 <- calc_auc(warming.ac.tau_without5,constant.ac.tau); AUC_ac_data_without5 
AUC_acv_data_without5 <- calc_auc(warming.acv.tau_without5,constant.acv.tau); AUC_acv_data_without5 
AUC_dt_data_without5 <- calc_auc(warming.dt.tau_without5,constant.dt.tau); AUC_dt_data_without5 
```

```{r}
AUC_data <- c(AUC_mean_data_without5,
              AUC_sk_data_without5,
              AUC_kt_data_without5,
              AUC_var_data_without5,
              AUC_cv_data_without5,
              AUC_id_data_without5,
              AUC_fdv_data_without5,
              AUC_ac_data_without5,
              AUC_acv_data_without5,
              AUC_dt_data_without5)

AUC_df_without5 <- data.frame(metrics, AUC_data); AUC_df_without5
saveRDS(AUC_df_without5, "Objects/AUC_EmpiricalData_ExPop5.rds")
```

A plot!

```{r}
## Plots
plot(1:10, AUC_df_without5$AUC_data, type = "p", 
     main = "Empirical Data, Excluding Population 5", xaxt = "none", xlab = "", ylim = c(0.2, 0.8), ylab = "AUC",
     col = "red3", pch = 19)
abline(h = 0.5, lty = 3)
axis(side = 1, at = 1:10, labels = metrics_full, las = 2)

plot(1:10, AUC_df$AUC_data, type = "p", 
     main = "Empirical Data", xaxt = "none", xlab = "", ylim = c(0, 1), ylab = "AUC",
     col = "orchid", pch = 19)
points(1:10, AUC_df_without5$AUC_data, col = "red3", pch = 19)
abline(h = 0.5, lty = 3)
axis(side = 1, at = 1:10, labels = metrics_full, las = 2)
legend("topright", legend = c("All Populations", "Excluding Population 5"),
       col = c("orchid", "red3"), pch = 19)

## Saving plots as .pngs
png(file = "Plots/AUC_EmpiricalData_ExcludingPopn5.png", width = 1500, height = 350)
plot(1:10, AUC_df_without5$AUC_data, type = "p", 
     main = "Empirical Data, Excluding Population 5", xaxt = "none", xlab = "", ylim = c(0, 1), ylab = "AUC",
     col = "red3", pch = 19)
abline(h = 0.5, lty = 3)
axis(side = 1, at = 1:10, labels = metrics_full)
dev.off()

png(file = "Plots/AUC_EmpiricalData.png", width = 1500, height = 350)
plot(1:10, AUC_df$AUC_data, type = "p", 
     main = "Empirical Data", xaxt = "none", xlab = "", ylim = c(0, 1), ylab = "AUC",
     col = "orchid", pch = 19)
points(1:10, AUC_df_without5$AUC_data, col = "red3", pch = 19)
abline(h = 0.5, lty = 3)
axis(side = 1, at = 1:10, labels = metrics_full)
legend("topright", legend = c("All Populations", "Excluding Population 5"),
       col = c("orchid", "red3"), pch = 19)
dev.off()
```

# Plotting

## Empirical Results

```{r}
col.vec <- rep(c("gray0", "gray12", "gray24", "gray36"), 2)
time.plot <- c(6:20)

par(mfrow = c(3, 2))
par(mar = c(1, 1, 1, 1))
par(oma = c(4, 4, 0, 0))

plot(sub1$status.sum ~ sub1$day, type = "n", ylim = c(0, 6), ylab = NA, xlab = NA, cex.axis = 0.8)
for(i in 1:4){
  sub <- subset(data.sum, population == i)
  lines(sub$status.sum ~ sub$day, col = alpha(col.vec[i], 0.6), lty = 1, lwd = 3)
}
text(5, 5.5, labels = ("(a)"))
mtext("Disease Incidence", side = 2, cex = 1, line = 3, outer = FALSE)

plot(sub5$status.sum ~ sub5$day, type = "n", ylim = c(0,6), ylab = NA, xlab = NA, cex.axis = 0.8)
for(i in 5:8){
  sub <- subset(data.sum, population == i)
  lines(sub$status.sum ~ sub$day, col = alpha(col.vec[i], 0.6), lty = 1,lwd = 3)
}
abline(v = c(15, 30, 45, 75, 90, 105), lty = 3)
abline(v = c(60), col = "orchid", lty = 3, lwd = 4)
text(x = c(7.5, 22.5, 37.5, 52.5, 67.5, 82.5, 97.5, 112.5), y = 5.7, 
     labels = c("10.0C", "10.5C", "11.0C", "11.5C", "12.0C", "12.5C", "13.0C", "13.5C"), cex = 0.75)
text(5, 5, labels = ("(b)"))

# MEAN #
plot(pop1.mean[1:15] ~ time.plot, col = alpha(col.vec[1], 0.6), type = "l", ylim = c(0, 1.5), xlim = c(0, 40), lwd = 3)
lines(pop2.mean[1:15] ~ time.plot, col = alpha(col.vec[2], 0.6), lwd = 3, ylim = c(0, 4))
lines(pop3.mean[1:15] ~ time.plot, col = alpha(col.vec[3], 0.6), lwd = 3,ylim = c(0, 4))
lines(pop4.mean[1:15] ~ time.plot, col = alpha(col.vec[4], 0.6), lwd = 3,ylim = c(0, 4))
mtext("Mean", side = 2, cex = 1, line = 3, outer = FALSE)

plot(pop5.mean[1:15] ~ time.plot, col = alpha(col.vec[1], 0.6), lwd = 3,type = "l", ylim = c(0, 1.5), xlim = c(0, 40))
lines(pop6.mean[1:15] ~ time.plot,col = alpha(col.vec[2], 0.6), lwd = 3, ylim = c(0, 4))
lines(pop7.mean[1:15] ~ time.plot,col = alpha(col.vec[3], 0.6), lwd = 3, ylim = c(0, 4))
lines(pop8.mean[1:15] ~ time.plot, col = alpha(col.vec[4], 0.6),lwd = 3, ylim = c(0, 4))
abline(v = c(20), col = "orchid",lty = 3, lwd = 4)

## VARIANCE ##
plot(pop1.var[1:15] ~ time.plot, col = alpha(col.vec[1], 0.6), lwd = 3,type = "l",ylim = c(0, 2), xlim = c(0, 40))
lines(pop2.var[1:15] ~ time.plot, col = alpha(col.vec[2], 0.6), lwd = 3, ylim = c(0, 4))
lines(pop3.var[1:15] ~ time.plot, col = alpha(col.vec[3], 0.6), lwd = 3, ylim = c(0, 4))
lines(pop4.var[1:15] ~ time.plot, col = alpha(col.vec[4], 0.6), lwd = 3, ylim = c(0, 4))
mtext("Variance", side = 2, cex = 1, line = 3, outer = FALSE)

plot(pop5.var[1:15] ~ time.plot, col = alpha(col.vec[1], 0.6), lwd = 3, type = "l", ylim = c(0, 2), xlim = c(0, 40))
lines(pop6.var[1:15] ~ time.plot, col = alpha(col.vec[2], 0.6), lwd = 3, ylim = c(0, 4))
lines(pop7.var[1:15] ~ time.plot, col = alpha(col.vec[3], 0.6), lwd = 3, ylim = c(0, 4))
lines(pop8.var[1:15] ~ time.plot, col = alpha(col.vec[4], 0.6), lwd = 3, ylim = c(0, 4))
abline(v = c(60), col = "orchid",lty = 3, lwd = 4)

mtext("Day", side = 1, cex = 1, line = 2, outer = TRUE)
```

## Comparing Simulation and Empirical Results

```{r}
col.vec <- rep(c("gray0", "gray12", "gray24", "gray36"), 2)
time.plot <- c(6:20) # Experiments
plot.time <- c(16:60) # Simulations

par(mfrow = c(3, 4))
par(mar = c(1, 1, 1, 1))
par(oma = c(4, 4, 4, 0))

plot(constant.incidence.daily[, 1] ~ c(1:120),  type = "n", ylim = c(0, 100), xlim = c(0, 120), 
     xlab = "Time", ylab = "Disease Incidence", cex.lab = 1.5 , lwd = 3)
for(i in 1:1000){
  lines(constant.incidence.daily[ ,i] ~ c(1:120), col = alpha("black", 0.01), lwd = 1)
}
lines(constant.sims.mean.incidence, col = "black", lwd = 3)
mtext("Disease Incidence", side = 2, cex = 1, line = 3, outer = FALSE)
mtext("Constant", side = 3, cex = 1, line = 1, outer = FALSE)
text(10, 95, labels = ("a)"))

plot(warming.incidence.daily[, 1], col = "black", type = "n", ylim = c(0, 100), xlim = c(0, 120), 
     xlab = "Time", ylab = NA, cex.lab = 1.5)
for(i in 1:1000){
  lines(warming.incidence.daily[ ,i], col = alpha("black", 0.01), lwd = 1)
}
lines(warming.sims.mean.incidence, col = "black", lwd = 3)
abline(v = 60, lty = 2, col = "orchid",  lwd = 2)
mtext("Warming", side = 3, cex = 1, line = 1, outer = FALSE)
text(10, 95, labels = ("b)"))

plot(sub1$status.sum ~ sub1$day, type = "n", ylim = c(0, 6), ylab = NA, xlab = NA)
for(i in 1:4){
  sub <- subset(data.sum, population = i)
  lines(sub$status.sum ~ sub$day, col = alpha(col.vec[i], 0.6), lty = 1, lwd = 1)
}
mtext("Constant", side = 3, cex = 1 , line = 1, outer = FALSE)
text(5, 5.7,labels = ("c)"))

plot(sub5$status.sum ~ sub5$day, type = "n", ylim = c(0, 6), ylab = NA, xlab = NA)
for(i in 5:8){
  sub <- subset(data.sum, population = i)
  lines(sub$status.sum ~ sub$day, col = alpha(col.vec[i], 0.6), lty = 1, lwd = 1)
}
abline(v = c(60), col = "orchid", lty = 2, lwd = 2)
mtext("Warming", side = 3, cex = 1, line = 1, outer = FALSE)
mtext("Experiment", side = 3, cex = 1, line = 2, outer = TRUE, at = 0.75)
mtext("Simulations", side = 3, cex = 1, line =2, outer = TRUE, at = 0.25)
text(5, 5.7, labels = ("d)"))

# MEAN #
plot(constant.sims.mean.15[ ,1] ~ plot.time, col = "black", type = "n", ylim = c(0, 30), xlim = c(0, 120), 
     xlab = "Time", ylab = "Mean", cex.lab = 1.5)
for(i in 1:1000){
  lines(constant.sims.mean.15[ ,i] ~ plot.time, col = alpha("black", 0.05), lwd = 1)
}
lines(constant.sims.mean.mean ~ plot.time, col = "black", lwd = 3)
mtext("Mean", side = 2, cex = 1, line = 3, outer = FALSE)
text(5, 28.5, labels = ("e)"))

plot(warming.sims.mean.15[ ,1] ~ plot.time, col = "black", type = "n", ylim = c(0, 30), xlim = c(0, 120), 
     xlab = "Time", ylab = NA, cex.lab = 1.5)
for(i in 1:1000){
  lines(warming.sims.mean.15[ ,i] ~ plot.time, col = alpha("black", 0.05), lwd = 1)
}
lines(warming.sims.mean.mean ~ plot.time, col = "black", lwd = 3)
abline(v = 60, lty = 2, col = "orchid", lwd = 2)
text(5, 28.5, labels = ("f)"))

plot(pop1.mean[1:15] ~ time.plot, col = alpha(col.vec[1], 0.6), xaxt = "n", type = "l", ylim = c(0, 1), xlim = c(0, 40), lwd = 1)
lines(pop2.mean[1:15] ~ time.plot, col = alpha(col.vec[2], 0.6), lwd = 1 , ylim = c(0, 4))
lines(pop3.mean[1:15] ~ time.plot, col = alpha(col.vec[3], 0.6), lwd = 1, ylim = c(0, 4))
lines(pop4.mean[1:15] ~ time.plot, col = alpha(col.vec[4], 0.6), lwd = 1, ylim = c(0, 4))
axis(side = 1, at = c(0, 20/3, 40/3, 60/3, 80/3, 100/3, 120/3), labels = c(0, 20, 40, 60, 80, 100, 120))
text(5, 0.95, labels = ("g)"))

plot(pop5.mean[1:15] ~ time.plot, col = alpha(col.vec[1], 0.6), xaxt = "n", lwd = 1, type = "l", ylim = c(0, 1), xlim = c(0, 40))
lines(pop6.mean[1:15] ~ time.plot, col = alpha(col.vec[2], 0.6), lwd = 1, ylim = c(0, 4))
lines(pop7.mean[1:15] ~ time.plot, col = alpha(col.vec[3], 0.6), lwd = 1, ylim = c(0, 4))
lines(pop8.mean[1:15] ~ time.plot, col = alpha(col.vec[4], 0.6), lwd = 1, ylim = c(0, 4))
axis(side = 1, at = c(0, 20/3, 40/3, 60/3, 80/3, 100/3, 120/3), labels = c(0, 20, 40, 60, 80, 100, 120))
abline(v = c(20), col = "orchid", lty = 2, lwd = 2)
text(5, 0.95, labels = ("h)"))

# VARIANCE #
plot(constant.sims.var.15[ ,1] ~ plot.time, col = "black", type = "n", ylim = c(0, 20), xlim = c(0, 120), 
     xlab = "Time", ylab = "Variance", cex.lab = 1.5)
for(i in 1:1000){
  lines(constant.sims.var.15[ ,i] ~ plot.time, col = alpha("black", 0.01), lwd = 1)
}
lines(constant.sims.mean.var ~ plot.time, col = "black", lwd = 3)
mtext("Variance", side = 2, cex = 1, line = 3, outer = FALSE)
text(5, 19, labels = ("i)"))

plot(warming.sims.var.15[ ,1] ~ plot.time, col = "black", type = "n", ylim = c(0, 20), xlim = c(0, 120), 
     xlab = "Time", ylab = NA, cex.lab = 1.5)
for(i in 1:1000){
  lines(warming.sims.var.15[ ,i] ~ plot.time, col = alpha("black", 0.01), lwd = 1)
}
lines(warming.sims.mean.var ~ plot.time, col = "black", lwd = 3)
abline(v = 60, lty = 2, col = "orchid", lwd = 2)
text(5, 19, labels = ("j)"))

plot(pop1.var[1:15] ~ time.plot, col = alpha(col.vec[1], 0.6), xaxt = "n", lwd = 1, type = "l", ylim = c(0, 1.5), xlim = c(0, 40))
lines(pop2.var[1:15] ~ time.plot, col = alpha(col.vec[2], 0.6), lwd = 1, ylim = c(0, 4))
lines(pop3.var[1:15] ~ time.plot, col = alpha(col.vec[3], 0.6), lwd = 1, ylim = c(0, 4))
lines(pop4.var[1:15] ~ time.plot, col = alpha(col.vec[4], 0.6), lwd = 1, ylim = c(0, 4))
axis(side = 1, at = c(0, 20/3, 40/3, 60/3, 80/3, 100/3, 120/3),  labels = c(0, 20, 40, 60, 80, 100, 120))
text(5, 1.425, labels = ("k)"))

plot(pop5.var[1:15] ~ time.plot, col = alpha(col.vec[1], 0.6), xaxt = "n", lwd = 1, type = "l", ylim = c(0, 1.5), xlim = c(0, 40))
lines(pop6.var[1:15] ~ time.plot, col = alpha(col.vec[2], 0.6), lwd = 1, ylim = c(0, 4))
lines(pop7.var[1:15] ~ time.plot, col = alpha(col.vec[3], 0.6), lwd = 1, ylim = c(0, 4))
lines(pop8.var[1:15] ~ time.plot, col = alpha(col.vec[4], 0.6), lwd = 1, ylim = c(0, 4))
axis(side = 1, at = c(0, 20/3, 40/3, 60/3, 80/3, 100/3, 120/3), labels = c(0, 20, 40, 60, 80, 100, 120))
abline(v = c(20), col = "orchid", lty = 2, lwd = 2)
text(5, 1.425, labels = ("l)"))

mtext("Days", side = 1, cex = 1, line = 2, outer = TRUE)
```

Saving plots:

```{r}
## Plot 1
png("Plots/Sim-Emp_Comparison_1.png", width = 1200, height = 800)

col.vec <- rep(c("gray0", "gray12", "gray24", "gray36"), 2)
time.plot <- c(6:20)

par(mfrow = c(3, 2))
par(mar = c(1, 1, 1, 1))
par(oma = c(4, 4, 0, 0))

plot(sub1$status.sum ~ sub1$day, type = "n", ylim = c(0, 6), ylab = NA, xlab = NA, cex.axis = 0.8)
for(i in 1:4){
  sub <- subset(data.sum, population == i)
  lines(sub$status.sum ~ sub$day, col = alpha(col.vec[i], 0.6), lty = 1, lwd = 3)
}
text(5, 5.5, labels = ("(a)"))
mtext("Disease Incidence", side = 2, cex = 1, line = 3, outer = FALSE)

plot(sub5$status.sum ~ sub5$day, type = "n", ylim = c(0,6), ylab = NA, xlab = NA, cex.axis = 0.8)
for(i in 5:8){
  sub <- subset(data.sum, population == i)
  lines(sub$status.sum ~ sub$day, col = alpha(col.vec[i], 0.6), lty = 1,lwd = 3)
}
abline(v = c(15, 30, 45, 75, 90, 105), lty = 3)
abline(v = c(60), col = "orchid", lty = 3, lwd = 4)
text(x = c(7.5, 22.5, 37.5, 52.5, 67.5, 82.5, 97.5, 112.5), y = 5.7, 
     labels = c("10.0C", "10.5C", "11.0C", "11.5C", "12.0C", "12.5C", "13.0C", "13.5C"), cex = 0.75)
text(5, 5, labels = ("(b)"))

# MEAN #
plot(pop1.mean[1:15] ~ time.plot, col = alpha(col.vec[1], 0.6), type = "l", ylim = c(0, 1.5), xlim = c(0, 40), lwd = 3)
lines(pop2.mean[1:15] ~ time.plot, col = alpha(col.vec[2], 0.6), lwd = 3, ylim = c(0, 4))
lines(pop3.mean[1:15] ~ time.plot, col = alpha(col.vec[3], 0.6), lwd = 3,ylim = c(0, 4))
lines(pop4.mean[1:15] ~ time.plot, col = alpha(col.vec[4], 0.6), lwd = 3,ylim = c(0, 4))
mtext("Mean", side = 2, cex = 1, line = 3, outer = FALSE)

plot(pop5.mean[1:15] ~ time.plot, col = alpha(col.vec[1], 0.6), lwd = 3,type = "l", ylim = c(0, 1.5), xlim = c(0, 40))
lines(pop6.mean[1:15] ~ time.plot,col = alpha(col.vec[2], 0.6), lwd = 3, ylim = c(0, 4))
lines(pop7.mean[1:15] ~ time.plot,col = alpha(col.vec[3], 0.6), lwd = 3, ylim = c(0, 4))
lines(pop8.mean[1:15] ~ time.plot, col = alpha(col.vec[4], 0.6),lwd = 3, ylim = c(0, 4))
abline(v = c(20), col = "orchid",lty = 3, lwd = 4)

## VARIANCE ##
plot(pop1.var[1:15] ~ time.plot, col = alpha(col.vec[1], 0.6), lwd = 3,type = "l",ylim = c(0, 2), xlim = c(0, 40))
lines(pop2.var[1:15] ~ time.plot, col = alpha(col.vec[2], 0.6), lwd = 3, ylim = c(0, 4))
lines(pop3.var[1:15] ~ time.plot, col = alpha(col.vec[3], 0.6), lwd = 3, ylim = c(0, 4))
lines(pop4.var[1:15] ~ time.plot, col = alpha(col.vec[4], 0.6), lwd = 3, ylim = c(0, 4))
mtext("Variance", side = 2, cex = 1, line = 3, outer = FALSE)

plot(pop5.var[1:15] ~ time.plot, col = alpha(col.vec[1], 0.6), lwd = 3, type = "l", ylim = c(0, 2), xlim = c(0, 40))
lines(pop6.var[1:15] ~ time.plot, col = alpha(col.vec[2], 0.6), lwd = 3, ylim = c(0, 4))
lines(pop7.var[1:15] ~ time.plot, col = alpha(col.vec[3], 0.6), lwd = 3, ylim = c(0, 4))
lines(pop8.var[1:15] ~ time.plot, col = alpha(col.vec[4], 0.6), lwd = 3, ylim = c(0, 4))
abline(v = c(60), col = "orchid",lty = 3, lwd = 4)

mtext("Day", side = 1, cex = 1, line = 2, outer = TRUE)

dev.off()

## Plot 2
png("Plots/Sim-Emp_Comparison_2.png", width = 1200, height = 800)

par(mfrow = c(3, 4))
par(mar = c(1, 1, 1, 1))
par(oma = c(4, 4, 4, 0))

plot(constant.incidence.daily[, 1] ~ c(1:120),  type = "n", ylim = c(0, 100), xlim = c(0, 120), 
     xlab = "Time", ylab = "Disease Incidence", cex.lab = 1.5 , lwd = 3)
for(i in 1:1000){
  lines(constant.incidence.daily[ ,i] ~ c(1:120), col = alpha("black", 0.01), lwd = 1)
}
lines(constant.sims.mean.incidence, col = "black", lwd = 3)
mtext("Disease Incidence", side = 2, cex = 1, line = 3, outer = FALSE)
mtext("Constant", side = 3, cex = 1, line = 1, outer = FALSE)
text(10, 95, labels = ("a)"))

plot(warming.incidence.daily[, 1], col = "black", type = "n", ylim = c(0, 100), xlim = c(0, 120), 
     xlab = "Time", ylab = NA, cex.lab = 1.5)
for(i in 1:1000){
  lines(warming.incidence.daily[ ,i], col = alpha("black", 0.01), lwd = 1)
}
lines(warming.sims.mean.incidence, col = "black", lwd = 3)
abline(v = 60, lty = 2, col = "orchid",  lwd = 2)
mtext("Warming", side = 3, cex = 1, line = 1, outer = FALSE)
text(10, 95, labels = ("b)"))

plot(sub1$status.sum ~ sub1$day, type = "n", ylim = c(0, 6), ylab = NA, xlab = NA)
for(i in 1:4){
  sub <- subset(data.sum, population = i)
  lines(sub$status.sum ~ sub$day, col = alpha(col.vec[i], 0.6), lty = 1, lwd = 1)
}
mtext("Constant", side = 3, cex = 1 , line = 1, outer = FALSE)
text(5, 5.7,labels = ("c)"))

plot(sub5$status.sum ~ sub5$day, type = "n", ylim = c(0, 6), ylab = NA, xlab = NA)
for(i in 5:8){
  sub <- subset(data.sum, population = i)
  lines(sub$status.sum ~ sub$day, col = alpha(col.vec[i], 0.6), lty = 1, lwd = 1)
}
abline(v = c(60), col = "orchid", lty = 2, lwd = 2)
mtext("Warming", side = 3, cex = 1, line = 1, outer = FALSE)
mtext("Experiment", side = 3, cex = 1, line = 2, outer = TRUE, at = 0.75)
mtext("Simulations", side = 3, cex = 1, line =2, outer = TRUE, at = 0.25)
text(5, 5.7, labels = ("d)"))

# MEAN #
plot(constant.sims.mean.15[ ,1] ~ plot.time, col = "black", type = "n", ylim = c(0, 30), xlim = c(0, 120), 
     xlab = "Time", ylab = "Mean", cex.lab = 1.5)
for(i in 1:1000){
  lines(constant.sims.mean.15[ ,i] ~ plot.time, col = alpha("black", 0.05), lwd = 1)
}
lines(constant.sims.mean.mean ~ plot.time, col = "black", lwd = 3)
mtext("Mean", side = 2, cex = 1, line = 3, outer = FALSE)
text(5, 28.5, labels = ("e)"))

plot(warming.sims.mean.15[ ,1] ~ plot.time, col = "black", type = "n", ylim = c(0, 30), xlim = c(0, 120), 
     xlab = "Time", ylab = NA, cex.lab = 1.5)
for(i in 1:1000){
  lines(warming.sims.mean.15[ ,i] ~ plot.time, col = alpha("black", 0.05), lwd = 1)
}
lines(warming.sims.mean.mean ~ plot.time, col = "black", lwd = 3)
abline(v = 60, lty = 2, col = "orchid", lwd = 2)
text(5, 28.5, labels = ("f)"))

plot(pop1.mean[1:15] ~ time.plot, col = alpha(col.vec[1], 0.6), xaxt = "n", type = "l", ylim = c(0, 1), xlim = c(0, 40), lwd = 1)
lines(pop2.mean[1:15] ~ time.plot, col = alpha(col.vec[2], 0.6), lwd = 1 , ylim = c(0, 4))
lines(pop3.mean[1:15] ~ time.plot, col = alpha(col.vec[3], 0.6), lwd = 1, ylim = c(0, 4))
lines(pop4.mean[1:15] ~ time.plot, col = alpha(col.vec[4], 0.6), lwd = 1, ylim = c(0, 4))
axis(side = 1, at = c(0, 20/3, 40/3, 60/3, 80/3, 100/3, 120/3), labels = c(0, 20, 40, 60, 80, 100, 120))
text(5, 0.95, labels = ("g)"))

plot(pop5.mean[1:15] ~ time.plot, col = alpha(col.vec[1], 0.6), xaxt = "n", lwd = 1, type = "l", ylim = c(0, 1), xlim = c(0, 40))
lines(pop6.mean[1:15] ~ time.plot, col = alpha(col.vec[2], 0.6), lwd = 1, ylim = c(0, 4))
lines(pop7.mean[1:15] ~ time.plot, col = alpha(col.vec[3], 0.6), lwd = 1, ylim = c(0, 4))
lines(pop8.mean[1:15] ~ time.plot, col = alpha(col.vec[4], 0.6), lwd = 1, ylim = c(0, 4))
axis(side = 1, at = c(0, 20/3, 40/3, 60/3, 80/3, 100/3, 120/3), labels = c(0, 20, 40, 60, 80, 100, 120))
abline(v = c(20), col = "orchid", lty = 2, lwd = 2)
text(5, 0.95, labels = ("h)"))

# VARIANCE #
plot(constant.sims.var.15[ ,1] ~ plot.time, col = "black", type = "n", ylim = c(0, 20), xlim = c(0, 120), 
     xlab = "Time", ylab = "Variance", cex.lab = 1.5)
for(i in 1:1000){
  lines(constant.sims.var.15[ ,i] ~ plot.time, col = alpha("black", 0.01), lwd = 1)
}
lines(constant.sims.mean.var ~ plot.time, col = "black", lwd = 3)
mtext("Variance", side = 2, cex = 1, line = 3, outer = FALSE)
text(5, 19, labels = ("i)"))

plot(warming.sims.var.15[ ,1] ~ plot.time, col = "black", type = "n", ylim = c(0, 20), xlim = c(0, 120), 
     xlab = "Time", ylab = NA, cex.lab = 1.5)
for(i in 1:1000){
  lines(warming.sims.var.15[ ,i] ~ plot.time, col = alpha("black", 0.01), lwd = 1)
}
lines(warming.sims.mean.var ~ plot.time, col = "black", lwd = 3)
abline(v = 60, lty = 2, col = "orchid", lwd = 2)
text(5, 19, labels = ("j)"))

plot(pop1.var[1:15] ~ time.plot, col = alpha(col.vec[1], 0.6), xaxt = "n", lwd = 1, type = "l", ylim = c(0, 1.5), xlim = c(0, 40))
lines(pop2.var[1:15] ~ time.plot, col = alpha(col.vec[2], 0.6), lwd = 1, ylim = c(0, 4))
lines(pop3.var[1:15] ~ time.plot, col = alpha(col.vec[3], 0.6), lwd = 1, ylim = c(0, 4))
lines(pop4.var[1:15] ~ time.plot, col = alpha(col.vec[4], 0.6), lwd = 1, ylim = c(0, 4))
axis(side = 1, at = c(0, 20/3, 40/3, 60/3, 80/3, 100/3, 120/3),  labels = c(0, 20, 40, 60, 80, 100, 120))
text(5, 1.425, labels = ("k)"))

plot(pop5.var[1:15] ~ time.plot, col = alpha(col.vec[1], 0.6), xaxt = "n", lwd = 1, type = "l", ylim = c(0, 1.5), xlim = c(0, 40))
lines(pop6.var[1:15] ~ time.plot, col = alpha(col.vec[2], 0.6), lwd = 1, ylim = c(0, 4))
lines(pop7.var[1:15] ~ time.plot, col = alpha(col.vec[3], 0.6), lwd = 1, ylim = c(0, 4))
lines(pop8.var[1:15] ~ time.plot, col = alpha(col.vec[4], 0.6), lwd = 1, ylim = c(0, 4))
axis(side = 1, at = c(0, 20/3, 40/3, 60/3, 80/3, 100/3, 120/3), labels = c(0, 20, 40, 60, 80, 100, 120))
abline(v = c(20), col = "orchid", lty = 2, lwd = 2)
text(5, 1.425, labels = ("l)"))

mtext("Days", side = 1, cex = 1, line = 2, outer = TRUE)

dev.off()
```

# Troubleshooting Missing Outputs

So, if we look at the AUCs, there are missing values that aren't missing when we analyse simulation data, or pre-processes empirical/simulated data.

```{r}
AUC_df <- readRDS("Objects/AUC_EmpiricalData.rds")
AUC_df
```

So, we're missing AUCs for:

1.  Skewness
2.  Kurtosis
3.  Autocorrelation
4.  Decay time

Note: Decay time is dependent on autocorrelation, so if we figure out autocorrelation, we should be good for decay time as well.

## Outputs

Skewness

```{r}
print("Population 1"); pop1.sk
print("Population 2"); pop2.sk
print("Population 3"); pop3.sk
print("Population 4"); pop4.sk
print("Population 5"); pop5.sk
print("Population 6"); pop6.sk
print("Population 7"); pop7.sk
print("Population 8"); pop8.sk
```

Kurtosis

```{r}
print("Population 1"); pop1.kt
print("Population 2"); pop2.kt
print("Population 3"); pop3.kt
print("Population 4"); pop4.kt
print("Population 5"); pop5.kt
print("Population 6"); pop6.kt
print("Population 7"); pop7.kt
print("Population 8"); pop8.kt
```

Autocorrelation

```{r}
print("Population 1"); pop1.ac
print("Population 2"); pop2.ac
print("Population 3"); pop3.ac
print("Population 4"); pop4.ac
print("Population 5"); pop5.ac
print("Population 6"); pop6.ac
print("Population 7"); pop7.ac
print("Population 8"); pop8.ac
```

Decay Time

```{r}
print("Population 1"); pop1.dt
print("Population 2"); pop2.dt
print("Population 3"); pop3.dt
print("Population 4"); pop4.dt
print("Population 5"); pop5.dt
print("Population 6"); pop6.dt
print("Population 7"); pop7.dt
print("Population 8"); pop8.dt
```

The problem is that for each of these metrics, and in each population, we're getting from NaNs. Since we're getting NaNs instead of NAs, we could be dividing by 0 somewhere. Dividing by 0 also makes sense as the issue given that (1) we account for that issue when calculating coefficient of variation, and index of dispersion, and (2) we're not seeing this issue in the pre-processed empirical data, which are real-valued rather than integer-valued.

## (1) Adding `1e-10` to Every Abundance Value:

```{r}
sub1.mod <- sub1$status.sum + 1e-10
sub2.mod <- sub2$status.sum + 1e-10
sub3.mod <- sub3$status.sum + 1e-10
sub4.mod <- sub4$status.sum + 1e-10
sub5.mod <- sub5$status.sum + 1e-10
sub6.mod <- sub6$status.sum + 1e-10
sub7.mod <- sub7$status.sum + 1e-10
sub8.mod <- sub8$status.sum + 1e-10

## Skewness
pop1.sk <- SlidingWindow(FUN = "skewness", data = sub1.mod, window = 5, step = 1)
pop2.sk <- SlidingWindow(FUN = "skewness", data = sub2.mod, window = 5, step = 1)
pop3.sk <- SlidingWindow(FUN = "skewness", data = sub3.mod, window = 5, step = 1)
pop4.sk <- SlidingWindow(FUN = "skewness", data = sub4.mod, window = 5, step = 1)
pop5.sk <- SlidingWindow(FUN = "skewness", data = sub5.mod, window = 5, step = 1)
pop6.sk <- SlidingWindow(FUN = "skewness", data = sub6.mod, window = 5, step = 1)
pop7.sk <- SlidingWindow(FUN = "skewness", data = sub7.mod, window = 5, step = 1)
pop8.sk <- SlidingWindow(FUN = "skewness", data = sub8.mod, window = 5, step = 1)

## Kurtosis
pop1.kt <- SlidingWindow(FUN = "kurtosis", data = sub1.mod, window = 5, step = 1)
pop2.kt <- SlidingWindow(FUN = "kurtosis", data = sub2.mod, window = 5, step = 1)
pop3.kt <- SlidingWindow(FUN = "kurtosis", data = sub3.mod, window = 5, step = 1)
pop4.kt <- SlidingWindow(FUN = "kurtosis", data = sub4.mod, window = 5, step = 1)
pop5.kt <- SlidingWindow(FUN = "kurtosis", data = sub5.mod, window = 5, step = 1)
pop6.kt <- SlidingWindow(FUN = "kurtosis", data = sub6.mod, window = 5, step = 1)
pop7.kt <- SlidingWindow(FUN = "kurtosis", data = sub7.mod, window = 5, step = 1)
pop8.kt <- SlidingWindow(FUN = "kurtosis", data = sub8.mod, window = 5, step = 1)

## Autocorrelation
pop1.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub1.mod[c(window.start:window.end)]
  pop1.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop2.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub2.mod[c(window.start:window.end)]
  pop2.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop3.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub3.mod[c(window.start:window.end)]
  pop3.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop4.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub4.mod[c(window.start:window.end)]
  pop4.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop5.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub5.mod[c(window.start:window.end)]
  pop5.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop6.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub6.mod[c(window.start:window.end)]
  pop6.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop7.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub7.mod[c(window.start:window.end)]
  pop7.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop8.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub8.mod[c(window.start:window.end)]
  pop8.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}

## Decay time
pop1.dt <- c()
pop2.dt <- c()
pop3.dt <- c()
pop4.dt <- c()
pop5.dt <- c()
pop6.dt <- c()
pop7.dt <- c()
pop8.dt <- c()
for(i in 1:35){
  suppressWarnings(pop1.dt[i] <- -i/log(pop1.ac[i]))
  suppressWarnings(pop2.dt[i] <- -i/log(pop2.ac[i]))
  suppressWarnings(pop3.dt[i] <- -i/log(pop3.ac[i]))
  suppressWarnings(pop4.dt[i] <- -i/log(pop4.ac[i]))
  suppressWarnings(pop5.dt[i] <- -i/log(pop5.ac[i]))
  suppressWarnings(pop6.dt[i] <- -i/log(pop6.ac[i]))
  suppressWarnings(pop7.dt[i] <- -i/log(pop7.ac[i]))
  suppressWarnings(pop8.dt[i] <- -i/log(pop8.ac[i]))
}

pop1.sk
pop1.kt
pop1.ac
pop1.dt
```

## (2) Using Detrended Data (Bandwidth = 1)

```{r}
smooth.emp.b1 <- readRDS("Objects/smooth-emp-b1.rds")

sub1.mod <- smooth.emp.b1[ , 1]
sub2.mod <- smooth.emp.b1[ , 2]
sub3.mod <- smooth.emp.b1[ , 3]
sub4.mod <- smooth.emp.b1[ , 4]
sub5.mod <- smooth.emp.b1[ , 5]
sub6.mod <- smooth.emp.b1[ , 6]
sub7.mod <- smooth.emp.b1[ , 7]
sub8.mod <- smooth.emp.b1[ , 8]

## Skewness
pop1.sk <- SlidingWindow(FUN = "skewness", data = sub1.mod, window = 5, step = 1)
pop2.sk <- SlidingWindow(FUN = "skewness", data = sub2.mod, window = 5, step = 1)
pop3.sk <- SlidingWindow(FUN = "skewness", data = sub3.mod, window = 5, step = 1)
pop4.sk <- SlidingWindow(FUN = "skewness", data = sub4.mod, window = 5, step = 1)
pop5.sk <- SlidingWindow(FUN = "skewness", data = sub5.mod, window = 5, step = 1)
pop6.sk <- SlidingWindow(FUN = "skewness", data = sub6.mod, window = 5, step = 1)
pop7.sk <- SlidingWindow(FUN = "skewness", data = sub7.mod, window = 5, step = 1)
pop8.sk <- SlidingWindow(FUN = "skewness", data = sub8.mod, window = 5, step = 1)

## Kurtosis
pop1.kt <- SlidingWindow(FUN = "kurtosis", data = sub1.mod, window = 5, step = 1)
pop2.kt <- SlidingWindow(FUN = "kurtosis", data = sub2.mod, window = 5, step = 1)
pop3.kt <- SlidingWindow(FUN = "kurtosis", data = sub3.mod, window = 5, step = 1)
pop4.kt <- SlidingWindow(FUN = "kurtosis", data = sub4.mod, window = 5, step = 1)
pop5.kt <- SlidingWindow(FUN = "kurtosis", data = sub5.mod, window = 5, step = 1)
pop6.kt <- SlidingWindow(FUN = "kurtosis", data = sub6.mod, window = 5, step = 1)
pop7.kt <- SlidingWindow(FUN = "kurtosis", data = sub7.mod, window = 5, step = 1)
pop8.kt <- SlidingWindow(FUN = "kurtosis", data = sub8.mod, window = 5, step = 1)

## Autocorrelation
pop1.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub1.mod[c(window.start:window.end)]
  pop1.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop2.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub2.mod[c(window.start:window.end)]
  pop2.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop3.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub3.mod[c(window.start:window.end)]
  pop3.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop4.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub4.mod[c(window.start:window.end)]
  pop4.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop5.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub5.mod[c(window.start:window.end)]
  pop5.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop6.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub6.mod[c(window.start:window.end)]
  pop6.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop7.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub7.mod[c(window.start:window.end)]
  pop7.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop8.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub8.mod[c(window.start:window.end)]
  pop8.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}

## Decay time
pop1.dt <- c()
pop2.dt <- c()
pop3.dt <- c()
pop4.dt <- c()
pop5.dt <- c()
pop6.dt <- c()
pop7.dt <- c()
pop8.dt <- c()
for(i in 1:35){
  suppressWarnings(pop1.dt[i] <- -i/log(pop1.ac[i]))
  suppressWarnings(pop2.dt[i] <- -i/log(pop2.ac[i]))
  suppressWarnings(pop3.dt[i] <- -i/log(pop3.ac[i]))
  suppressWarnings(pop4.dt[i] <- -i/log(pop4.ac[i]))
  suppressWarnings(pop5.dt[i] <- -i/log(pop5.ac[i]))
  suppressWarnings(pop6.dt[i] <- -i/log(pop6.ac[i]))
  suppressWarnings(pop7.dt[i] <- -i/log(pop7.ac[i]))
  suppressWarnings(pop8.dt[i] <- -i/log(pop8.ac[i]))
}

pop1.sk
pop1.kt
pop1.ac
pop1.dt
```

Okay, now I think that the problem is that the windows over which skewness, etc. is being calculated, contain adjacent identical values, or, at least, values that are small enough for my computer to mistake for identical values.

## (3) Adding Small, Random Values

Here, I'm making the add-on values smaller, and I'm only adding them to abundance values of 0, rather than to the whole time series.

```{r}
data <- as.matrix(cbind(sub1$status.sum, sub2$status.sum, sub3$status.sum, sub4$status.sum, sub5$status.sum, sub6$status.sum, sub7$status.sum, sub8$status.sum))

set.seed(123)

## Adding to 0s only
add.ons <- runif(length(which(data == 0)), min = 1e-22, max = 1e-21); length(add.ons) == length(unique(add.ons))
data[data %in% 0] <- add.ons
## Adding to all values
# timepts <- nrow(data)*ncol(data)
# add.ons <- runif(timepts, min = 1e-22, max = 1e-21); length(add.ons) == length(unique(add.ons))
# add.ons <- matrix(add.ons, nrow = 40)
# data <- data + add.ons

sub1.mod <- data[ , 1]
sub2.mod <- data[ , 2]
sub3.mod <- data[ , 3]
sub4.mod <- data[ , 4]
sub5.mod <- data[ , 5]
sub6.mod <- data[ , 6]
sub7.mod <- data[ , 7]
sub8.mod <- data[ , 8]

## Skewness
pop1.sk <- SlidingWindow(FUN = "skewness", data = sub1.mod, window = 5, step = 1)
pop2.sk <- SlidingWindow(FUN = "skewness", data = sub2.mod, window = 5, step = 1)
pop3.sk <- SlidingWindow(FUN = "skewness", data = sub3.mod, window = 5, step = 1)
pop4.sk <- SlidingWindow(FUN = "skewness", data = sub4.mod, window = 5, step = 1)
pop5.sk <- SlidingWindow(FUN = "skewness", data = sub5.mod, window = 5, step = 1)
pop6.sk <- SlidingWindow(FUN = "skewness", data = sub6.mod, window = 5, step = 1)
pop7.sk <- SlidingWindow(FUN = "skewness", data = sub7.mod, window = 5, step = 1)
pop8.sk <- SlidingWindow(FUN = "skewness", data = sub8.mod, window = 5, step = 1)

## Kurtosis
pop1.kt <- SlidingWindow(FUN = "kurtosis", data = sub1.mod, window = 5, step = 1)
pop2.kt <- SlidingWindow(FUN = "kurtosis", data = sub2.mod, window = 5, step = 1)
pop3.kt <- SlidingWindow(FUN = "kurtosis", data = sub3.mod, window = 5, step = 1)
pop4.kt <- SlidingWindow(FUN = "kurtosis", data = sub4.mod, window = 5, step = 1)
pop5.kt <- SlidingWindow(FUN = "kurtosis", data = sub5.mod, window = 5, step = 1)
pop6.kt <- SlidingWindow(FUN = "kurtosis", data = sub6.mod, window = 5, step = 1)
pop7.kt <- SlidingWindow(FUN = "kurtosis", data = sub7.mod, window = 5, step = 1)
pop8.kt <- SlidingWindow(FUN = "kurtosis", data = sub8.mod, window = 5, step = 1)

## Autocorrelation
pop1.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub1.mod[c(window.start:window.end)]
  pop1.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop2.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub2.mod[c(window.start:window.end)]
  pop2.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop3.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub3.mod[c(window.start:window.end)]
  pop3.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop4.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub4.mod[c(window.start:window.end)]
  pop4.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop5.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub5.mod[c(window.start:window.end)]
  pop5.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop6.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub6.mod[c(window.start:window.end)]
  pop6.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop7.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub7.mod[c(window.start:window.end)]
  pop7.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}
pop8.ac <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub8.mod[c(window.start:window.end)]
  pop8.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
}

## Decay time
pop1.dt <- c()
pop2.dt <- c()
pop3.dt <- c()
pop4.dt <- c()
pop5.dt <- c()
pop6.dt <- c()
pop7.dt <- c()
pop8.dt <- c()
for(i in 1:35){
  suppressWarnings(pop1.dt[i] <- -i/log(pop1.ac[i]))
  suppressWarnings(pop2.dt[i] <- -i/log(pop2.ac[i]))
  suppressWarnings(pop3.dt[i] <- -i/log(pop3.ac[i]))
  suppressWarnings(pop4.dt[i] <- -i/log(pop4.ac[i]))
  suppressWarnings(pop5.dt[i] <- -i/log(pop5.ac[i]))
  suppressWarnings(pop6.dt[i] <- -i/log(pop6.ac[i]))
  suppressWarnings(pop7.dt[i] <- -i/log(pop7.ac[i]))
  suppressWarnings(pop8.dt[i] <- -i/log(pop8.ac[i]))
}

time.15 <- seq(1, 15, 1)

## Skewness
constant.sk.tau<- c(cor(pop1.sk[1:15], time.15, method = "kendall"), cor(pop2.sk[1:15], time.15, method = "kendall"),
                          cor(pop3.sk[1:15], time.15, method = "kendall"), cor(pop4.sk[1:15], time.15, method = "kendall"))
warming.sk.tau <- c(cor(pop5.sk[1:15], time.15, method = "kendall"), cor(pop6.sk[1:15], time.15, method = "kendall"),
                          cor(pop7.sk[1:15], time.15, method = "kendall"), cor(pop8.sk[1:15], time.15, method = "kendall"))

## Kurtosis
constant.kt.tau<- c(cor(pop1.kt[1:15], time.15, method = "kendall"), cor(pop2.kt[1:15], time.15, method = "kendall"),
                          cor(pop3.kt[1:15], time.15, method = "kendall"), cor(pop4.kt[1:15], time.15, method = "kendall"))
warming.kt.tau <- c(cor(pop5.kt[1:15], time.15, method = "kendall"), cor(pop6.kt[1:15], time.15, method = "kendall"),
                          cor(pop7.kt[1:15], time.15, method = "kendall"), cor(pop8.kt[1:15], time.15, method = "kendall"))

## Autocorrelation
constant.ac.tau<- c(cor(pop1.ac[1:15], time.15, method = "kendall"), cor(pop2.ac[1:15], time.15, method = "kendall"),
                    cor(pop3.ac[1:15], time.15, method = "kendall"), cor(pop4.ac[1:15], time.15, method = "kendall"))
warming.ac.tau <- c(cor(pop5.ac[1:15], time.15, method = "kendall"), cor(pop6.ac[1:15], time.15, method = "kendall"),
                    cor(pop7.ac[1:15], time.15, method = "kendall"), cor(pop8.ac[1:15], time.15, method = "kendall"))

## Decay time
constant.dt.tau<- c(cor(pop1.dt[1:15], time.15, method = "kendall"), cor(pop2.dt[1:15], time.15, method = "kendall"),
                            cor(pop3.dt[1:15], time.15, method = "kendall"), cor(pop4.dt[1:15], time.15, method = "kendall"))
warming.dt.tau <- c(cor(pop5.dt[1:15], time.15, method = "kendall"), cor(pop6.dt[1:15], time.15, method = "kendall"),
                            cor(pop7.dt[1:15], time.15, method = "kendall"), cor(pop8.dt[1:15], time.15, method = "kendall"))

AUC_sk_data <- calc_auc(warming.sk.tau, constant.sk.tau); AUC_sk_data
AUC_kt_data <- calc_auc(warming.kt.tau, constant.kt.tau); AUC_kt_data
AUC_ac_data <- calc_auc(warming.ac.tau, constant.ac.tau); AUC_ac_data
AUC_dt_data <- calc_auc(warming.dt.tau, constant.dt.tau); AUC_dt_data
```

### Results of Sensitivity Analysis #1

|                     | Random values between 1e-12 and 1e-8 added to all abundances | Random values between 1e-12 and 1e-11 added to all 0s | Random values between 1e-16 and 1e-15 added to all 0s | Random values between 1e-18 and 1e-17 added to all 0s | Random values between 1e-20 and 1e-19 added to all 0s | Random values between 1e-22 and 1e-21 added to all 0s |
|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
| **Skewness**        | 0.0625                                                       | 0.375                                                 | 0.3125                                                | 0.1875                                                | 0.1875                                                | 0.1875                                                |
| **Kurtosis**        | 0.3125                                                       | 0.28125                                               | 0.25                                                  | 0.25                                                  | 0.25                                                  | 0.25                                                  |
| **Autocorrelation** | 0.875                                                        | 0.96875                                               | 0.90625                                               | 0.875                                                 | 0.875                                                 | 0.875                                                 |
| **Decay Time**      | NA                                                           | NA                                                    | NA                                                    | NA                                                    | NA                                                    | NA                                                    |

Hmm, interesting that these AUCs are so different from the previously calculated AUCs. Looks like tiny changes in data result in large differences in AUC. We should make the added values as small as possible.

### Summarizing and Plotting

```{r}
metrics_full <- c("Mean", "Skewness", "Kurtosis", "Variance", "Covariance", "Index of Dispersion", "First Difference Variance", "Autocorrelation", "Autocovariance", "Decay Time")

AUC_data <- c(AUC_mean_data, 
              AUC_sk_data, 
              AUC_kt_data, 
              AUC_var_data,
              AUC_cv_data,
              AUC_id_data, 
              AUC_fdv_data, 
              AUC_ac_data, 
              AUC_acv_data, 
              AUC_dt_data)

cols <- c("orchid", rep("black", 2), rep("orchid", 4), "black", "orchid", "black")
pts <- c(19, rep(8, 2), rep(19, 4), 8, 19, 8)
plot(1:10, AUC_data, type = "p", 
     main = "Empirical Data, All Populations", xaxt = "none", xlab = "", ylim = c(0, 1), ylab = "AUC",
     col = cols, pch = pts)
abline(h = 0.5, lty = 3)
axis(side = 1, at = 1:10, labels = metrics_full, las = 2)
```

### Sensitivity Analysis #2

Okay, we're going to (1) add small, random values to all 0s, and (2) re-calculate all AUCs. We're going to do this a few times, with different sets of small, random values to see if different small, random values, change the outcome.

-   Okay, I tried this, and I think choosing random values within an order of magnitude gives different outputs because we're using a sliding window, so relative (within-window) differences matter more than "global" differences. So, what I've done is choose one random value, and generated a second by adding a small value to the first value. I then added those values, in alternating order, to all 0s.

```{r}
data <- as.matrix(cbind(sub1$status.sum, sub2$status.sum, sub3$status.sum, sub4$status.sum, sub5$status.sum, sub6$status.sum, sub7$status.sum, sub8$status.sum))

nums.needed <- length(which(data == 0))
data.list <- c()
for (i in 1:5){
  set.seed(i)
  add.ons <- runif(1, min = 1e-28, max = 1.5e-28); add.ons <- c(add.ons, add.ons + 1e-30)
  add.ons <- c(rep(add.ons, nums.needed/2), add.ons[1])
  data[data %in% 0] <- add.ons
  data.list[[i]] <- data
  data <- as.matrix(cbind(sub1$status.sum, sub2$status.sum, sub3$status.sum, sub4$status.sum, sub5$status.sum, sub6$status.sum, sub7$status.sum, sub8$status.sum))
}

sub1.mod.1 <- data.list[[1]][ , 1]; sub2.mod.1 <- data.list[[1]][ , 2]; sub3.mod.1 <- data.list[[1]][ , 3]; sub4.mod.1 <- data.list[[1]][ , 4]
sub5.mod.1 <- data.list[[1]][ , 5]; sub6.mod.1 <- data.list[[1]][ , 6]; sub7.mod.1 <- data.list[[1]][ , 7]; sub8.mod.1 <- data.list[[1]][ , 8]
sub1.mod.2 <- data.list[[2]][ , 1]; sub2.mod.2 <- data.list[[2]][ , 2]; sub3.mod.2 <- data.list[[2]][ , 3]; sub4.mod.2 <- data.list[[2]][ , 4]
sub5.mod.2 <- data.list[[2]][ , 5]; sub6.mod.2 <- data.list[[2]][ , 6]; sub7.mod.2 <- data.list[[2]][ , 7]; sub8.mod.2 <- data.list[[2]][ , 8]
sub1.mod.3 <- data.list[[3]][ , 1]; sub2.mod.3 <- data.list[[3]][ , 2]; sub3.mod.3 <- data.list[[3]][ , 3]; sub4.mod.3 <- data.list[[3]][ , 4]
sub5.mod.3 <- data.list[[3]][ , 5]; sub6.mod.3 <- data.list[[3]][ , 6]; sub7.mod.3 <- data.list[[3]][ , 7]; sub8.mod.3 <- data.list[[3]][ , 8]
sub1.mod.4 <- data.list[[4]][ , 1]; sub2.mod.4 <- data.list[[4]][ , 2]; sub3.mod.4 <- data.list[[4]][ , 3]; sub4.mod.4 <- data.list[[4]][ , 4]
sub5.mod.4 <- data.list[[4]][ , 5]; sub6.mod.4 <- data.list[[4]][ , 6]; sub7.mod.4 <- data.list[[4]][ , 7]; sub8.mod.4 <- data.list[[4]][ , 8]
sub1.mod.5 <- data.list[[5]][ , 1]; sub2.mod.5 <- data.list[[5]][ , 2]; sub3.mod.5 <- data.list[[5]][ , 3]; sub4.mod.5 <- data.list[[5]][ , 4]
sub5.mod.5 <- data.list[[5]][ , 5]; sub6.mod.5 <- data.list[[5]][ , 6]; sub7.mod.5 <- data.list[[5]][ , 7]; sub8.mod.5 <- data.list[[5]][ , 8]
```

#### (1)

```{r}
## Standard deviation
pop1.sd <- SlidingWindow(FUN = "sd", data = sub1.mod.1, window = 5, step = 1)
pop2.sd <- SlidingWindow(FUN = "sd", data = sub2.mod.1, window = 5, step = 1)
pop3.sd <- SlidingWindow(FUN = "sd", data = sub3.mod.1, window = 5, step = 1)
pop4.sd <- SlidingWindow(FUN = "sd", data = sub4.mod.1, window = 5, step = 1)
pop5.sd <- SlidingWindow(FUN = "sd", data = sub5.mod.1, window = 5, step = 1)
pop6.sd <- SlidingWindow(FUN = "sd", data = sub6.mod.1, window = 5, step = 1)
pop7.sd <- SlidingWindow(FUN = "sd", data = sub7.mod.1, window = 5, step = 1)
pop8.sd <- SlidingWindow(FUN = "sd", data = sub8.mod.1, window = 5, step = 1)
## Mean
pop1.mean <- SlidingWindow(FUN = "mean", data = sub1.mod.1, window = 5, step = 1)
pop2.mean <- SlidingWindow(FUN = "mean", data = sub2.mod.1, window = 5, step = 1)
pop3.mean <- SlidingWindow(FUN = "mean", data = sub3.mod.1, window = 5, step = 1)
pop4.mean <- SlidingWindow(FUN = "mean", data = sub4.mod.1, window = 5, step = 1)
pop5.mean <- SlidingWindow(FUN = "mean", data = sub5.mod.1, window = 5, step = 1)
pop6.mean <- SlidingWindow(FUN = "mean", data = sub6.mod.1, window = 5, step = 1)
pop7.mean <- SlidingWindow(FUN = "mean", data = sub7.mod.1, window = 5, step = 1)
pop8.mean <- SlidingWindow(FUN = "mean", data = sub8.mod.1, window = 5, step = 1)
## Skewness
pop1.sk <- SlidingWindow(FUN = "skewness", data = sub1.mod.1, window = 5, step = 1)
pop2.sk <- SlidingWindow(FUN = "skewness", data = sub2.mod.1, window = 5, step = 1)
pop3.sk <- SlidingWindow(FUN = "skewness", data = sub3.mod.1, window = 5, step = 1)
pop4.sk <- SlidingWindow(FUN = "skewness", data = sub4.mod.1, window = 5, step = 1)
pop5.sk <- SlidingWindow(FUN = "skewness", data = sub5.mod.1, window = 5, step = 1)
pop6.sk <- SlidingWindow(FUN = "skewness", data = sub6.mod.1, window = 5, step = 1)
pop7.sk <- SlidingWindow(FUN = "skewness", data = sub7.mod.1, window = 5, step = 1)
pop8.sk <- SlidingWindow(FUN = "skewness", data = sub8.mod.1, window = 5, step = 1)
## Kurtosis
pop1.kt <- SlidingWindow(FUN = "kurtosis", data = sub1.mod.1, window = 5, step = 1)
pop2.kt <- SlidingWindow(FUN = "kurtosis", data = sub2.mod.1, window = 5, step = 1)
pop3.kt <- SlidingWindow(FUN = "kurtosis", data = sub3.mod.1, window = 5, step = 1)
pop4.kt <- SlidingWindow(FUN = "kurtosis", data = sub4.mod.1, window = 5, step = 1)
pop5.kt <- SlidingWindow(FUN = "kurtosis", data = sub5.mod.1, window = 5, step = 1)
pop6.kt <- SlidingWindow(FUN = "kurtosis", data = sub6.mod.1, window = 5, step = 1)
pop7.kt <- SlidingWindow(FUN = "kurtosis", data = sub7.mod.1, window = 5, step = 1)
pop8.kt <- SlidingWindow(FUN = "kurtosis", data = sub8.mod.1, window = 5, step = 1)
## Variation
pop1.var <- pop1.sd^2
pop2.var <- pop2.sd^2
pop3.var <- pop3.sd^2
pop4.var <- pop4.sd^2
pop5.var <- pop5.sd^2
pop6.var <- pop6.sd^2
pop7.var <- pop7.sd^2
pop8.var <- pop8.sd^2
## Coefficient of Variation
pop1.cv <- pop1.sd/(pop1.mean)
pop2.cv <- pop2.sd/(pop2.mean)
pop3.cv <- pop3.sd/(pop3.mean)
pop4.cv <- pop4.sd/(pop4.mean)
pop5.cv <- pop5.sd/(pop5.mean)
pop6.cv <- pop6.sd/(pop6.mean)
pop7.cv <- pop7.sd/(pop7.mean)
pop8.cv <- pop8.sd/(pop8.mean)
## Index of Dispersion
pop1.id <- pop1.var/(pop1.mean)
pop2.id <- pop2.var/(pop2.mean)
pop3.id <- pop3.var/(pop3.mean)
pop4.id <- pop4.var/(pop4.mean)
pop5.id <- pop5.var/(pop5.mean)
pop6.id <- pop6.var/(pop6.mean)
pop7.id <- pop7.var/(pop7.mean)
pop8.id <- pop8.var/(pop8.mean)
## First Difference Variance
pop1.fdv <- c()
pop2.fdv <- c()
pop3.fdv <- c()
pop4.fdv <- c()
pop5.fdv <- c()
pop6.fdv <- c()
pop7.fdv <- c()
pop8.fdv <- c()
for(i in 2:35){
pop1.fdv[i - 1] <- pop1.var[i] - pop1.var[i - 1]
pop2.fdv[i - 1] <- pop2.var[i] - pop2.var[i - 1]
pop3.fdv[i - 1] <- pop3.var[i] - pop3.var[i - 1]
pop4.fdv[i - 1] <- pop4.var[i] - pop4.var[i - 1]
pop5.fdv[i - 1] <- pop5.var[i] - pop5.var[i - 1]
pop6.fdv[i - 1] <- pop6.var[i] - pop6.var[i - 1]
pop7.fdv[i - 1] <- pop7.var[i] - pop7.var[i - 1]
pop8.fdv[i - 1] <- pop8.var[i] - pop8.var[i - 1]
}
## Autocorrelation and Autocovariance
## Autocorrelation
pop1.ac <- c()
pop1.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub1.mod.1[c(window.start:window.end)]
  pop1.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop1.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop2.ac <- c()
pop2.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub2.mod.1[c(window.start:window.end)]
  pop2.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop2.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop3.ac <- c()
pop3.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub3.mod.1[c(window.start:window.end)]
  pop3.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop3.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop4.ac <- c()
pop4.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub4.mod.1[c(window.start:window.end)]
  pop4.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop4.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop5.ac <- c()
pop5.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub5.mod.1[c(window.start:window.end)]
  pop5.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop5.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop6.ac <- c()
pop6.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub6.mod.1[c(window.start:window.end)]
  pop6.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop6.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop7.ac <- c()
pop7.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub7.mod.1[c(window.start:window.end)]
  pop7.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop7.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop8.ac <- c()
pop8.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub8.mod.1[c(window.start:window.end)]
  pop8.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop8.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
time.15 <- seq(1, 15, 1)
constant.mean.tau<- c(cor(pop1.mean[1:15], time.15, method = "kendall"), cor(pop2.mean[1:15], time.15, method = "kendall"),
                      cor(pop3.mean[1:15], time.15, method = "kendall"), cor(pop4.mean[1:15], time.15, method = "kendall"))
warming.mean.tau <- c(cor(pop5.mean[1:15], time.15, method = "kendall"), cor(pop6.mean[1:15], time.15, method = "kendall"),
                      cor(pop7.mean[1:15], time.15, method = "kendall"), cor(pop8.mean[1:15], time.15, method = "kendall"))
constant.sk.tau <- c(cor(pop1.sk[1:15], time.15, method = "kendall"), cor(pop2.sk[1:15], time.15, method = "kendall"),
                          cor(pop3.sk[1:15], time.15, method = "kendall"), cor(pop4.sk[1:15], time.15, method = "kendall"))
warming.sk.tau <- c(cor(pop5.sk[1:15], time.15, method = "kendall"), cor(pop6.sk[1:15], time.15, method = "kendall"),
                          cor(pop7.sk[1:15], time.15, method = "kendall"), cor(pop8.sk[1:15], time.15, method = "kendall"))
constant.kt.tau<- c(cor(pop1.kt[1:15], time.15, method = "kendall"), cor(pop2.kt[1:15], time.15, method = "kendall"),
                          cor(pop3.kt[1:15], time.15, method = "kendall"), cor(pop4.kt[1:15], time.15, method = "kendall"))
warming.kt.tau <- c(cor(pop5.kt[1:15], time.15, method = "kendall"), cor(pop6.kt[1:15], time.15, method = "kendall"),
                          cor(pop7.kt[1:15], time.15, method = "kendall"), cor(pop8.kt[1:15], time.15, method = "kendall"))
constant.var.tau<- c(cor(pop1.var[1:15], time.15, method = "kendall"), cor(pop2.var[1:15], time.15, method = "kendall"),
                          cor(pop3.var[1:15], time.15, method = "kendall"), cor(pop4.var[1:15], time.15, method = "kendall"))
warming.var.tau<- c(cor(pop5.var[1:15], time.15, method = "kendall"), cor(pop6.var[1:15], time.15, method = "kendall"),
                         cor(pop7.var[1:15], time.15, method = "kendall"), cor(pop8.var[1:15], time.15, method = "kendall"))
constant.cv.tau<- c(cor(pop1.cv[1:15], time.15, method = "kendall"), cor(pop2.cv[1:15], time.15, method = "kendall"),
                    cor(pop3.cv[1:15], time.15, method = "kendall"), cor(pop4.cv[1:15], time.15, method = "kendall"))
warming.cv.tau <- c(cor(pop5.cv[1:15], time.15, method = "kendall"), cor(pop6.cv[1:15], time.15, method = "kendall"),
                    cor(pop7.cv[1:15], time.15, method = "kendall"), cor(pop8.cv[1:15], time.15, method = "kendall"))
constant.id.tau <- c(cor(pop1.id[1:15], time.15, method = "kendall"), cor(pop2.id[1:15], time.15, method = "kendall"),
                    cor(pop3.id[1:15], time.15, method = "kendall"), cor(pop4.id[1:15], time.15, method = "kendall"))
warming.id.tau <- c(cor(pop5.id[1:15], time.15, method = "kendall"), cor(pop6.id[1:15], time.15, method = "kendall"),
                    cor(pop7.id[1:15], time.15, method = "kendall"), cor(pop8.id[1:15], time.15, method = "kendall"))
constant.fdv.tau <- c(cor(pop1.fdv[1:15], time.15, method = "kendall"), cor(pop2.fdv[1:15], time.15, method = "kendall"),
                                     cor(pop3.fdv[1:15], time.15, method = "kendall"), cor(pop4.fdv[1:15], time.15, method = "kendall"))
warming.fdv.tau <- c(cor(pop5.fdv[1:15], time.15, method = "kendall"), cor(pop6.fdv[1:15], time.15, method = "kendall"),
                                     cor(pop7.fdv[1:15], time.15, method = "kendall"), cor(pop8.fdv[1:15], time.15, method = "kendall"))
constant.ac.tau <- c(cor(pop1.ac[1:15], time.15, method = "kendall"), cor(pop2.ac[1:15], time.15, method = "kendall"),
                    cor(pop3.ac[1:15], time.15, method = "kendall"), cor(pop4.ac[1:15], time.15, method = "kendall"))
warming.ac.tau <- c(cor(pop5.ac[1:15], time.15, method = "kendall"), cor(pop6.ac[1:15], time.15, method = "kendall"),
                    cor(pop7.ac[1:15], time.15, method = "kendall"), cor(pop8.ac[1:15], time.15, method = "kendall"))
constant.acv.tau <- c(cor(pop1.acv[1:15], time.15, method = "kendall"), cor(pop2.acv[1:15], time.15, method = "kendall"),
                     cor(pop3.acv[1:15], time.15, method = "kendall"), cor(pop4.acv[1:15], time.15, method = "kendall"))
warming.acv.tau <- c(cor(pop5.acv[1:15], time.15, method = "kendall"), cor(pop6.acv[1:15], time.15, method = "kendall"),
                     cor(pop7.acv[1:15], time.15, method = "kendall"), cor(pop8.acv[1:15], time.15, method = "kendall"))
AUC_mean_data <- calc_auc(warming.mean.tau, constant.mean.tau); AUC_mean_data
AUC_sk_data <- calc_auc(warming.sk.tau, constant.sk.tau); AUC_sk_data
AUC_kt_data <- calc_auc(warming.kt.tau, constant.kt.tau); AUC_kt_data
AUC_var_data <- calc_auc(warming.var.tau, constant.var.tau); AUC_var_data
AUC_cv_data <- calc_auc(warming.cv.tau, constant.cv.tau); AUC_cv_data
AUC_id_data <- calc_auc(warming.id.tau, constant.id.tau); AUC_id_data
AUC_fdv_data <- calc_auc(warming.fdv.tau, constant.fdv.tau); AUC_fdv_data
AUC_ac_data <- calc_auc(warming.ac.tau, constant.ac.tau); AUC_ac_data
AUC_acv_data <- calc_auc(warming.acv.tau, constant.acv.tau); AUC_acv_data
AUC_data <- c(AUC_mean_data, 
              AUC_sk_data, 
              AUC_kt_data, 
              AUC_var_data,
              AUC_cv_data,
              AUC_id_data, 
              AUC_fdv_data, 
              AUC_ac_data, 
              AUC_acv_data, 
              NA)
AUC_AdjEmp_1 <- data.frame(metrics, AUC_data)
```

#### (2)

```{r}
## Standard deviation
pop1.sd <- SlidingWindow(FUN = "sd", data = sub1.mod.2, window = 5, step = 1)
pop2.sd <- SlidingWindow(FUN = "sd", data = sub2.mod.2, window = 5, step = 1)
pop3.sd <- SlidingWindow(FUN = "sd", data = sub3.mod.2, window = 5, step = 1)
pop4.sd <- SlidingWindow(FUN = "sd", data = sub4.mod.2, window = 5, step = 1)
pop5.sd <- SlidingWindow(FUN = "sd", data = sub5.mod.2, window = 5, step = 1)
pop6.sd <- SlidingWindow(FUN = "sd", data = sub6.mod.2, window = 5, step = 1)
pop7.sd <- SlidingWindow(FUN = "sd", data = sub7.mod.2, window = 5, step = 1)
pop8.sd <- SlidingWindow(FUN = "sd", data = sub8.mod.2, window = 5, step = 1)
## Mean
pop1.mean <- SlidingWindow(FUN = "mean", data = sub1.mod.2, window = 5, step = 1)
pop2.mean <- SlidingWindow(FUN = "mean", data = sub2.mod.2, window = 5, step = 1)
pop3.mean <- SlidingWindow(FUN = "mean", data = sub3.mod.2, window = 5, step = 1)
pop4.mean <- SlidingWindow(FUN = "mean", data = sub4.mod.2, window = 5, step = 1)
pop5.mean <- SlidingWindow(FUN = "mean", data = sub5.mod.2, window = 5, step = 1)
pop6.mean <- SlidingWindow(FUN = "mean", data = sub6.mod.2, window = 5, step = 1)
pop7.mean <- SlidingWindow(FUN = "mean", data = sub7.mod.2, window = 5, step = 1)
pop8.mean <- SlidingWindow(FUN = "mean", data = sub8.mod.2, window = 5, step = 1)
## Skewness
pop1.sk <- SlidingWindow(FUN = "skewness", data = sub1.mod.2, window = 5, step = 1)
pop2.sk <- SlidingWindow(FUN = "skewness", data = sub2.mod.2, window = 5, step = 1)
pop3.sk <- SlidingWindow(FUN = "skewness", data = sub3.mod.2, window = 5, step = 1)
pop4.sk <- SlidingWindow(FUN = "skewness", data = sub4.mod.2, window = 5, step = 1)
pop5.sk <- SlidingWindow(FUN = "skewness", data = sub5.mod.2, window = 5, step = 1)
pop6.sk <- SlidingWindow(FUN = "skewness", data = sub6.mod.2, window = 5, step = 1)
pop7.sk <- SlidingWindow(FUN = "skewness", data = sub7.mod.2, window = 5, step = 1)
pop8.sk <- SlidingWindow(FUN = "skewness", data = sub8.mod.2, window = 5, step = 1)
## Kurtosis
pop1.kt <- SlidingWindow(FUN = "kurtosis", data = sub1.mod.2, window = 5, step = 1)
pop2.kt <- SlidingWindow(FUN = "kurtosis", data = sub2.mod.2, window = 5, step = 1)
pop3.kt <- SlidingWindow(FUN = "kurtosis", data = sub3.mod.2, window = 5, step = 1)
pop4.kt <- SlidingWindow(FUN = "kurtosis", data = sub4.mod.2, window = 5, step = 1)
pop5.kt <- SlidingWindow(FUN = "kurtosis", data = sub5.mod.2, window = 5, step = 1)
pop6.kt <- SlidingWindow(FUN = "kurtosis", data = sub6.mod.2, window = 5, step = 1)
pop7.kt <- SlidingWindow(FUN = "kurtosis", data = sub7.mod.2, window = 5, step = 1)
pop8.kt <- SlidingWindow(FUN = "kurtosis", data = sub8.mod.2, window = 5, step = 1)
## Variation
pop1.var <- pop1.sd^2
pop2.var <- pop2.sd^2
pop3.var <- pop3.sd^2
pop4.var <- pop4.sd^2
pop5.var <- pop5.sd^2
pop6.var <- pop6.sd^2
pop7.var <- pop7.sd^2
pop8.var <- pop8.sd^2
## Coefficient of Variation
pop1.cv <- pop1.sd/(pop1.mean)
pop2.cv <- pop2.sd/(pop2.mean)
pop3.cv <- pop3.sd/(pop3.mean)
pop4.cv <- pop4.sd/(pop4.mean)
pop5.cv <- pop5.sd/(pop5.mean)
pop6.cv <- pop6.sd/(pop6.mean)
pop7.cv <- pop7.sd/(pop7.mean)
pop8.cv <- pop8.sd/(pop8.mean)
## Index of Dispersion
pop1.id <- pop1.var/(pop1.mean)
pop2.id <- pop2.var/(pop2.mean)
pop3.id <- pop3.var/(pop3.mean)
pop4.id <- pop4.var/(pop4.mean)
pop5.id <- pop5.var/(pop5.mean)
pop6.id <- pop6.var/(pop6.mean)
pop7.id <- pop7.var/(pop7.mean)
pop8.id <- pop8.var/(pop8.mean)
## First Difference Variance
pop1.fdv <- c()
pop2.fdv <- c()
pop3.fdv <- c()
pop4.fdv <- c()
pop5.fdv <- c()
pop6.fdv <- c()
pop7.fdv <- c()
pop8.fdv <- c()
for(i in 2:35){
pop1.fdv[i - 1] <- pop1.var[i] - pop1.var[i - 1]
pop2.fdv[i - 1] <- pop2.var[i] - pop2.var[i - 1]
pop3.fdv[i - 1] <- pop3.var[i] - pop3.var[i - 1]
pop4.fdv[i - 1] <- pop4.var[i] - pop4.var[i - 1]
pop5.fdv[i - 1] <- pop5.var[i] - pop5.var[i - 1]
pop6.fdv[i - 1] <- pop6.var[i] - pop6.var[i - 1]
pop7.fdv[i - 1] <- pop7.var[i] - pop7.var[i - 1]
pop8.fdv[i - 1] <- pop8.var[i] - pop8.var[i - 1]
}
## Autocorrelation and Autocovariance
## Autocorrelation
pop1.ac <- c()
pop1.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub1.mod.2[c(window.start:window.end)]
  pop1.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop1.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop2.ac <- c()
pop2.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub2.mod.2[c(window.start:window.end)]
  pop2.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop2.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop3.ac <- c()
pop3.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub3.mod.2[c(window.start:window.end)]
  pop3.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop3.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop4.ac <- c()
pop4.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub4.mod.2[c(window.start:window.end)]
  pop4.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop4.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop5.ac <- c()
pop5.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub5.mod.2[c(window.start:window.end)]
  pop5.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop5.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop6.ac <- c()
pop6.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub6.mod.2[c(window.start:window.end)]
  pop6.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop6.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop7.ac <- c()
pop7.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub7.mod.2[c(window.start:window.end)]
  pop7.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop7.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop8.ac <- c()
pop8.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub8.mod.2[c(window.start:window.end)]
  pop8.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop8.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
time.15 <- seq(1, 15, 1)
constant.mean.tau<- c(cor(pop1.mean[1:15], time.15, method = "kendall"), cor(pop2.mean[1:15], time.15, method = "kendall"),
                      cor(pop3.mean[1:15], time.15, method = "kendall"), cor(pop4.mean[1:15], time.15, method = "kendall"))
warming.mean.tau <- c(cor(pop5.mean[1:15], time.15, method = "kendall"), cor(pop6.mean[1:15], time.15, method = "kendall"),
                      cor(pop7.mean[1:15], time.15, method = "kendall"), cor(pop8.mean[1:15], time.15, method = "kendall"))
constant.sk.tau <- c(cor(pop1.sk[1:15], time.15, method = "kendall"), cor(pop2.sk[1:15], time.15, method = "kendall"),
                          cor(pop3.sk[1:15], time.15, method = "kendall"), cor(pop4.sk[1:15], time.15, method = "kendall"))
warming.sk.tau <- c(cor(pop5.sk[1:15], time.15, method = "kendall"), cor(pop6.sk[1:15], time.15, method = "kendall"),
                          cor(pop7.sk[1:15], time.15, method = "kendall"), cor(pop8.sk[1:15], time.15, method = "kendall"))
constant.kt.tau<- c(cor(pop1.kt[1:15], time.15, method = "kendall"), cor(pop2.kt[1:15], time.15, method = "kendall"),
                          cor(pop3.kt[1:15], time.15, method = "kendall"), cor(pop4.kt[1:15], time.15, method = "kendall"))
warming.kt.tau <- c(cor(pop5.kt[1:15], time.15, method = "kendall"), cor(pop6.kt[1:15], time.15, method = "kendall"),
                          cor(pop7.kt[1:15], time.15, method = "kendall"), cor(pop8.kt[1:15], time.15, method = "kendall"))
constant.var.tau<- c(cor(pop1.var[1:15], time.15, method = "kendall"), cor(pop2.var[1:15], time.15, method = "kendall"),
                          cor(pop3.var[1:15], time.15, method = "kendall"), cor(pop4.var[1:15], time.15, method = "kendall"))
warming.var.tau<- c(cor(pop5.var[1:15], time.15, method = "kendall"), cor(pop6.var[1:15], time.15, method = "kendall"),
                         cor(pop7.var[1:15], time.15, method = "kendall"), cor(pop8.var[1:15], time.15, method = "kendall"))
constant.cv.tau<- c(cor(pop1.cv[1:15], time.15, method = "kendall"), cor(pop2.cv[1:15], time.15, method = "kendall"),
                    cor(pop3.cv[1:15], time.15, method = "kendall"), cor(pop4.cv[1:15], time.15, method = "kendall"))
warming.cv.tau <- c(cor(pop5.cv[1:15], time.15, method = "kendall"), cor(pop6.cv[1:15], time.15, method = "kendall"),
                    cor(pop7.cv[1:15], time.15, method = "kendall"), cor(pop8.cv[1:15], time.15, method = "kendall"))
constant.id.tau <- c(cor(pop1.id[1:15], time.15, method = "kendall"), cor(pop2.id[1:15], time.15, method = "kendall"),
                    cor(pop3.id[1:15], time.15, method = "kendall"), cor(pop4.id[1:15], time.15, method = "kendall"))
warming.id.tau <- c(cor(pop5.id[1:15], time.15, method = "kendall"), cor(pop6.id[1:15], time.15, method = "kendall"),
                    cor(pop7.id[1:15], time.15, method = "kendall"), cor(pop8.id[1:15], time.15, method = "kendall"))
constant.fdv.tau <- c(cor(pop1.fdv[1:15], time.15, method = "kendall"), cor(pop2.fdv[1:15], time.15, method = "kendall"),
                                     cor(pop3.fdv[1:15], time.15, method = "kendall"), cor(pop4.fdv[1:15], time.15, method = "kendall"))
warming.fdv.tau <- c(cor(pop5.fdv[1:15], time.15, method = "kendall"), cor(pop6.fdv[1:15], time.15, method = "kendall"),
                                     cor(pop7.fdv[1:15], time.15, method = "kendall"), cor(pop8.fdv[1:15], time.15, method = "kendall"))
constant.ac.tau <- c(cor(pop1.ac[1:15], time.15, method = "kendall"), cor(pop2.ac[1:15], time.15, method = "kendall"),
                    cor(pop3.ac[1:15], time.15, method = "kendall"), cor(pop4.ac[1:15], time.15, method = "kendall"))
warming.ac.tau <- c(cor(pop5.ac[1:15], time.15, method = "kendall"), cor(pop6.ac[1:15], time.15, method = "kendall"),
                    cor(pop7.ac[1:15], time.15, method = "kendall"), cor(pop8.ac[1:15], time.15, method = "kendall"))
constant.acv.tau <- c(cor(pop1.acv[1:15], time.15, method = "kendall"), cor(pop2.acv[1:15], time.15, method = "kendall"),
                     cor(pop3.acv[1:15], time.15, method = "kendall"), cor(pop4.acv[1:15], time.15, method = "kendall"))
warming.acv.tau <- c(cor(pop5.acv[1:15], time.15, method = "kendall"), cor(pop6.acv[1:15], time.15, method = "kendall"),
                     cor(pop7.acv[1:15], time.15, method = "kendall"), cor(pop8.acv[1:15], time.15, method = "kendall"))
AUC_mean_data <- calc_auc(warming.mean.tau, constant.mean.tau); AUC_mean_data
AUC_sk_data <- calc_auc(warming.sk.tau, constant.sk.tau); AUC_sk_data
AUC_kt_data <- calc_auc(warming.kt.tau, constant.kt.tau); AUC_kt_data
AUC_var_data <- calc_auc(warming.var.tau, constant.var.tau); AUC_var_data
AUC_cv_data <- calc_auc(warming.cv.tau, constant.cv.tau); AUC_cv_data
AUC_id_data <- calc_auc(warming.id.tau, constant.id.tau); AUC_id_data
AUC_fdv_data <- calc_auc(warming.fdv.tau, constant.fdv.tau); AUC_fdv_data
AUC_ac_data <- calc_auc(warming.ac.tau, constant.ac.tau); AUC_ac_data
AUC_acv_data <- calc_auc(warming.acv.tau, constant.acv.tau); AUC_acv_data
AUC_data <- c(AUC_mean_data, 
              AUC_sk_data, 
              AUC_kt_data, 
              AUC_var_data,
              AUC_cv_data,
              AUC_id_data, 
              AUC_fdv_data, 
              AUC_ac_data, 
              AUC_acv_data, 
              NA)
AUC_AdjEmp_2 <- data.frame(metrics, AUC_data)
```

#### (3)

```{r}
## Standard deviation
pop1.sd <- SlidingWindow(FUN = "sd", data = sub1.mod.3, window = 5, step = 1)
pop2.sd <- SlidingWindow(FUN = "sd", data = sub2.mod.3, window = 5, step = 1)
pop3.sd <- SlidingWindow(FUN = "sd", data = sub3.mod.3, window = 5, step = 1)
pop4.sd <- SlidingWindow(FUN = "sd", data = sub4.mod.3, window = 5, step = 1)
pop5.sd <- SlidingWindow(FUN = "sd", data = sub5.mod.3, window = 5, step = 1)
pop6.sd <- SlidingWindow(FUN = "sd", data = sub6.mod.3, window = 5, step = 1)
pop7.sd <- SlidingWindow(FUN = "sd", data = sub7.mod.3, window = 5, step = 1)
pop8.sd <- SlidingWindow(FUN = "sd", data = sub8.mod.3, window = 5, step = 1)
## Mean
pop1.mean <- SlidingWindow(FUN = "mean", data = sub1.mod.3, window = 5, step = 1)
pop2.mean <- SlidingWindow(FUN = "mean", data = sub2.mod.3, window = 5, step = 1)
pop3.mean <- SlidingWindow(FUN = "mean", data = sub3.mod.3, window = 5, step = 1)
pop4.mean <- SlidingWindow(FUN = "mean", data = sub4.mod.3, window = 5, step = 1)
pop5.mean <- SlidingWindow(FUN = "mean", data = sub5.mod.3, window = 5, step = 1)
pop6.mean <- SlidingWindow(FUN = "mean", data = sub6.mod.3, window = 5, step = 1)
pop7.mean <- SlidingWindow(FUN = "mean", data = sub7.mod.3, window = 5, step = 1)
pop8.mean <- SlidingWindow(FUN = "mean", data = sub8.mod.3, window = 5, step = 1)
## Skewness
pop1.sk <- SlidingWindow(FUN = "skewness", data = sub1.mod.3, window = 5, step = 1)
pop2.sk <- SlidingWindow(FUN = "skewness", data = sub2.mod.3, window = 5, step = 1)
pop3.sk <- SlidingWindow(FUN = "skewness", data = sub3.mod.3, window = 5, step = 1)
pop4.sk <- SlidingWindow(FUN = "skewness", data = sub4.mod.3, window = 5, step = 1)
pop5.sk <- SlidingWindow(FUN = "skewness", data = sub5.mod.3, window = 5, step = 1)
pop6.sk <- SlidingWindow(FUN = "skewness", data = sub6.mod.3, window = 5, step = 1)
pop7.sk <- SlidingWindow(FUN = "skewness", data = sub7.mod.3, window = 5, step = 1)
pop8.sk <- SlidingWindow(FUN = "skewness", data = sub8.mod.3, window = 5, step = 1)
## Kurtosis
pop1.kt <- SlidingWindow(FUN = "kurtosis", data = sub1.mod.3, window = 5, step = 1)
pop2.kt <- SlidingWindow(FUN = "kurtosis", data = sub2.mod.3, window = 5, step = 1)
pop3.kt <- SlidingWindow(FUN = "kurtosis", data = sub3.mod.3, window = 5, step = 1)
pop4.kt <- SlidingWindow(FUN = "kurtosis", data = sub4.mod.3, window = 5, step = 1)
pop5.kt <- SlidingWindow(FUN = "kurtosis", data = sub5.mod.3, window = 5, step = 1)
pop6.kt <- SlidingWindow(FUN = "kurtosis", data = sub6.mod.3, window = 5, step = 1)
pop7.kt <- SlidingWindow(FUN = "kurtosis", data = sub7.mod.3, window = 5, step = 1)
pop8.kt <- SlidingWindow(FUN = "kurtosis", data = sub8.mod.3, window = 5, step = 1)
## Variation
pop1.var <- pop1.sd^2
pop2.var <- pop2.sd^2
pop3.var <- pop3.sd^2
pop4.var <- pop4.sd^2
pop5.var <- pop5.sd^2
pop6.var <- pop6.sd^2
pop7.var <- pop7.sd^2
pop8.var <- pop8.sd^2
## Coefficient of Variation
pop1.cv <- pop1.sd/(pop1.mean)
pop2.cv <- pop2.sd/(pop2.mean)
pop3.cv <- pop3.sd/(pop3.mean)
pop4.cv <- pop4.sd/(pop4.mean)
pop5.cv <- pop5.sd/(pop5.mean)
pop6.cv <- pop6.sd/(pop6.mean)
pop7.cv <- pop7.sd/(pop7.mean)
pop8.cv <- pop8.sd/(pop8.mean)
## Index of Dispersion
pop1.id <- pop1.var/(pop1.mean)
pop2.id <- pop2.var/(pop2.mean)
pop3.id <- pop3.var/(pop3.mean)
pop4.id <- pop4.var/(pop4.mean)
pop5.id <- pop5.var/(pop5.mean)
pop6.id <- pop6.var/(pop6.mean)
pop7.id <- pop7.var/(pop7.mean)
pop8.id <- pop8.var/(pop8.mean)
## First Difference Variance
pop1.fdv <- c()
pop2.fdv <- c()
pop3.fdv <- c()
pop4.fdv <- c()
pop5.fdv <- c()
pop6.fdv <- c()
pop7.fdv <- c()
pop8.fdv <- c()
for(i in 2:35){
pop1.fdv[i - 1] <- pop1.var[i] - pop1.var[i - 1]
pop2.fdv[i - 1] <- pop2.var[i] - pop2.var[i - 1]
pop3.fdv[i - 1] <- pop3.var[i] - pop3.var[i - 1]
pop4.fdv[i - 1] <- pop4.var[i] - pop4.var[i - 1]
pop5.fdv[i - 1] <- pop5.var[i] - pop5.var[i - 1]
pop6.fdv[i - 1] <- pop6.var[i] - pop6.var[i - 1]
pop7.fdv[i - 1] <- pop7.var[i] - pop7.var[i - 1]
pop8.fdv[i - 1] <- pop8.var[i] - pop8.var[i - 1]
}
## Autocorrelation and Autocovariance
## Autocorrelation
pop1.ac <- c()
pop1.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub1.mod.3[c(window.start:window.end)]
  pop1.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop1.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop2.ac <- c()
pop2.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub2.mod.3[c(window.start:window.end)]
  pop2.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop2.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop3.ac <- c()
pop3.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub3.mod.3[c(window.start:window.end)]
  pop3.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop3.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop4.ac <- c()
pop4.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub4.mod.3[c(window.start:window.end)]
  pop4.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop4.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop5.ac <- c()
pop5.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub5.mod.3[c(window.start:window.end)]
  pop5.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop5.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop6.ac <- c()
pop6.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub6.mod.3[c(window.start:window.end)]
  pop6.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop6.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop7.ac <- c()
pop7.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub7.mod.3[c(window.start:window.end)]
  pop7.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop7.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop8.ac <- c()
pop8.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub8.mod.3[c(window.start:window.end)]
  pop8.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop8.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
time.15 <- seq(1, 15, 1)
constant.mean.tau<- c(cor(pop1.mean[1:15], time.15, method = "kendall"), cor(pop2.mean[1:15], time.15, method = "kendall"),
                      cor(pop3.mean[1:15], time.15, method = "kendall"), cor(pop4.mean[1:15], time.15, method = "kendall"))
warming.mean.tau <- c(cor(pop5.mean[1:15], time.15, method = "kendall"), cor(pop6.mean[1:15], time.15, method = "kendall"),
                      cor(pop7.mean[1:15], time.15, method = "kendall"), cor(pop8.mean[1:15], time.15, method = "kendall"))
constant.sk.tau <- c(cor(pop1.sk[1:15], time.15, method = "kendall"), cor(pop2.sk[1:15], time.15, method = "kendall"),
                          cor(pop3.sk[1:15], time.15, method = "kendall"), cor(pop4.sk[1:15], time.15, method = "kendall"))
warming.sk.tau <- c(cor(pop5.sk[1:15], time.15, method = "kendall"), cor(pop6.sk[1:15], time.15, method = "kendall"),
                          cor(pop7.sk[1:15], time.15, method = "kendall"), cor(pop8.sk[1:15], time.15, method = "kendall"))
constant.kt.tau<- c(cor(pop1.kt[1:15], time.15, method = "kendall"), cor(pop2.kt[1:15], time.15, method = "kendall"),
                          cor(pop3.kt[1:15], time.15, method = "kendall"), cor(pop4.kt[1:15], time.15, method = "kendall"))
warming.kt.tau <- c(cor(pop5.kt[1:15], time.15, method = "kendall"), cor(pop6.kt[1:15], time.15, method = "kendall"),
                          cor(pop7.kt[1:15], time.15, method = "kendall"), cor(pop8.kt[1:15], time.15, method = "kendall"))
constant.var.tau<- c(cor(pop1.var[1:15], time.15, method = "kendall"), cor(pop2.var[1:15], time.15, method = "kendall"),
                          cor(pop3.var[1:15], time.15, method = "kendall"), cor(pop4.var[1:15], time.15, method = "kendall"))
warming.var.tau<- c(cor(pop5.var[1:15], time.15, method = "kendall"), cor(pop6.var[1:15], time.15, method = "kendall"),
                         cor(pop7.var[1:15], time.15, method = "kendall"), cor(pop8.var[1:15], time.15, method = "kendall"))
constant.cv.tau<- c(cor(pop1.cv[1:15], time.15, method = "kendall"), cor(pop2.cv[1:15], time.15, method = "kendall"),
                    cor(pop3.cv[1:15], time.15, method = "kendall"), cor(pop4.cv[1:15], time.15, method = "kendall"))
warming.cv.tau <- c(cor(pop5.cv[1:15], time.15, method = "kendall"), cor(pop6.cv[1:15], time.15, method = "kendall"),
                    cor(pop7.cv[1:15], time.15, method = "kendall"), cor(pop8.cv[1:15], time.15, method = "kendall"))
constant.id.tau <- c(cor(pop1.id[1:15], time.15, method = "kendall"), cor(pop2.id[1:15], time.15, method = "kendall"),
                    cor(pop3.id[1:15], time.15, method = "kendall"), cor(pop4.id[1:15], time.15, method = "kendall"))
warming.id.tau <- c(cor(pop5.id[1:15], time.15, method = "kendall"), cor(pop6.id[1:15], time.15, method = "kendall"),
                    cor(pop7.id[1:15], time.15, method = "kendall"), cor(pop8.id[1:15], time.15, method = "kendall"))
constant.fdv.tau <- c(cor(pop1.fdv[1:15], time.15, method = "kendall"), cor(pop2.fdv[1:15], time.15, method = "kendall"),
                                     cor(pop3.fdv[1:15], time.15, method = "kendall"), cor(pop4.fdv[1:15], time.15, method = "kendall"))
warming.fdv.tau <- c(cor(pop5.fdv[1:15], time.15, method = "kendall"), cor(pop6.fdv[1:15], time.15, method = "kendall"),
                                     cor(pop7.fdv[1:15], time.15, method = "kendall"), cor(pop8.fdv[1:15], time.15, method = "kendall"))
constant.ac.tau <- c(cor(pop1.ac[1:15], time.15, method = "kendall"), cor(pop2.ac[1:15], time.15, method = "kendall"),
                    cor(pop3.ac[1:15], time.15, method = "kendall"), cor(pop4.ac[1:15], time.15, method = "kendall"))
warming.ac.tau <- c(cor(pop5.ac[1:15], time.15, method = "kendall"), cor(pop6.ac[1:15], time.15, method = "kendall"),
                    cor(pop7.ac[1:15], time.15, method = "kendall"), cor(pop8.ac[1:15], time.15, method = "kendall"))
constant.acv.tau <- c(cor(pop1.acv[1:15], time.15, method = "kendall"), cor(pop2.acv[1:15], time.15, method = "kendall"),
                     cor(pop3.acv[1:15], time.15, method = "kendall"), cor(pop4.acv[1:15], time.15, method = "kendall"))
warming.acv.tau <- c(cor(pop5.acv[1:15], time.15, method = "kendall"), cor(pop6.acv[1:15], time.15, method = "kendall"),
                     cor(pop7.acv[1:15], time.15, method = "kendall"), cor(pop8.acv[1:15], time.15, method = "kendall"))
AUC_mean_data <- calc_auc(warming.mean.tau, constant.mean.tau); AUC_mean_data
AUC_sk_data <- calc_auc(warming.sk.tau, constant.sk.tau); AUC_sk_data
AUC_kt_data <- calc_auc(warming.kt.tau, constant.kt.tau); AUC_kt_data
AUC_var_data <- calc_auc(warming.var.tau, constant.var.tau); AUC_var_data
AUC_cv_data <- calc_auc(warming.cv.tau, constant.cv.tau); AUC_cv_data
AUC_id_data <- calc_auc(warming.id.tau, constant.id.tau); AUC_id_data
AUC_fdv_data <- calc_auc(warming.fdv.tau, constant.fdv.tau); AUC_fdv_data
AUC_ac_data <- calc_auc(warming.ac.tau, constant.ac.tau); AUC_ac_data
AUC_acv_data <- calc_auc(warming.acv.tau, constant.acv.tau); AUC_acv_data
AUC_data <- c(AUC_mean_data, 
              AUC_sk_data, 
              AUC_kt_data, 
              AUC_var_data,
              AUC_cv_data,
              AUC_id_data, 
              AUC_fdv_data, 
              AUC_ac_data, 
              AUC_acv_data, 
              NA)
AUC_AdjEmp_3 <- data.frame(metrics, AUC_data)
```

#### (4)

```{r}
## Standard deviation
pop1.sd <- SlidingWindow(FUN = "sd", data = sub1.mod.4, window = 5, step = 1)
pop2.sd <- SlidingWindow(FUN = "sd", data = sub2.mod.4, window = 5, step = 1)
pop3.sd <- SlidingWindow(FUN = "sd", data = sub3.mod.4, window = 5, step = 1)
pop4.sd <- SlidingWindow(FUN = "sd", data = sub4.mod.4, window = 5, step = 1)
pop5.sd <- SlidingWindow(FUN = "sd", data = sub5.mod.4, window = 5, step = 1)
pop6.sd <- SlidingWindow(FUN = "sd", data = sub6.mod.4, window = 5, step = 1)
pop7.sd <- SlidingWindow(FUN = "sd", data = sub7.mod.4, window = 5, step = 1)
pop8.sd <- SlidingWindow(FUN = "sd", data = sub8.mod.4, window = 5, step = 1)
## Mean
pop1.mean <- SlidingWindow(FUN = "mean", data = sub1.mod.4, window = 5, step = 1)
pop2.mean <- SlidingWindow(FUN = "mean", data = sub2.mod.4, window = 5, step = 1)
pop3.mean <- SlidingWindow(FUN = "mean", data = sub3.mod.4, window = 5, step = 1)
pop4.mean <- SlidingWindow(FUN = "mean", data = sub4.mod.4, window = 5, step = 1)
pop5.mean <- SlidingWindow(FUN = "mean", data = sub5.mod.4, window = 5, step = 1)
pop6.mean <- SlidingWindow(FUN = "mean", data = sub6.mod.4, window = 5, step = 1)
pop7.mean <- SlidingWindow(FUN = "mean", data = sub7.mod.4, window = 5, step = 1)
pop8.mean <- SlidingWindow(FUN = "mean", data = sub8.mod.4, window = 5, step = 1)
## Skewness
pop1.sk <- SlidingWindow(FUN = "skewness", data = sub1.mod.4, window = 5, step = 1)
pop2.sk <- SlidingWindow(FUN = "skewness", data = sub2.mod.4, window = 5, step = 1)
pop3.sk <- SlidingWindow(FUN = "skewness", data = sub3.mod.4, window = 5, step = 1)
pop4.sk <- SlidingWindow(FUN = "skewness", data = sub4.mod.4, window = 5, step = 1)
pop5.sk <- SlidingWindow(FUN = "skewness", data = sub5.mod.4, window = 5, step = 1)
pop6.sk <- SlidingWindow(FUN = "skewness", data = sub6.mod.4, window = 5, step = 1)
pop7.sk <- SlidingWindow(FUN = "skewness", data = sub7.mod.4, window = 5, step = 1)
pop8.sk <- SlidingWindow(FUN = "skewness", data = sub8.mod.4, window = 5, step = 1)
## Kurtosis
pop1.kt <- SlidingWindow(FUN = "kurtosis", data = sub1.mod.4, window = 5, step = 1)
pop2.kt <- SlidingWindow(FUN = "kurtosis", data = sub2.mod.4, window = 5, step = 1)
pop3.kt <- SlidingWindow(FUN = "kurtosis", data = sub3.mod.4, window = 5, step = 1)
pop4.kt <- SlidingWindow(FUN = "kurtosis", data = sub4.mod.4, window = 5, step = 1)
pop5.kt <- SlidingWindow(FUN = "kurtosis", data = sub5.mod.4, window = 5, step = 1)
pop6.kt <- SlidingWindow(FUN = "kurtosis", data = sub6.mod.4, window = 5, step = 1)
pop7.kt <- SlidingWindow(FUN = "kurtosis", data = sub7.mod.4, window = 5, step = 1)
pop8.kt <- SlidingWindow(FUN = "kurtosis", data = sub8.mod.4, window = 5, step = 1)
## Variation
pop1.var <- pop1.sd^2
pop2.var <- pop2.sd^2
pop3.var <- pop3.sd^2
pop4.var <- pop4.sd^2
pop5.var <- pop5.sd^2
pop6.var <- pop6.sd^2
pop7.var <- pop7.sd^2
pop8.var <- pop8.sd^2
## Coefficient of Variation
pop1.cv <- pop1.sd/(pop1.mean)
pop2.cv <- pop2.sd/(pop2.mean)
pop3.cv <- pop3.sd/(pop3.mean)
pop4.cv <- pop4.sd/(pop4.mean)
pop5.cv <- pop5.sd/(pop5.mean)
pop6.cv <- pop6.sd/(pop6.mean)
pop7.cv <- pop7.sd/(pop7.mean)
pop8.cv <- pop8.sd/(pop8.mean)
## Index of Dispersion
pop1.id <- pop1.var/(pop1.mean)
pop2.id <- pop2.var/(pop2.mean)
pop3.id <- pop3.var/(pop3.mean)
pop4.id <- pop4.var/(pop4.mean)
pop5.id <- pop5.var/(pop5.mean)
pop6.id <- pop6.var/(pop6.mean)
pop7.id <- pop7.var/(pop7.mean)
pop8.id <- pop8.var/(pop8.mean)
## First Difference Variance
pop1.fdv <- c()
pop2.fdv <- c()
pop3.fdv <- c()
pop4.fdv <- c()
pop5.fdv <- c()
pop6.fdv <- c()
pop7.fdv <- c()
pop8.fdv <- c()
for(i in 2:35){
pop1.fdv[i - 1] <- pop1.var[i] - pop1.var[i - 1]
pop2.fdv[i - 1] <- pop2.var[i] - pop2.var[i - 1]
pop3.fdv[i - 1] <- pop3.var[i] - pop3.var[i - 1]
pop4.fdv[i - 1] <- pop4.var[i] - pop4.var[i - 1]
pop5.fdv[i - 1] <- pop5.var[i] - pop5.var[i - 1]
pop6.fdv[i - 1] <- pop6.var[i] - pop6.var[i - 1]
pop7.fdv[i - 1] <- pop7.var[i] - pop7.var[i - 1]
pop8.fdv[i - 1] <- pop8.var[i] - pop8.var[i - 1]
}
## Autocorrelation and Autocovariance
## Autocorrelation
pop1.ac <- c()
pop1.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub1.mod.4[c(window.start:window.end)]
  pop1.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop1.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop2.ac <- c()
pop2.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub2.mod.4[c(window.start:window.end)]
  pop2.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop2.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop3.ac <- c()
pop3.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub3.mod.4[c(window.start:window.end)]
  pop3.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop3.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop4.ac <- c()
pop4.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub4.mod.4[c(window.start:window.end)]
  pop4.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop4.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop5.ac <- c()
pop5.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub5.mod.4[c(window.start:window.end)]
  pop5.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop5.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop6.ac <- c()
pop6.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub6.mod.4[c(window.start:window.end)]
  pop6.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop6.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop7.ac <- c()
pop7.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub7.mod.4[c(window.start:window.end)]
  pop7.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop7.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop8.ac <- c()
pop8.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub8.mod.4[c(window.start:window.end)]
  pop8.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop8.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
time.15 <- seq(1, 15, 1)
constant.mean.tau<- c(cor(pop1.mean[1:15], time.15, method = "kendall"), cor(pop2.mean[1:15], time.15, method = "kendall"),
                      cor(pop3.mean[1:15], time.15, method = "kendall"), cor(pop4.mean[1:15], time.15, method = "kendall"))
warming.mean.tau <- c(cor(pop5.mean[1:15], time.15, method = "kendall"), cor(pop6.mean[1:15], time.15, method = "kendall"),
                      cor(pop7.mean[1:15], time.15, method = "kendall"), cor(pop8.mean[1:15], time.15, method = "kendall"))
constant.sk.tau <- c(cor(pop1.sk[1:15], time.15, method = "kendall"), cor(pop2.sk[1:15], time.15, method = "kendall"),
                          cor(pop3.sk[1:15], time.15, method = "kendall"), cor(pop4.sk[1:15], time.15, method = "kendall"))
warming.sk.tau <- c(cor(pop5.sk[1:15], time.15, method = "kendall"), cor(pop6.sk[1:15], time.15, method = "kendall"),
                          cor(pop7.sk[1:15], time.15, method = "kendall"), cor(pop8.sk[1:15], time.15, method = "kendall"))
constant.kt.tau<- c(cor(pop1.kt[1:15], time.15, method = "kendall"), cor(pop2.kt[1:15], time.15, method = "kendall"),
                          cor(pop3.kt[1:15], time.15, method = "kendall"), cor(pop4.kt[1:15], time.15, method = "kendall"))
warming.kt.tau <- c(cor(pop5.kt[1:15], time.15, method = "kendall"), cor(pop6.kt[1:15], time.15, method = "kendall"),
                          cor(pop7.kt[1:15], time.15, method = "kendall"), cor(pop8.kt[1:15], time.15, method = "kendall"))
constant.var.tau<- c(cor(pop1.var[1:15], time.15, method = "kendall"), cor(pop2.var[1:15], time.15, method = "kendall"),
                          cor(pop3.var[1:15], time.15, method = "kendall"), cor(pop4.var[1:15], time.15, method = "kendall"))
warming.var.tau<- c(cor(pop5.var[1:15], time.15, method = "kendall"), cor(pop6.var[1:15], time.15, method = "kendall"),
                         cor(pop7.var[1:15], time.15, method = "kendall"), cor(pop8.var[1:15], time.15, method = "kendall"))
constant.cv.tau<- c(cor(pop1.cv[1:15], time.15, method = "kendall"), cor(pop2.cv[1:15], time.15, method = "kendall"),
                    cor(pop3.cv[1:15], time.15, method = "kendall"), cor(pop4.cv[1:15], time.15, method = "kendall"))
warming.cv.tau <- c(cor(pop5.cv[1:15], time.15, method = "kendall"), cor(pop6.cv[1:15], time.15, method = "kendall"),
                    cor(pop7.cv[1:15], time.15, method = "kendall"), cor(pop8.cv[1:15], time.15, method = "kendall"))
constant.id.tau <- c(cor(pop1.id[1:15], time.15, method = "kendall"), cor(pop2.id[1:15], time.15, method = "kendall"),
                    cor(pop3.id[1:15], time.15, method = "kendall"), cor(pop4.id[1:15], time.15, method = "kendall"))
warming.id.tau <- c(cor(pop5.id[1:15], time.15, method = "kendall"), cor(pop6.id[1:15], time.15, method = "kendall"),
                    cor(pop7.id[1:15], time.15, method = "kendall"), cor(pop8.id[1:15], time.15, method = "kendall"))
constant.fdv.tau <- c(cor(pop1.fdv[1:15], time.15, method = "kendall"), cor(pop2.fdv[1:15], time.15, method = "kendall"),
                                     cor(pop3.fdv[1:15], time.15, method = "kendall"), cor(pop4.fdv[1:15], time.15, method = "kendall"))
warming.fdv.tau <- c(cor(pop5.fdv[1:15], time.15, method = "kendall"), cor(pop6.fdv[1:15], time.15, method = "kendall"),
                                     cor(pop7.fdv[1:15], time.15, method = "kendall"), cor(pop8.fdv[1:15], time.15, method = "kendall"))
constant.ac.tau <- c(cor(pop1.ac[1:15], time.15, method = "kendall"), cor(pop2.ac[1:15], time.15, method = "kendall"),
                    cor(pop3.ac[1:15], time.15, method = "kendall"), cor(pop4.ac[1:15], time.15, method = "kendall"))
warming.ac.tau <- c(cor(pop5.ac[1:15], time.15, method = "kendall"), cor(pop6.ac[1:15], time.15, method = "kendall"),
                    cor(pop7.ac[1:15], time.15, method = "kendall"), cor(pop8.ac[1:15], time.15, method = "kendall"))
constant.acv.tau <- c(cor(pop1.acv[1:15], time.15, method = "kendall"), cor(pop2.acv[1:15], time.15, method = "kendall"),
                     cor(pop3.acv[1:15], time.15, method = "kendall"), cor(pop4.acv[1:15], time.15, method = "kendall"))
warming.acv.tau <- c(cor(pop5.acv[1:15], time.15, method = "kendall"), cor(pop6.acv[1:15], time.15, method = "kendall"),
                     cor(pop7.acv[1:15], time.15, method = "kendall"), cor(pop8.acv[1:15], time.15, method = "kendall"))
AUC_mean_data <- calc_auc(warming.mean.tau, constant.mean.tau); AUC_mean_data
AUC_sk_data <- calc_auc(warming.sk.tau, constant.sk.tau); AUC_sk_data
AUC_kt_data <- calc_auc(warming.kt.tau, constant.kt.tau); AUC_kt_data
AUC_var_data <- calc_auc(warming.var.tau, constant.var.tau); AUC_var_data
AUC_cv_data <- calc_auc(warming.cv.tau, constant.cv.tau); AUC_cv_data
AUC_id_data <- calc_auc(warming.id.tau, constant.id.tau); AUC_id_data
AUC_fdv_data <- calc_auc(warming.fdv.tau, constant.fdv.tau); AUC_fdv_data
AUC_ac_data <- calc_auc(warming.ac.tau, constant.ac.tau); AUC_ac_data
AUC_acv_data <- calc_auc(warming.acv.tau, constant.acv.tau); AUC_acv_data
AUC_data <- c(AUC_mean_data, 
              AUC_sk_data, 
              AUC_kt_data, 
              AUC_var_data,
              AUC_cv_data,
              AUC_id_data, 
              AUC_fdv_data, 
              AUC_ac_data, 
              AUC_acv_data, 
              NA)
AUC_AdjEmp_4 <- data.frame(metrics, AUC_data)
```

#### (5)

```{r}
## Standard deviation
pop1.sd <- SlidingWindow(FUN = "sd", data = sub1.mod.5, window = 5, step = 1)
pop2.sd <- SlidingWindow(FUN = "sd", data = sub2.mod.5, window = 5, step = 1)
pop3.sd <- SlidingWindow(FUN = "sd", data = sub3.mod.5, window = 5, step = 1)
pop4.sd <- SlidingWindow(FUN = "sd", data = sub4.mod.5, window = 5, step = 1)
pop5.sd <- SlidingWindow(FUN = "sd", data = sub5.mod.5, window = 5, step = 1)
pop6.sd <- SlidingWindow(FUN = "sd", data = sub6.mod.5, window = 5, step = 1)
pop7.sd <- SlidingWindow(FUN = "sd", data = sub7.mod.5, window = 5, step = 1)
pop8.sd <- SlidingWindow(FUN = "sd", data = sub8.mod.5, window = 5, step = 1)
## Mean
pop1.mean <- SlidingWindow(FUN = "mean", data = sub1.mod.5, window = 5, step = 1)
pop2.mean <- SlidingWindow(FUN = "mean", data = sub2.mod.5, window = 5, step = 1)
pop3.mean <- SlidingWindow(FUN = "mean", data = sub3.mod.5, window = 5, step = 1)
pop4.mean <- SlidingWindow(FUN = "mean", data = sub4.mod.5, window = 5, step = 1)
pop5.mean <- SlidingWindow(FUN = "mean", data = sub5.mod.5, window = 5, step = 1)
pop6.mean <- SlidingWindow(FUN = "mean", data = sub6.mod.5, window = 5, step = 1)
pop7.mean <- SlidingWindow(FUN = "mean", data = sub7.mod.5, window = 5, step = 1)
pop8.mean <- SlidingWindow(FUN = "mean", data = sub8.mod.5, window = 5, step = 1)
## Skewness
pop1.sk <- SlidingWindow(FUN = "skewness", data = sub1.mod.5, window = 5, step = 1)
pop2.sk <- SlidingWindow(FUN = "skewness", data = sub2.mod.5, window = 5, step = 1)
pop3.sk <- SlidingWindow(FUN = "skewness", data = sub3.mod.5, window = 5, step = 1)
pop4.sk <- SlidingWindow(FUN = "skewness", data = sub4.mod.5, window = 5, step = 1)
pop5.sk <- SlidingWindow(FUN = "skewness", data = sub5.mod.5, window = 5, step = 1)
pop6.sk <- SlidingWindow(FUN = "skewness", data = sub6.mod.5, window = 5, step = 1)
pop7.sk <- SlidingWindow(FUN = "skewness", data = sub7.mod.5, window = 5, step = 1)
pop8.sk <- SlidingWindow(FUN = "skewness", data = sub8.mod.5, window = 5, step = 1)
## Kurtosis
pop1.kt <- SlidingWindow(FUN = "kurtosis", data = sub1.mod.5, window = 5, step = 1)
pop2.kt <- SlidingWindow(FUN = "kurtosis", data = sub2.mod.5, window = 5, step = 1)
pop3.kt <- SlidingWindow(FUN = "kurtosis", data = sub3.mod.5, window = 5, step = 1)
pop4.kt <- SlidingWindow(FUN = "kurtosis", data = sub4.mod.5, window = 5, step = 1)
pop5.kt <- SlidingWindow(FUN = "kurtosis", data = sub5.mod.5, window = 5, step = 1)
pop6.kt <- SlidingWindow(FUN = "kurtosis", data = sub6.mod.5, window = 5, step = 1)
pop7.kt <- SlidingWindow(FUN = "kurtosis", data = sub7.mod.5, window = 5, step = 1)
pop8.kt <- SlidingWindow(FUN = "kurtosis", data = sub8.mod.5, window = 5, step = 1)
## Variation
pop1.var <- pop1.sd^2
pop2.var <- pop2.sd^2
pop3.var <- pop3.sd^2
pop4.var <- pop4.sd^2
pop5.var <- pop5.sd^2
pop6.var <- pop6.sd^2
pop7.var <- pop7.sd^2
pop8.var <- pop8.sd^2
## Coefficient of Variation
pop1.cv <- pop1.sd/(pop1.mean)
pop2.cv <- pop2.sd/(pop2.mean)
pop3.cv <- pop3.sd/(pop3.mean)
pop4.cv <- pop4.sd/(pop4.mean)
pop5.cv <- pop5.sd/(pop5.mean)
pop6.cv <- pop6.sd/(pop6.mean)
pop7.cv <- pop7.sd/(pop7.mean)
pop8.cv <- pop8.sd/(pop8.mean)
## Index of Dispersion
pop1.id <- pop1.var/(pop1.mean)
pop2.id <- pop2.var/(pop2.mean)
pop3.id <- pop3.var/(pop3.mean)
pop4.id <- pop4.var/(pop4.mean)
pop5.id <- pop5.var/(pop5.mean)
pop6.id <- pop6.var/(pop6.mean)
pop7.id <- pop7.var/(pop7.mean)
pop8.id <- pop8.var/(pop8.mean)
## First Difference Variance
pop1.fdv <- c()
pop2.fdv <- c()
pop3.fdv <- c()
pop4.fdv <- c()
pop5.fdv <- c()
pop6.fdv <- c()
pop7.fdv <- c()
pop8.fdv <- c()
for(i in 2:35){
pop1.fdv[i - 1] <- pop1.var[i] - pop1.var[i - 1]
pop2.fdv[i - 1] <- pop2.var[i] - pop2.var[i - 1]
pop3.fdv[i - 1] <- pop3.var[i] - pop3.var[i - 1]
pop4.fdv[i - 1] <- pop4.var[i] - pop4.var[i - 1]
pop5.fdv[i - 1] <- pop5.var[i] - pop5.var[i - 1]
pop6.fdv[i - 1] <- pop6.var[i] - pop6.var[i - 1]
pop7.fdv[i - 1] <- pop7.var[i] - pop7.var[i - 1]
pop8.fdv[i - 1] <- pop8.var[i] - pop8.var[i - 1]
}
## Autocorrelation and Autocovariance
## Autocorrelation
pop1.ac <- c()
pop1.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub1.mod.5[c(window.start:window.end)]
  pop1.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop1.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop2.ac <- c()
pop2.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub2.mod.5[c(window.start:window.end)]
  pop2.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop2.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop3.ac <- c()
pop3.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub3.mod.5[c(window.start:window.end)]
  pop3.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop3.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop4.ac <- c()
pop4.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub4.mod.5[c(window.start:window.end)]
  pop4.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop4.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop5.ac <- c()
pop5.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub5.mod.5[c(window.start:window.end)]
  pop5.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop5.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop6.ac <- c()
pop6.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub6.mod.5[c(window.start:window.end)]
  pop6.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop6.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop7.ac <- c()
pop7.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub7.mod.5[c(window.start:window.end)]
  pop7.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop7.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
pop8.ac <- c()
pop8.acv <- c()
for(i in 1:35){
  window.start <- i
  window.end <- i + 4
  segment <- sub8.mod.5[c(window.start:window.end)]
  pop8.ac[i] <- acf(segment, plot = FALSE, type = "correlation")[[1]][2]
  pop8.acv[i] <- acf(segment, plot = FALSE, type = "covariance")[[1]][2]
}
time.15 <- seq(1, 15, 1)
constant.mean.tau<- c(cor(pop1.mean[1:15], time.15, method = "kendall"), cor(pop2.mean[1:15], time.15, method = "kendall"),
                      cor(pop3.mean[1:15], time.15, method = "kendall"), cor(pop4.mean[1:15], time.15, method = "kendall"))
warming.mean.tau <- c(cor(pop5.mean[1:15], time.15, method = "kendall"), cor(pop6.mean[1:15], time.15, method = "kendall"),
                      cor(pop7.mean[1:15], time.15, method = "kendall"), cor(pop8.mean[1:15], time.15, method = "kendall"))
constant.sk.tau <- c(cor(pop1.sk[1:15], time.15, method = "kendall"), cor(pop2.sk[1:15], time.15, method = "kendall"),
                          cor(pop3.sk[1:15], time.15, method = "kendall"), cor(pop4.sk[1:15], time.15, method = "kendall"))
warming.sk.tau <- c(cor(pop5.sk[1:15], time.15, method = "kendall"), cor(pop6.sk[1:15], time.15, method = "kendall"),
                          cor(pop7.sk[1:15], time.15, method = "kendall"), cor(pop8.sk[1:15], time.15, method = "kendall"))
constant.kt.tau<- c(cor(pop1.kt[1:15], time.15, method = "kendall"), cor(pop2.kt[1:15], time.15, method = "kendall"),
                          cor(pop3.kt[1:15], time.15, method = "kendall"), cor(pop4.kt[1:15], time.15, method = "kendall"))
warming.kt.tau <- c(cor(pop5.kt[1:15], time.15, method = "kendall"), cor(pop6.kt[1:15], time.15, method = "kendall"),
                          cor(pop7.kt[1:15], time.15, method = "kendall"), cor(pop8.kt[1:15], time.15, method = "kendall"))
constant.var.tau<- c(cor(pop1.var[1:15], time.15, method = "kendall"), cor(pop2.var[1:15], time.15, method = "kendall"),
                          cor(pop3.var[1:15], time.15, method = "kendall"), cor(pop4.var[1:15], time.15, method = "kendall"))
warming.var.tau<- c(cor(pop5.var[1:15], time.15, method = "kendall"), cor(pop6.var[1:15], time.15, method = "kendall"),
                         cor(pop7.var[1:15], time.15, method = "kendall"), cor(pop8.var[1:15], time.15, method = "kendall"))
constant.cv.tau<- c(cor(pop1.cv[1:15], time.15, method = "kendall"), cor(pop2.cv[1:15], time.15, method = "kendall"),
                    cor(pop3.cv[1:15], time.15, method = "kendall"), cor(pop4.cv[1:15], time.15, method = "kendall"))
warming.cv.tau <- c(cor(pop5.cv[1:15], time.15, method = "kendall"), cor(pop6.cv[1:15], time.15, method = "kendall"),
                    cor(pop7.cv[1:15], time.15, method = "kendall"), cor(pop8.cv[1:15], time.15, method = "kendall"))
constant.id.tau <- c(cor(pop1.id[1:15], time.15, method = "kendall"), cor(pop2.id[1:15], time.15, method = "kendall"),
                    cor(pop3.id[1:15], time.15, method = "kendall"), cor(pop4.id[1:15], time.15, method = "kendall"))
warming.id.tau <- c(cor(pop5.id[1:15], time.15, method = "kendall"), cor(pop6.id[1:15], time.15, method = "kendall"),
                    cor(pop7.id[1:15], time.15, method = "kendall"), cor(pop8.id[1:15], time.15, method = "kendall"))
constant.fdv.tau <- c(cor(pop1.fdv[1:15], time.15, method = "kendall"), cor(pop2.fdv[1:15], time.15, method = "kendall"),
                                     cor(pop3.fdv[1:15], time.15, method = "kendall"), cor(pop4.fdv[1:15], time.15, method = "kendall"))
warming.fdv.tau <- c(cor(pop5.fdv[1:15], time.15, method = "kendall"), cor(pop6.fdv[1:15], time.15, method = "kendall"),
                                     cor(pop7.fdv[1:15], time.15, method = "kendall"), cor(pop8.fdv[1:15], time.15, method = "kendall"))
constant.ac.tau <- c(cor(pop1.ac[1:15], time.15, method = "kendall"), cor(pop2.ac[1:15], time.15, method = "kendall"),
                    cor(pop3.ac[1:15], time.15, method = "kendall"), cor(pop4.ac[1:15], time.15, method = "kendall"))
warming.ac.tau <- c(cor(pop5.ac[1:15], time.15, method = "kendall"), cor(pop6.ac[1:15], time.15, method = "kendall"),
                    cor(pop7.ac[1:15], time.15, method = "kendall"), cor(pop8.ac[1:15], time.15, method = "kendall"))
constant.acv.tau <- c(cor(pop1.acv[1:15], time.15, method = "kendall"), cor(pop2.acv[1:15], time.15, method = "kendall"),
                     cor(pop3.acv[1:15], time.15, method = "kendall"), cor(pop4.acv[1:15], time.15, method = "kendall"))
warming.acv.tau <- c(cor(pop5.acv[1:15], time.15, method = "kendall"), cor(pop6.acv[1:15], time.15, method = "kendall"),
                     cor(pop7.acv[1:15], time.15, method = "kendall"), cor(pop8.acv[1:15], time.15, method = "kendall"))
AUC_mean_data <- calc_auc(warming.mean.tau, constant.mean.tau); AUC_mean_data
AUC_sk_data <- calc_auc(warming.sk.tau, constant.sk.tau); AUC_sk_data
AUC_kt_data <- calc_auc(warming.kt.tau, constant.kt.tau); AUC_kt_data
AUC_var_data <- calc_auc(warming.var.tau, constant.var.tau); AUC_var_data
AUC_cv_data <- calc_auc(warming.cv.tau, constant.cv.tau); AUC_cv_data
AUC_id_data <- calc_auc(warming.id.tau, constant.id.tau); AUC_id_data
AUC_fdv_data <- calc_auc(warming.fdv.tau, constant.fdv.tau); AUC_fdv_data
AUC_ac_data <- calc_auc(warming.ac.tau, constant.ac.tau); AUC_ac_data
AUC_acv_data <- calc_auc(warming.acv.tau, constant.acv.tau); AUC_acv_data
AUC_data <- c(AUC_mean_data, 
              AUC_sk_data, 
              AUC_kt_data, 
              AUC_var_data,
              AUC_cv_data,
              AUC_id_data, 
              AUC_fdv_data, 
              AUC_ac_data, 
              AUC_acv_data, 
              NA)
AUC_AdjEmp_5 <- data.frame(metrics, AUC_data)
```

#### Results of Sensitivity Analysis #2

```{r}
AUC_AdjEmp_1; AUC_AdjEmp_2; AUC_AdjEmp_3; AUC_AdjEmp_4; AUC_AdjEmp_5
AUC_AdjEmp_1 == AUC_AdjEmp_2; AUC_AdjEmp_1 == AUC_AdjEmp_3; AUC_AdjEmp_1 == AUC_AdjEmp_4; AUC_AdjEmp_1 == AUC_AdjEmp_5

saveRDS(AUC_AdjEmp_1, "Objects/AUC_AdjEmpiricalData.rds")
```

#### Summarizing and Plotting

```{r}
cols <- c("orchid", rep("black", 2), rep("orchid", 4), "black", "orchid", "black")
pts <- c(19, rep(8, 2), rep(19, 4), 8, 19, 8)
par(mar = c(12, 4, 2, 2))
plot(1:10, AUC_AdjEmp_1$AUC_data, type = "p", 
     main = "Adjusted Empirical Data, All Populations", xaxt = "none", xlab = "", ylim = c(0, 1), ylab = "AUC",
     col = cols, pch = pts)
abline(h = 0.5, lty = 3)
axis(side = 1, at = 1:10, labels = metrics_full, las = 2)
```

### Excluding Population 5

```{r}
time.15 <- seq(1,15,1)
warming.mean.tau_without5 <- c(cor(pop6.mean[1:15], time.15, method = "kendall"),
                               cor(pop7.mean[1:15], time.15, method = "kendall"), 
                               cor(pop8.mean[1:15], time.15, method = "kendall"))
warming.sk.tau_without5 <- c(cor(pop6.sk[1:15], time.15, method = "kendall"),
                                   cor(pop7.sk[1:15], time.15, method = "kendall"), 
                                   cor(pop8.sk[1:15], time.15, method = "kendall"))
warming.kt.tau_without5 <- c(cor(pop6.kt[1:15], time.15, method = "kendall"),
                                   cor(pop7.kt[1:15], time.15, method = "kendall"), 
                                   cor(pop8.kt[1:15], time.15, method = "kendall"))
warming.var.tau_without5 <- c(cor(pop6.var[1:15], time.15, method = "kendall"),
                                   cor(pop7.var[1:15], time.15, method = "kendall"), 
                                   cor(pop8.var[1:15], time.15, method = "kendall"))
warming.cv.tau_without5 <- c(cor(pop6.cv[1:15], time.15, method = "kendall"),
                             cor(pop7.cv[1:15], time.15, method = "kendall"), 
                             cor(pop8.cv[1:15], time.15, method = "kendall"))
warming.id.tau_without5 <- c(cor(pop6.id[1:15], time.15, method = "kendall"),
                             cor(pop7.id[1:15], time.15, method = "kendall"), 
                             cor(pop8.id[1:15], time.15, method = "kendall"))
warming.ac.tau_without5 <- c(cor(pop6.ac[1:15], time.15, method = "kendall"),
                             cor(pop7.ac[1:15], time.15, method = "kendall"), 
                             cor(pop8.ac[1:15], time.15, method = "kendall"))
warming.acv.tau_without5 <- c(cor(pop6.acv[1:15], time.15, method = "kendall"),
                              cor(pop7.acv[1:15], time.15, method = "kendall"), 
                              cor(pop8.acv[1:15], time.15, method = "kendall"))
warming.fdv.tau_without5 <- c(cor(pop6.fdv[1:15], time.15, method = "kendall"),
                                              cor(pop7.fdv[1:15], time.15, method = "kendall"),
                                              cor(pop8.fdv[1:15], time.15, method = "kendall"))
warming.dt.tau_without5 <- c(cor(pop6.dt[1:15], time.15, method = "kendall"),
                                     cor(pop7.dt[1:15], time.15, method = "kendall"), 
                                     cor(pop8.dt[1:15], time.15, method = "kendall"))
AUC_mean_data <- calc_auc(warming.mean.tau_without5, constant.mean.tau); AUC_mean_data
AUC_sk_data <- calc_auc(warming.sk.tau_without5, constant.sk.tau); AUC_sk_data
AUC_kt_data <- calc_auc(warming.kt.tau_without5, constant.kt.tau); AUC_kt_data
AUC_var_data <- calc_auc(warming.var.tau_without5, constant.var.tau); AUC_var_data
AUC_cv_data <- calc_auc(warming.cv.tau_without5, constant.cv.tau); AUC_cv_data
AUC_id_data <- calc_auc(warming.id.tau_without5, constant.id.tau); AUC_id_data
AUC_fdv_data <- calc_auc(warming.fdv.tau_without5, constant.fdv.tau); AUC_fdv_data
AUC_ac_data <- calc_auc(warming.ac.tau_without5, constant.ac.tau); AUC_ac_data
AUC_acv_data <- calc_auc(warming.acv.tau_without5, constant.acv.tau); AUC_acv_data
AUC_data <- c(AUC_mean_data, 
              AUC_sk_data, 
              AUC_kt_data, 
              AUC_var_data,
              AUC_cv_data,
              AUC_id_data, 
              AUC_fdv_data, 
              AUC_ac_data, 
              AUC_acv_data, 
              NA)
AUC_data <- data.frame(metrics, AUC_data); AUC_data
saveRDS(AUC_data, "Objects/AUC_AdjEmpiricalData_ExPop5.rds")
```

#### Plotting

```{r}
cols <- c("orchid", rep("black", 2), rep("orchid", 4), "black", "orchid", "black")
pts <- c(19, rep(8, 2), rep(19, 4), 8, 19, 8)
par(mar = c(12, 4, 2, 2))
plot(1:10, AUC_data$AUC_data, type = "p", 
     main = "Adjusted Empirical Data, Excluding Population 5", xaxt = "none", xlab = "", ylim = c(0, 1), ylab = "AUC",
     col = cols, pch = pts)
abline(h = 0.5, lty = 3)
axis(side = 1, at = 1:10, labels = metrics_full, las = 2)
```

## Troubleshooting Missing Decay Time

Okay, so, decay time is defined as follows:

$\bar{\tau}_t=-\delta/ln[AC_t(\delta)]$

```{r}
pop1.dt
pop2.dt
pop3.dt
pop4.dt
pop5.dt
pop6.dt
pop7.dt
pop8.dt
```

Values too close to 0?

```{r}
log(1e-22) # Nope, R can compute this.
```

Negative values?

```{r}
pop5.ac # This has negatives, which will give NaNs when log'd
ac.neg <- which(pop5.ac < 0)
dt.nan <- which(is.nan(pop5.dt) == TRUE)
ac.neg == dt.nan
```

Yup, this is the issue. Now, why aren't we seeing this in the simulation results?

There are negative values in the simulated time series (1.26%).

```{r}
ac.neg <- which(constant.sims.ac.15[1:45, 6] < 0)
dt.nan <- which(is.nan(constant.sims.dt.15[ , 6]) == TRUE)
ac.neg == dt.nan
```

Okay, so, negative AC values are yielding NaNs.

If we calculate $\tau$, we get one value for each simulation. Some values are `NA`. Do simulations that include at least one `NaN` produce `NA` values?

```{r}
which(is.na(constant.sims.dt.15.tau[1:10])) # 1, 3, 4, 6, 9
length(which(is.nan(constant.sims.dt.15[ , 1]) == TRUE)) # 1
length(which(is.nan(constant.sims.dt.15[ , 2]) == TRUE)) # 0
length(which(is.nan(constant.sims.dt.15[ , 3]) == TRUE)) # 2
length(which(is.nan(constant.sims.dt.15[ , 4]) == TRUE)) # 1
length(which(is.nan(constant.sims.dt.15[ , 5]) == TRUE)) # 0
length(which(is.nan(constant.sims.dt.15[ , 6]) == TRUE)) # 4
length(which(is.nan(constant.sims.dt.15[ , 7]) == TRUE)) # 0
length(which(is.nan(constant.sims.dt.15[ , 8]) == TRUE)) # 0
length(which(is.nan(constant.sims.dt.15[ , 9]) == TRUE)) # 6
length(which(is.nan(constant.sims.dt.15[ , 10]) == TRUE)) # 0
```

Okay, so, I think we figured it put. If there are any `NaN`s in the decay time vector (a given time series), you'll get an `NA` as your $\tau$, and an `NA` as your AUC. When we calculate AUC, these time series are removed.

So, because we have `NaN`s in every decay time vector (in each of 8 populations), we get a $\tau$ vector of all `NA`s, and no measurement of AUC. (Reminder that an `NaN` in the decay time vector means that the measure of autocorrelation was negative.)

```{r}
length(which(is.nan(pop1.dt)) == TRUE)
length(which(is.nan(pop2.dt)) == TRUE)
length(which(is.nan(pop3.dt)) == TRUE)
length(which(is.nan(pop4.dt)) == TRUE)
length(which(is.nan(pop5.dt)) == TRUE)
length(which(is.nan(pop6.dt)) == TRUE)
length(which(is.nan(pop7.dt)) == TRUE)
length(which(is.nan(pop8.dt)) == TRUE)
```
